<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAGGD - Executive SLA Performance Dashboard</title>
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <style>
        /* TAGGD Orange/White/Black Theme */
        :root {
            --primary-color: #FF6B35;
            --primary-light: #FF8C5A;
            --primary-dark: #E65528;
            --secondary-color: #FF9068;
            --success-color: #10b981;
            --warning-color: ' + (diff < 0 ? '#ef4444' : '#10b981') + ';
            --danger-color: #ef4444;
            --info-color: #06b6d4;
            --improvement-color: #10b981;
            --decline-color: #ef4444;
            --dark-color: #1a1a1a;
            --light-color: #f5f5f5;
            --white: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --bg-body: #fafafa;
            --card-bg: #ffffff;
            --header-bg: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            --sidebar-bg: #ffffff;
            --sidebar-hover: #f5f5f5;
        }

        [data-theme="dark"] {
            --primary-color: #FF8C5A;
            --primary-light: #FFA57D;
            --primary-dark: #FF6B35;
            --secondary-color: #FF9068;
            --success-color: #34d399;
            --warning-color: #fbbf24;
            --danger-color: #f87171;
            --info-color: #22d3ee;
            --improvement-color: #34d399;
            --decline-color: #f87171;
            --dark-color: #cbd5e1;
            --light-color: #2a2a2a;
            --white: #1a1a1a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #3a3a3a;
            --bg-body: #1a1a1a;
            --card-bg: #2a2a2a;
            --sidebar-bg: #2a2a2a;
            --sidebar-hover: #3a3a3a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-body);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: var(--sidebar-bg);
            border-right: 2px solid var(--border-color);
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 2px 0 10px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .sidebar-header {
            background: var(--header-bg);
            color: white;
            padding: 25px 20px;
            text-align: center;
        }

        .sidebar-header h2 {
            font-size: 1.8em;
            font-weight: 800;
            letter-spacing: 3px;
            margin-bottom: 5px;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-section-title {
            color: var(--text-secondary);
            font-size: 0.75em;
            font-weight: 700;
            text-transform: uppercase;
            padding: 10px 20px;
            margin-bottom: 5px;
        }

        
        .menu-item {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 4px solid transparent;
            margin: 6px 12px;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            background: transparent;
        }
        
        .menu-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .menu-item:hover {
            background: linear-gradient(135deg, rgba(58, 28, 113, 0.1) 0%, rgba(215, 109, 119, 0.05) 100%);
            transform: translateX(8px);
            box-shadow: 0 4px 12px rgba(58, 28, 113, 0.15);
        }
        
        .menu-item:hover::before {
            transform: scaleY(1);
        }

        .menu-item.active {
            background: linear-gradient(135deg, rgba(58, 28, 113, 0.15) 0%, rgba(215, 109, 119, 0.1) 100%);
            border-left-color: transparent;
            box-shadow: 0 4px 16px rgba(58, 28, 113, 0.2);
            transform: translateX(8px);
        }
        
        .menu-item.active::before {
            transform: scaleY(1);
        }
        
        .menu-item.active span {
            font-weight: 600;
            color: #3a1c71;
        }

        .menu-item i {
            font-size: 1.4em;
            margin-right: 16px;
            min-width: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            transition: all 0.3s ease;
        }
        
        .menu-item:hover i {
            transform: scale(1.15) rotate(5deg);
            filter: drop-shadow(0 2px 4px rgba(58, 28, 113, 0.3));
        }
        
        .menu-item.active i {
            transform: scale(1.2);
            filter: drop-shadow(0 2px 6px rgba(58, 28, 113, 0.4));
        }

        .menu-item span {
            font-size: 0.95em;
            font-weight: 500;
            letter-spacing: 0.3px;
            transition: all 0.3s ease;
            color: #374151;
        }
        
        .menu-item:hover span {
            color: #3a1c71;
            font-weight: 600;
        }
        
        /* Add badge/indicator for active views */
        .menu-item.active::after {
            content: 'â—';
            position: absolute;
            right: 16px;
            font-size: 0.6em;
            color: #3a1c71;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.6;
                transform: scale(1.2);
            }
        }
        
        /* Section Headers in Sidebar */
        .sidebar h3 {
            color: #6b7280;
            font-size: 0.75em;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 700;
            padding: 20px 20px 8px 20px;
            margin: 16px 0 8px 0;
            border-bottom: 2px solid rgba(58, 28, 113, 0.1);
        }


        .control-buttons {
            padding: 15px 20px;
            border-top: 2px solid var(--border-color);
            display: flex;
            gap: 10px;
            flex-direction: column;
        }

        .control-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .control-btn.audio-active {
            background: var(--success-color);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 20px;
            background: var(--bg-body);
            transition: all 0.3s ease;
        }

        .header {
            background: var(--header-bg);
            color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 25px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 8px;
            font-weight: 600;
        }

        /* Enhanced Filter Section */
        .controls {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            margin-bottom: 25px;
            border-left: 4px solid var(--primary-color);
        }

        .controls h3 {
            color: var(--primary-color);
            margin-bottom: 18px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
            padding: 20px;
            background: var(--light-color);
            border-radius: 10px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-group label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-group select {
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text-primary);
            font-size: 0.95em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-group select:hover {
            border-color: var(--primary-color);
        }

        .filter-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }


        /* Select2 Customization */
        .select2-container--default .select2-selection--multiple {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--card-bg);
            min-height: 42px;
            padding: 4px;
        }

        .select2-container--default.select2-container--focus .select2-selection--multiple {
            border-color: var(--primary-color);
        }

        .select2-container--default .select2-selection--multiple .select2-selection__choice {
            background-color: var(--primary-color);
            border: none;
            color: white;
            border-radius: 4px;
            padding: 4px 8px;
            margin: 2px;
        }

        .select2-container--default .select2-selection--multiple .select2-selection__choice__remove {
            color: white;
            margin-right: 5px;
        }



        .filter-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid var(--border-color);
        }

        button {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        button.clear-filters-btn {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%) 0%, #dc2626 100%);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        /* Card Styles */
        .card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            border-top: 4px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card h3 {
            color: var(--primary-color);
            margin-bottom: 18px;
            font-size: 1.2em;
            border-bottom: 2px solid var(--light-color);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Key Insights Section */
        .insights-section {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-lg);
        }

        .insights-section h3 {
            color: white;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .insight-item {
            background: rgba(255,255,255,0.15);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            backdrop-filter: blur(10px);
        }

        .insight-item h4 {
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .insight-item p {
            line-height: 1.6;
            opacity: 0.95;
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 18px;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 12px;
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
        }

        table th {
            background: var(--primary-color);
            color: white;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9em;
        }

        table td {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-primary);
            font-size: 0.9em;
        }

        table tr:hover {
            background: var(--light-color);
        }

        /* Trend Indicators */
        .trend-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.85em;
        }

        .trend-up {
            color: var(--success-color);
            background: rgba(16, 185, 129, 0.1);
        }

        .trend-down {
            color: var(--danger-color);
            background: rgba(239, 68, 68, 0.1);
        }

        .trend-stable {
            color: var(--warning-color);
            background: rgba(245, 158, 11, 0.1);
        }

        .improvement-badge {
            color: var(--improvement-color);
            font-weight: bold;
        }

        .decline-badge {
            color: var(--decline-color);
            font-weight: bold;
        }

        /* Comparison Widgets */
        .comparison-widget {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .metric-box {
            padding: 20px;
            background: var(--light-color);
            border-radius: 10px;
            text-align: center;
            border: 2px solid var(--border-color);
        }

        .metric-box.fy24 {
            border-left: 4px solid #3a1c71;
        }

        .metric-box.fy25 {
            border-left: 4px solid var(--primary-color);
        }

        .metric-label {
            font-size: 0.85em;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: var(--text-primary);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 25px;
            right: 25px;
            background: var(--card-bg);
            color: var(--text-primary);
            padding: 12px 22px;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            z-index: 10000;
            display: none;
            border-left: 4px solid var(--success-color);
        }

        .toast.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: var(--primary-color);
        }

        /* Mobile Menu Toggle Button */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1100;
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(58, 28, 113, 0.4);
            transition: all 0.3s ease;
        }

        .mobile-menu-toggle:active {
            transform: scale(0.95);
        }

        .mobile-menu-toggle i {
            transition: transform 0.3s ease;
        }

        .mobile-menu-toggle.active i {
            transform: rotate(90deg);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .sidebar {
                width: 280px;
                position: fixed;
                left: -280px;
                top: 0;
                height: 100vh;
                z-index: 1050;
                transition: left 0.3s ease;
                overflow-y: auto;
            }

            .sidebar.mobile-open {
                left: 0;
                box-shadow: 4px 0 20px rgba(0, 0, 0, 0.3);
            }

            .mobile-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1040;
            }

            .mobile-overlay.active {
                display: block;
            }
            
            .main-content {
                margin-left: 0;
                padding-top: 80px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .filter-section {
                grid-template-columns: 1fr;
            }

            .comparison-widget {
                grid-template-columns: 1fr;
            }

            .sidebar-header h2 {
                font-size: 1.4em;
            }

            .menu-item {
                padding: 14px 16px;
                margin: 4px 8px;
            }

            .menu-item span {
                font-size: 0.9em;
            }
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light-color);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }
    
        /* Animated Widgets */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .animated-card {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        
        .animated-widget {
            animation: scaleIn 0.5s ease-out forwards;
        }
        
        .stat-widget {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            animation: slideInRight 0.5s ease-out;
        }
        
        .stat-widget:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 4px 6px rgba(58, 28, 113, 0.1);
        }
        
        .stat-widget-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-widget-label {
            font-size: 0.9em;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        
        /* Status Badges */
        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-new {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
        }
        
        .status-na {
            background: #6b7280;
            color: white;
        }
        
        .status-improvement {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .status-decline {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        /* Practice Head Cards */
        .practice-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow-md);
            border-left: 5px solid var(--primary-color);
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease-out;
        }
        
        .practice-card:hover {
            transform: translateX(10px);
            box-shadow: var(--shadow-lg);
            border-left-width: 8px;
        }
        
        .practice-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .practice-card-name {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--text-primary);
        }
        
        .practice-card-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .practice-metric {
            text-align: center;
            padding: 10px;
            background: var(--light-color);
            border-radius: 8px;
        }
        
        .practice-metric-label {
            font-size: 0.75em;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .practice-metric-value {
            font-size: 1.5em;
            font-weight: bold;
        }

        /* Performance Badges */
        .performance-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }

        .performance-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
            white-space: nowrap;
            animation: badgePop 0.5s ease-out;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .performance-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }

        @keyframes badgePop {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Badge Types */
        .badge-star {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #ffffff;
        }

        .badge-rocket {
            background: linear-gradient(135deg, #8b5cf6, #6366f1);
            color: #ffffff;
        }

        .badge-fire {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: #ffffff;
        }

        .badge-target {
            background: linear-gradient(135deg, #10b981, #059669);
            color: #ffffff;
        }

        .badge-trophy {
            background: linear-gradient(135deg, #fbbf24, #eab308);
            color: #ffffff;
        }

        .badge-chart {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: #ffffff;
        }

        .badge-shield {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: #ffffff;
        }

        .badge-bolt {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: #ffffff;
        }

        .badge-crown {
            background: linear-gradient(135deg, #ec4899, #db2777);
            color: #ffffff;
        }

        .badge-diamond {
            background: linear-gradient(135deg, #a855f7, #9333ea);
            color: #ffffff;
        }

    
        /* Export Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 10001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background-color: var(--card-bg);
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 6px rgba(58, 28, 113, 0.1);
            animation: bounceIn 0.5s ease-out;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-header h2 {
            color: var(--primary-color);
            font-size: 1.5em;
        }

        .close {
            color: var(--text-secondary);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close:hover {
            color: var(--danger-color);
        }

        .export-options {
            margin: 20px 0;
        }

        .export-section {
            margin-bottom: 20px;
        }

        .export-section h3 {
            color: var(--text-primary);
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: var(--light-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .checkbox-item:hover {
            background: var(--primary-light);
            color: white;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .export-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            font-size: 0.95em;
            border-radius: 8px;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 600;
        }

        .export-btn.pdf {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
        }

        .export-btn.excel {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
        }

        .export-btn.word {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
        }

        .export-btn.ppt {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(58, 28, 113, 0.1);
        }

    
        /* Premium Animated Widgets */
        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3) rotate(-5deg);
            }
            50% {
                opacity: 1;
                transform: scale(1.05) rotate(2deg);
            }
            70% {
                transform: scale(0.95) rotate(-1deg);
            }
            100% {
                transform: scale(1) rotate(0);
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: scale(0.95);
            }
            to { 
                opacity: 1; 
                transform: scale(1);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }

        .stat-widget {
            position: relative;
            overflow: hidden;
            animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .stat-widget::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 100%);
            animation: shimmer 3s infinite;
        }

        .stat-widget.blue {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
        }

        .stat-widget.green {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
        }

        .stat-widget.purple {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
        }

        .stat-widget.orange {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
        }

        /* Ensure stat-widget text visibility */
        .stat-widget-label,
        .stat-widget-value {
            color: white !important;
            opacity: 1 !important;
            z-index: 2;
            position: relative;
        }


        .card {
            animation: slideInUp 0.6s ease-out;
        }

        table {
            animation: fadeIn 0.8s ease-out;
        }
        
        /* Enhanced Not Reported View Styles */
        .metric-card {
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            animation: slideInUp 0.6s ease-out;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
        }
        
        .chart-container {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            height: 450px;
            transition: all 0.3s ease;
        }
        
        .chart-container:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .chart-container canvas {
            max-height: 360px;
        }
        
        .table-container {
            background: var(--card-bg);
            border-radius: 8px;
            overflow-x: auto;
            box-shadow: var(--shadow-sm);
        }
        
        .view-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--border-color);
        }
        
        .view-header h2 {
            color: var(--primary-color);
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .view-header p {
            color: var(--text-secondary);
            font-size: 1.1em;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal {
            display: none;
            position: fixed;
            z-index: 10002;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.3s ease-out;
        }
        
        .welcome-modal-content {
            background: var(--card-bg);
            margin: 5% auto;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 700px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: bounceIn 0.6s ease-out;
            position: relative;
        }
        
        .welcome-modal-header {
            background: var(--header-bg);
            color: white;
            padding: 30px;
            border-radius: 15px 15px 0 0;
            margin: -40px -40px 30px -40px;
            text-align: center;
        }
        
        .welcome-modal-header h2 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .welcome-modal-header p {
            font-size: 1.2em;
            opacity: 0.95;
        }
        
        .welcome-modal-body {
            line-height: 1.8;
            color: var(--text-primary);
        }
        
        .welcome-modal-body h3 {
            color: var(--primary-color);
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .welcome-modal-body ul {
            margin-left: 25px;
            margin-bottom: 20px;
        }
        
        .welcome-modal-body li {
            margin-bottom: 10px;
        }
        
        .welcome-modal-footer {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .welcome-modal-btn {
            padding: 15px 35px;
            border-radius: 10px;
            border: none;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .welcome-modal-btn.primary {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
        }
        
        .welcome-modal-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(58, 28, 113, 0.3);
        }
        
        .welcome-modal-btn.secondary {
            background: transparent;
            color: var(--text-secondary);
            border: 2px solid var(--border-color);
        }
        
        .welcome-modal-btn.secondary:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        /* New Welcome Popup Styles */
        .welcome-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-in;
        }

        .welcome-popup-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 90%;
            padding: 40px;
            text-align: center;
            animation: slideInDown 0.5s ease-out;
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .welcome-popup-card {
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%);
        }

        .welcome-popup-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #FF6B35, #FF8C5A, #FF6B35);
        }

        .welcome-popup-greeting {
            font-size: 2em;
            font-weight: bold;
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            animation: slideInLeft 0.6s ease-out;
        }

        .welcome-popup-date {
            font-size: 1.1em;
            color: var(--text-secondary);
            margin-bottom: 30px;
            font-weight: 500;
            animation: slideInRight 0.7s ease-out;
        }

        .welcome-popup-quote-box {
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(58, 28, 113, 0.3);
            animation: zoomIn 0.8s ease-out;
        }

        .welcome-popup-quote {
            font-size: 1.3em;
            font-style: italic;
            line-height: 1.6;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .welcome-popup-btn {
            background: linear-gradient(135deg, #FF6B35, #FF8C5A);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        .welcome-popup-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.5);
        }

        .welcome-popup-btn:active {
            transform: translateY(-1px);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .welcome-popup-card {
                padding: 25px;
                width: 95%;
            }

            .welcome-popup-greeting {
                font-size: 1.5em;
            }

            .welcome-popup-date {
                font-size: 0.95em;
            }

            .welcome-popup-quote {
                font-size: 1.1em;
            }

            .welcome-popup-btn {
                padding: 12px 40px;
                font-size: 1em;
            }
        }

        /* ============================================================
           FEATURE 1: LAST UPDATED TIMESTAMP
           ============================================================ */
        
        .last-updated-display {
            position: fixed;
            top: 80px;
            right: 20px;
            font-size: 11px;
            color: rgba(100, 100, 100, 0.8);
            background: rgba(255, 255, 255, 0.95);
            padding: 5px 12px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            animation: fadeInTimestamp 0.5s ease-in;
            z-index: 900;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(200, 200, 200, 0.3);
            transition: all 0.3s ease;
        }

        .last-updated-display:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        [data-theme="dark"] .last-updated-display {
            background: rgba(42, 42, 42, 0.95);
            color: rgba(200, 200, 200, 0.8);
            border: 1px solid rgba(100, 100, 100, 0.3);
        }

        @keyframes fadeInTimestamp {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .last-updated-display {
                top: 70px;
                right: 10px;
                font-size: 10px;
                padding: 4px 10px;
            }
        }

        /* ============================================================
           FEATURE 2: VOICE-ENABLED NAVIGATION
           ============================================================ */
        
        .voice-control-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B35, #FF8C5A);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
            z-index: 1000;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .voice-control-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.6);
            background: linear-gradient(135deg, #FF8C5A, #FF6B35);
        }

        .voice-control-btn:active {
            transform: scale(0.95);
        }

        .voice-control-btn.listening {
            animation: voicePulse 1.5s ease-in-out infinite;
            background: linear-gradient(135deg, #10b981, #34d399);
        }

        @keyframes voicePulse {
            0%, 100% {
                box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 8px 30px rgba(255, 107, 53, 0.8);
                transform: scale(1.1);
            }
        }

        .voice-listening-indicator {
            position: fixed;
            bottom: 100px;
            right: 30px;
            background: rgba(255, 107, 53, 0.95);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: none;
            align-items: center;
            gap: 10px;
            animation: fadeIn 0.3s ease-in;
            z-index: 1001;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .voice-listening-indicator.active {
            display: flex;
        }

        .pulse-circle {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: white;
            animation: pulseCircle 1.5s ease-in-out infinite;
        }

        @keyframes pulseCircle {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.5);
                opacity: 0.5;
            }
        }

        .voice-command-help {
            position: fixed;
            bottom: 170px;
            right: 30px;
            background: rgba(255, 255, 255, 0.98);
            color: var(--text-primary);
            padding: 15px 20px;
            border-radius: 12px;
            display: none;
            flex-direction: column;
            gap: 8px;
            animation: fadeIn 0.3s ease-in;
            z-index: 1001;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            max-width: 300px;
            font-size: 12px;
        }

        [data-theme="dark"] .voice-command-help {
            background: rgba(42, 42, 42, 0.98);
            color: var(--text-primary);
        }

        .voice-command-help.active {
            display: flex;
        }

        .voice-command-help h4 {
            margin: 0 0 8px 0;
            font-size: 13px;
            color: var(--primary-color);
        }

        .voice-command-help ul {
            margin: 0;
            padding-left: 20px;
            list-style: none;
        }

        .voice-command-help li {
            margin-bottom: 5px;
            position: relative;
            padding-left: 15px;
        }

        .voice-command-help li::before {
            content: 'ðŸŽ¤';
            position: absolute;
            left: 0;
        }

        @media (max-width: 768px) {
            .voice-control-btn {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 20px;
            }

            .voice-listening-indicator {
                bottom: 80px;
                right: 20px;
                font-size: 12px;
                padding: 8px 16px;
            }

            .voice-command-help {
                bottom: 150px;
                right: 20px;
                max-width: calc(100vw - 40px);
                font-size: 11px;
            }
        }

    </style>
</head>
<body>
    <!-- Mobile Menu Toggle Button -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle" onclick="toggleMobileMenu()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay" onclick="closeMobileMenu()"></div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Last Updated Timestamp -->
    <div id="lastUpdatedTimestamp" class="last-updated-display">
        Last Updated: <span id="timestampText">Never</span>
    </div>

    <!-- Voice Control Button -->
    <button id="voiceControlBtn" class="voice-control-btn" title="Voice Commands (Click for help)">
        <i class="bi bi-mic-fill"></i>
    </button>

    <!-- Voice Listening Indicator -->
    <div id="voiceListeningIndicator" class="voice-listening-indicator">
        <span class="pulse-circle"></span>
        Listening...
    </div>

    <!-- Voice Command Help -->
    <div id="voiceCommandHelp" class="voice-command-help">
        <h4>ðŸŽ¤ Voice Commands:</h4>
        <ul>
            <li>"Show me October SLA"</li>
            <li>"Switch to Practice Head view"</li>
            <li>"Export this dashboard"</li>
        </ul>
    </div>

    <!-- New Welcome Popup -->
    <div id="welcomePopup" class="welcome-popup-overlay">
        <div class="welcome-popup-card">
            <h1 class="welcome-popup-greeting">Welcome, Tagger! You're now accessing the Customer SLA/KPI Performance Dashboard.</h1>
            <p class="welcome-popup-date" id="welcomeDate"></p>
            <div class="welcome-popup-quote-box">
                <p class="welcome-popup-quote" id="welcomeQuote"></p>
            </div>
            <button class="welcome-popup-btn" onclick="closeWelcomePopup()">Go to Dashboard</button>
        </div>
    </div>

    <!-- Welcome Modal -->
    <!-- Welcome modal disabled - users can access "About Dashboard" view instead -->
    <div id="welcomeModal" class="welcome-modal" style="display: none !important;">
        <div class="welcome-modal-content">
            <div class="welcome-modal-header">
                <h2>ðŸŽ¯ Welcome to TAGGD SLA Performance Dashboard</h2>
                <p>Your Strategic Performance Monitoring Platform</p>
            </div>
            <div class="welcome-modal-body">
                <h3>ðŸ“Š What This Dashboard Offers:</h3>
                <ul>
                    <li><strong>Executive View:</strong> See top/worst performers, most improved/declined accounts, and regional/practice head rankings</li>
                    <li><strong>Multi-Year Comparison:</strong> Compare FY 24-25 with FY 25-26 performance across all metrics</li>
                    <li><strong>Advanced Analytics:</strong> Monthly trends, quarterly analysis, and year-over-year comparisons</li>
                    <li><strong>Detailed Breakdowns:</strong> Project, regional, and practice head level insights</li>
                    <li><strong>Not Reported Analysis:</strong> Track and analyze SLAs not reported each month</li>
                    <li><strong>Industry Benchmarking:</strong> Compare your performance against industry standards</li>
                </ul>
                
                <h3>ðŸš€ Getting Started:</h3>
                <ul>
                    <li><strong>ðŸ“ˆ Demo Data Loaded:</strong> The dashboard has automatically loaded sample data so you can explore features immediately</li>
                    <li><strong>ðŸ“ Upload Your Data:</strong> Use the "Upload Data" button in the sidebar to load your own Excel file and override the sample data</li>
                    <li>Use filters to focus on specific regions, practice heads, accounts, or time periods</li>
                    <li>Navigate between different views using the sidebar menu</li>
                    <li>Enable audio mode for voice descriptions of each section</li>
                    <li>Export your analysis to PDF or PowerPoint for sharing</li>
                </ul>
                
                <p style="color: var(--text-secondary); margin-top: 20px; font-size: 0.95em;">
                    <strong>Note:</strong> This modal won't show again unless you clear your browser cache. 
                    You can always access help from the User Manual in the sidebar.
                </p>
            </div>
            <div class="welcome-modal-footer">
                <button class="welcome-modal-btn primary" onclick="closeWelcomeModal()">
                    âœ“ Got It, Let's Start!
                </button>
                <button class="welcome-modal-btn secondary" onclick="closeWelcomeModal()">
                    Skip
                </button>
            </div>
        </div>
    </div>
    
    <!-- Export Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="bi bi-download"></i> Export Dashboard</h2>
                <span class="close" onclick="closeExportModal()">&times;</span>
            </div>
            
            <div class="export-options">
                <div class="export-section">
                    <h3>Select View to Export:</h3>
                    <select id="exportView" style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid var(--border-color);">
                        <option value="current">Current View</option>
                        <option value="overview">Overview</option>
                        <option value="executive">â­ Executive View</option>
                        <option value="monthly">Monthly Performance</option>
                        <option value="quarterly">Quarterly Performance</option>
                        <option value="yearly">ðŸ“Š Year-over-Year</option>
                        <option value="account">Project Analysis</option>
                        <option value="region">Regional Analysis</option>
                        <option value="practice">Practice Head Analysis</option>
                        <option value="benchmarking">Industry Benchmarking</option>
                        <option value="notreported">Not Reported Analysis</option>
                    </select>
                </div>

                <div class="export-section">
                    <h3>Include Components:</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" id="includeCharts" checked>
                            <span>Charts</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="includeTables" checked>
                            <span>Tables</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="includeInsights" checked>
                            <span>Insights</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="includeComparison" checked>
                            <span>Comparisons</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="export-buttons">
                <button class="export-btn pdf" onclick="exportToPDF()">
                    <i class="bi bi-file-earmark-pdf"></i> Export PDF
                </button>
                <button class="export-btn excel" onclick="exportToExcel()">
                    <i class="bi bi-file-earmark-excel"></i> Export Excel
                </button>
                <button class="export-btn word" onclick="exportToWord()">
                    <i class="bi bi-file-earmark-word"></i> Export Word
                </button>
                <button class="export-btn ppt" onclick="exportToPPT()">
                    <i class="bi bi-file-earmark-slides"></i> Export PPT
                </button>
            </div>
        </div>
    </div>


    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>TAGGD</h2>
            <p>SLA Performance Dashboard v7</p>
        </div>
        
        <div class="sidebar-menu">
            <div class="menu-section-title">Data Management</div>
            <h3>ðŸ“ Data Management</h3>
            <div class="menu-item" onclick="speakAndExecute('Upload Your Data', () => { console.log('ðŸ“¤ Upload button clicked'); const input = document.getElementById('fileUpload'); if(input) { console.log('âœ… Found input, triggering click'); input.click(); } else { console.error('âŒ Input element not found'); } })">
                <i class="bi bi-cloud-upload"></i>
                <span>Upload Your Data</span>
            </div>
            <div class="menu-item" onclick="speakAndExecute('Export Dashboard', openExportModal)">
                <i class="bi bi-download"></i>
                <span>Export Dashboard</span>
            </div>
            
            <div class="menu-section-title">Analysis Views</div>
            <h3>ðŸ“Š Dashboard Views</h3>
            <div class="menu-item active" id="nav-overview" title="High-level summary and key metrics" onclick="speakAndExecute('Overview Dashboard', () => showView('overview'))">
                <i class="bi bi-grid-3x3-gap"></i>
                <span>Overview</span>
            </div>
            <div class="menu-item" id="nav-executive" title="Executive summary with rankings and top performers" onclick="speakAndExecute('Executive View', () => showView('executive'))">
                <i class="bi bi-star-fill"></i>
                <span>Executive View</span>
            </div>
            <div class="menu-item" id="nav-monthly" title="Month-by-month performance trends" onclick="speakAndExecute('Monthly Performance', () => showView('monthly'))">
                <i class="bi bi-calendar-month"></i>
                <span>Monthly Performance</span>
            </div>
            <div class="menu-item" id="nav-quarterly" title="Quarterly analysis and comparisons" onclick="speakAndExecute('Quarterly Performance', () => showView('quarterly'))">
                <i class="bi bi-calendar3"></i>
                <span>Quarterly Performance</span>
            </div>
            <div class="menu-item" id="nav-yearly" title="Year-over-year performance comparison" onclick="speakAndExecute('Year-over-Year Analysis', () => showView('yearly'))">
                <i class="bi bi-arrow-left-right"></i>
                <span>Year-over-Year</span>
            </div>
            <div class="menu-item" id="nav-account" title="Individual project performance details" onclick="speakAndExecute('Project Analysis with Trends', () => showView('account'))">
                <i class="bi bi-building"></i>
                <span>Project Analysis</span>
            </div>
            <div class="menu-item" id="nav-region" title="Regional breakdown and analysis" onclick="speakAndExecute('Regional Analysis', () => showView('region'))">
                <i class="bi bi-geo-alt-fill"></i>
                <span>Regional Analysis</span>
            </div>
            <div class="menu-item" id="nav-practice" title="Practice head performance tracking" onclick="speakAndExecute('Practice Head Analysis', () => showView('practice'))">
                <i class="bi bi-people-fill"></i>
                <span>Practice Head Analysis</span>
            </div>
            <div class="menu-item" id="nav-benchmarking" title="Compare against industry standards" onclick="speakAndExecute('Industry Benchmarking', () => showView('benchmarking'))">
                <i class="bi bi-trophy-fill"></i>
                <span>Industry Benchmarking</span>
            </div>
            <div class="menu-item" id="nav-notreported" title="Analysis of Not Reported SLAs" onclick="speakAndExecute('Not Reported Analysis', () => showView('notreported'))">
                <i class="bi bi-exclamation-triangle-fill"></i>
                <span>Not Reported Analysis</span>
            </div>
        </div>

        
            <div class="menu-section-title">Help & Resources</div>
            <h3>â“ Help & Support</h3>
            <div class="menu-item" id="nav-about" onclick="speakAndExecute('About Dashboard', () => showView('about'))">
                <i class="bi bi-info-circle-fill"></i>
                <span>About Dashboard</span>
            </div>
            <div class="menu-item" id="nav-manual" onclick="speakAndExecute('User Manual', () => showView('manual'))">
                <i class="bi bi-book-fill"></i>
                <span>User Manual</span>
            </div>
        <div class="control-buttons">
            <button class="control-btn" id="audioBtn" onclick="toggleAudioMode()">
                <i class="bi bi-volume-up" id="audioIcon"></i>
                <span id="audioText">Enable Audio</span>
            </button>
            <button class="control-btn" onclick="toggleTheme()">
                <i class="bi bi-moon-stars" id="themeIcon"></i>
                <span id="themeText">Dark Mode</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <input type="file" id="fileUpload" accept=".xlsx,.xls" style="display: none;" />
        
        <div class="header">
            <h1><i class="bi bi-bar-chart-fill"></i> Executive SLA Performance Dashboard</h1>
            <p>Strategic Performance Monitoring & Competitive Intelligence Platform</p>
        </div>

        <div class="controls">
            <h3>
                <i class="bi bi-funnel-fill"></i> 
                Advanced Filters
            </h3>
            <div class="filter-section" id="filterSection">
                <div class="filter-group">
                    <label><i class="bi bi-calendar"></i> Fiscal Year:</label>
                    <select id="fyFilter" onchange="applyFilters()">
                        <option value="all">All Years (Comparison Mode)</option>
                        <option value="fy24_25">FY 2024-25 Only</option>
                        <option value="fy25_26">FY 2025-26 Only</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="bi bi-person-badge"></i> Regional Head:</label>
                    <select id="regionalHeadFilter" multiple="multiple" style="width: 100%;">
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="bi bi-geo-alt"></i> Region:</label>
                    <select id="regionFilter" multiple="multiple" style="width: 100%;">
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="bi bi-people"></i> Practice Head:</label>
                    <select id="practiceFilter" multiple="multiple" style="width: 100%;">
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="bi bi-building"></i> Account:</label>
                    <select id="accountFilter" multiple="multiple" style="width: 100%;">
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="bi bi-calendar-month"></i> Month:</label>
                    <select id="monthFilter" onchange="applyFilters()">
                        <option value="all">All Months</option>
                        <option value="Apr">April</option>
                        <option value="May">May</option>
                        <option value="Jun">June</option>
                        <option value="Jul">July</option>
                        <option value="Aug">August</option>
                        <option value="Sep">September</option>
                        <option value="Oct">October</option>
                        <option value="Nov">November</option>
                        <option value="Dec">December</option>
                        <option value="Jan">January</option>
                        <option value="Feb">February</option>
                        <option value="Mar">March</option>
                    </select>
                
            <div class="filter-group">
                <label><i class="bi bi-translate"></i> Audio Language:</label>
                <select id="audioLanguage" onchange="changeAudioLanguage()">
                    <option value="en-US">English</option>
                    <option value="hi-IN">Hindi (à¤¹à¤¿à¤‚à¤¦à¥€)</option>
                </select>
            </div>
            </div>
            </div>
            <div class="filter-actions">
                <button onclick="speakAndExecute('Applying filters', applyFilters)">
                    <i class="bi bi-check-circle"></i> Apply Filters
                </button>
                <button class="clear-filters-btn" onclick="speakAndExecute('Clearing all filters', clearAllFilters)">
                    <i class="bi bi-x-circle"></i> Clear All Filters
                </button>
            </div>
        </div>

        <div id="dashboardContent"></div>

        <div class="footer" style="text-align: center; padding: 20px; color: var(--text-secondary); margin-top: 35px; font-size: 0.85em; border-top: 2px solid var(--border-color);">
            <p><strong>TAGGD</strong> - Executive SLA Performance Dashboard v7 Enhanced Â© 2025 | Confidential - For Internal Use Only</p>
        </div>
    </div>

    <script>

        // Safe element selector helper
        function safeGetValue(selector, defaultValue = '') {
            try {
                const element = document.querySelector(selector);
                return element?.value || defaultValue;
            } catch (error) {
                console.warn('Element not found:', selector);
                return defaultValue;
            }
        }

        // ============================================================================
        // WELCOME POPUP - Random Quotes and Current Date
        // ============================================================================
        
        const inspirationalQuotes = [
            "Data is not just numbers â€” it's a story waiting to be understood ðŸ™‚",
            "Great decisions come from great data ðŸ™‚",
            "Analytics turns uncertainty into clarity ðŸ™‚",
            "Without data, you're just another person with an opinion ðŸ™‚",
            "Small insights lead to big improvements ðŸ™‚",
            "Quality is never an accident; it is always the result of intelligent data ðŸ™‚",
            "What gets measured gets improved ðŸ™‚",
            "Data speaks louder than assumptions ðŸ™‚",
            "Every number has a reason â€” find it ðŸ™‚",
            "Smart teams follow data, not guesses ðŸ™‚",
            "Improvement begins the moment you start measuring ðŸ™‚",
            "Let data guide you, not emotions ðŸ™‚",
            "Accuracy is the heart of excellence ðŸ™‚",
            "Consistent data creates consistent performance ðŸ™‚",
            "Better data = better outcomes ðŸ™‚"
        ];

        function getRandomQuote() {
            const randomIndex = Math.floor(Math.random() * inspirationalQuotes.length);
            return inspirationalQuotes[randomIndex];
        }

        function getCurrentFormattedDate() {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                          'July', 'August', 'September', 'October', 'November', 'December'];
            
            const now = new Date();
            const dayName = days[now.getDay()];
            const day = now.getDate();
            const monthName = months[now.getMonth()];
            const year = now.getFullYear();
            
            return `${dayName}, ${day} ${monthName} ${year}`;
        }

        function initializeWelcomePopup() {
            // Set current date
            const dateElement = document.getElementById('welcomeDate');
            if (dateElement) {
                dateElement.textContent = getCurrentFormattedDate();
            }
            
            // Set random quote
            const quoteElement = document.getElementById('welcomeQuote');
            if (quoteElement) {
                quoteElement.textContent = getRandomQuote();
            }
            
            // Show popup
            const popup = document.getElementById('welcomePopup');
            if (popup) {
                popup.style.display = 'flex';
            }
        }

        function closeWelcomePopup() {
            const popup = document.getElementById('welcomePopup');
            if (popup) {
                popup.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => {
                    popup.style.display = 'none';
                }, 300);
            }
        }

        // Add fadeOut animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Initialize popup when page loads
        window.addEventListener('load', function() {
            // Small delay to ensure DOM is fully ready
            setTimeout(initializeWelcomePopup, 100);
            // Initialize last updated timestamp
            updateLastUpdatedTimestamp();
            // Initialize voice control
            initializeVoiceControl();
        });

        // ============================================================================
        // FEATURE 1: LAST UPDATED TIMESTAMP
        // ============================================================================
        
        function updateLastUpdatedTimestamp() {
            const now = new Date();
            const formatted = formatTimestamp(now);
            const timestampElement = document.getElementById('timestampText');
            if (timestampElement) {
                timestampElement.textContent = formatted;
            }
        }

        function formatTimestamp(date) {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                           'July', 'August', 'September', 'October', 'November', 'December'];
            
            const dayName = days[date.getDay()];
            const day = date.getDate();
            const month = months[date.getMonth()];
            const year = date.getFullYear();
            const hours = date.getHours();
            const minutes = date.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12;
            
            return `${dayName}, ${day} ${month} ${year}, ${displayHours}:${minutes} ${ampm}`;
        }

        // ============================================================================
        // FEATURE 2: VOICE-ENABLED NAVIGATION
        // ============================================================================
        
        // Web Speech API Integration
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;
        let isListening = false;
        let voiceControlEnabled = false;

        function initializeVoiceControl() {
            if (SpeechRecognition) {
                recognition = new SpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                
                recognition.onstart = () => {
                    console.log('Voice recognition started');
                    isListening = true;
                    playBeep(true);
                    showListeningIndicator(true);
                    const voiceBtn = document.getElementById('voiceControlBtn');
                    if (voiceBtn) {
                        voiceBtn.classList.add('listening');
                    }
                };
                
                recognition.onresult = (event) => {
                    const command = event.results[0][0].transcript.toLowerCase();
                    console.log('Voice command received:', command);
                    processVoiceCommand(command);
                };
                
                recognition.onerror = (event) => {
                    console.error('Voice recognition error:', event.error);
                    if (event.error === 'no-speech') {
                        showToast('No speech detected. Please try again.', 'info');
                    } else if (event.error === 'not-allowed') {
                        showToast('Microphone access denied. Please enable it in browser settings.', 'error');
                        voiceControlEnabled = false;
                    } else {
                        showToast('Voice recognition error. Please try again.', 'error');
                    }
                    showListeningIndicator(false);
                    isListening = false;
                    const voiceBtn = document.getElementById('voiceControlBtn');
                    if (voiceBtn) {
                        voiceBtn.classList.remove('listening');
                    }
                };
                
                recognition.onend = () => {
                    console.log('Voice recognition ended');
                    playBeep(false);
                    showListeningIndicator(false);
                    isListening = false;
                    const voiceBtn = document.getElementById('voiceControlBtn');
                    if (voiceBtn) {
                        voiceBtn.classList.remove('listening');
                    }
                };

                voiceControlEnabled = true;
            } else {
                console.warn('Web Speech API not supported in this browser');
                voiceControlEnabled = false;
            }

            // Attach event listeners
            const voiceBtn = document.getElementById('voiceControlBtn');
            if (voiceBtn) {
                voiceBtn.addEventListener('click', toggleVoiceRecognition);
                voiceBtn.addEventListener('mouseenter', showVoiceHelp);
                voiceBtn.addEventListener('mouseleave', hideVoiceHelp);
            }
        }

        function toggleVoiceRecognition() {
            if (!voiceControlEnabled) {
                showToast('Voice recognition not supported in this browser. Please use Chrome or Edge.', 'error');
                return;
            }

            if (isListening) {
                recognition.stop();
            } else {
                try {
                    recognition.start();
                } catch (error) {
                    console.error('Error starting recognition:', error);
                    showToast('Could not start voice recognition. Please try again.', 'error');
                }
            }
        }

        function showListeningIndicator(show) {
            const indicator = document.getElementById('voiceListeningIndicator');
            if (indicator) {
                if (show) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            }
        }

        function showVoiceHelp() {
            const help = document.getElementById('voiceCommandHelp');
            if (help && !isListening) {
                help.classList.add('active');
            }
        }

        function hideVoiceHelp() {
            const help = document.getElementById('voiceCommandHelp');
            if (help) {
                help.classList.remove('active');
            }
        }

        function processVoiceCommand(command) {
            console.log('Processing command:', command);
            const lowerCommand = command.toLowerCase();
            
            // Month mapping for intelligent recognition
            const monthMap = {
                'january': 'Jan', 'jan': 'Jan',
                'february': 'Feb', 'feb': 'Feb',
                'march': 'Mar', 'mar': 'Mar', 'march': 'March',
                'april': 'Apr', 'apr': 'Apr',
                'may': 'May',
                'june': 'Jun', 'jun': 'Jun', 'june': 'June',
                'july': 'Jul', 'jul': 'Jul', 'july': 'July',
                'august': 'Aug', 'aug': 'Aug',
                'september': 'Sep', 'sept': 'Sep', 'sep': 'Sep',
                'october': 'Oct', 'oct': 'Oct',
                'november': 'Nov', 'nov': 'Nov',
                'december': 'Dec', 'dec': 'Dec'
            };

            // Region mapping for intelligent recognition
            const regionMap = {
                'north': 'North',
                'south': 'South',
                'south 1': 'South 1',
                'south 2': 'South 2',
                'south1': 'South 1',
                'south2': 'South 2',
                'east': 'East',
                'west': 'West',
                'west 1': 'West 1',
                'west 2': 'West 2',
                'west1': 'West 1',
                'west2': 'West 2'
            };

            // Practice head mapping for intelligent recognition
            const practiceHeadMap = {
                'krishna': 'Krishna',
                'bapi': 'Bapi Reddy',
                'bapi reddy': 'Bapi Reddy',
                'megha': 'Megha',
                'elton': 'Elton',
                'usha': 'Usha',
                'geetu': 'Geetu',
                'amit': 'Amit',
                'subhashree': 'Subhashree'
            };
            
            // ===================================================================
            // INTELLIGENT MONTH FILTER
            // ===================================================================
            for (const [key, value] of Object.entries(monthMap)) {
                if (lowerCommand.includes(key)) {
                    showToast(`Setting filter to ${value}...`, 'success');
                    setTimeout(() => {
                        const monthFilter = document.getElementById('monthFilter');
                        if (monthFilter) {
                            monthFilter.value = value;
                            applyFilters();
                        }
                        showView('overview');
                    }, 500);
                    return;
                }
            }
            
            // ===================================================================
            // INTELLIGENT REGION FILTER
            // ===================================================================
            for (const [key, value] of Object.entries(regionMap)) {
                if (lowerCommand.includes(key) && (lowerCommand.includes('region') || lowerCommand.includes('sla'))) {
                    showToast(`Filtering to ${value} region...`, 'success');
                    setTimeout(() => {
                        // Get the Region filter Select2 element
                        const regionFilter = $('#regionFilter');
                        if (regionFilter.length) {
                            // Clear existing selections
                            regionFilter.val(null).trigger('change');
                            // Set new value
                            regionFilter.val([value]).trigger('change');
                            // Apply filters
                            applyFilters();
                            showView('overview');
                        }
                    }, 500);
                    return;
                }
            }
            
            // ===================================================================
            // INTELLIGENT PRACTICE HEAD FILTER
            // ===================================================================
            for (const [key, value] of Object.entries(practiceHeadMap)) {
                if (lowerCommand.includes(key) && (lowerCommand.includes('practice') || lowerCommand.includes('head') || lowerCommand.includes('filter'))) {
                    showToast(`Filtering to ${value} practice head...`, 'success');
                    setTimeout(() => {
                        // Get the Practice Head filter Select2 element
                        const practiceFilter = $('#practiceFilter');
                        if (practiceFilter.length) {
                            // Clear existing selections
                            practiceFilter.val(null).trigger('change');
                            // Set new value
                            practiceFilter.val([value]).trigger('change');
                            // Apply filters
                            applyFilters();
                            showView('practice');
                        }
                    }, 500);
                    return;
                }
            }
            
            // ===================================================================
            // VIEW NAVIGATION COMMANDS
            // ===================================================================
            if ((lowerCommand.includes('practice') && lowerCommand.includes('head') && lowerCommand.includes('view')) ||
                (lowerCommand.includes('switch') && lowerCommand.includes('practice'))) {
                showToast('Opening Practice Head view...', 'success');
                setTimeout(() => {
                    showView('practice');
                }, 500);
                return;
            }
            
            if (lowerCommand.includes('overview') || (lowerCommand.includes('show') && lowerCommand.includes('dashboard'))) {
                showToast('Opening dashboard overview...', 'success');
                setTimeout(() => {
                    showView('overview');
                }, 500);
                return;
            }

            if (lowerCommand.includes('monthly') || (lowerCommand.includes('show') && lowerCommand.includes('month'))) {
                showToast('Opening monthly view...', 'success');
                setTimeout(() => {
                    showView('monthly');
                }, 500);
                return;
            }

            if (lowerCommand.includes('quarterly') || (lowerCommand.includes('show') && lowerCommand.includes('quarter'))) {
                showToast('Opening quarterly view...', 'success');
                setTimeout(() => {
                    showView('quarterly');
                }, 500);
                return;
            }

            if (lowerCommand.includes('account') && lowerCommand.includes('view')) {
                showToast('Opening account view...', 'success');
                setTimeout(() => {
                    showView('account');
                }, 500);
                return;
            }

            if (lowerCommand.includes('not reported')) {
                showToast('Opening not reported analysis...', 'success');
                setTimeout(() => {
                    showView('notreported');
                }, 500);
                return;
            }

            if (lowerCommand.includes('benchmark')) {
                showToast('Opening benchmarking view...', 'success');
                setTimeout(() => {
                    showView('benchmarking');
                }, 500);
                return;
            }
            
            // ===================================================================
            // EXPORT COMMANDS
            // ===================================================================
            if (lowerCommand.includes('export') || lowerCommand.includes('download') || lowerCommand.includes('pdf')) {
                showToast('Opening export options...', 'success');
                setTimeout(() => {
                    const exportBtn = document.getElementById('exportPdfBtn');
                    if (exportBtn) {
                        exportBtn.click();
                    } else {
                        exportToPDF();
                    }
                }, 500);
                return;
            }

            // ===================================================================
            // CLEAR FILTERS COMMAND
            // ===================================================================
            if (lowerCommand.includes('clear') && lowerCommand.includes('filter')) {
                showToast('Clearing all filters...', 'success');
                setTimeout(() => {
                    // Clear all filters
                    $('#regionalHeadFilter').val(null).trigger('change');
                    $('#regionFilter').val(null).trigger('change');
                    $('#practiceFilter').val(null).trigger('change');
                    $('#accountFilter').val(null).trigger('change');
                    document.getElementById('monthFilter').value = 'All';
                    applyFilters();
                }, 500);
                return;
            }
            
            // ===================================================================
            // COMMAND NOT RECOGNIZED
            // ===================================================================
            showToast('Sorry, I didn\'t understand. Try: "Show me North region", "Filter Krishna", "Show me October", or "Export dashboard"', 'info');
        }

        function playBeep(isStart) {
            // Create a simple beep sound using Web Audio API
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = isStart ? 800 : 600; // Higher pitch for start, lower for stop
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            } catch (error) {
                console.log('Could not play beep:', error);
            }
        }

                // Global Variables
        
// ============================================================================
// NOT REPORTED DATA - Integrated from Excel
// ============================================================================
const notReportedData = {
    fy24_25: [{"Project":"BITS","Region":"South 2","Practice Head":"Krishna","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Honeywell","Region":"South 1 ","Practice Head":"Bapi Reddy","Apr MET\/NOT_MET_NotReported":5,"May MET\/NOT_MET_NotReported":5,"June MET\/NOT_MET_NotReported":13,"July MET\/NOT_MET_NotReported":5,"Aug MET\/NOT_MET_NotReported":1,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"M&M","Region":"West 1","Practice Head":"Megha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":1,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":1,"Dec MET\/NOT_MET_NotReported":1,"Jan MET\/NOT_MET_NotReported":1,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Mahindra Holidays","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":1,"June MET\/NOT_MET_NotReported":8,"July MET\/NOT_MET_NotReported":8,"Aug MET\/NOT_MET_NotReported":2,"Sep MET\/NOT_MET_NotReported":2,"Oct MET\/NOT_MET_NotReported":2,"Nov MET\/NOT_MET_NotReported":8,"Dec MET\/NOT_MET_NotReported":8,"Jan MET\/NOT_MET_NotReported":8,"Feb MET\/NOT_MET_NotReported":8,"March MET\/NOT_MET_NotReported":8},{"Project":"Mahindra Finance","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"P&G","Region":"South 2","Practice Head":"Krishna","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Pfizer (FLM\/RBM)","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Pfizer (FS & FLM)","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":1,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":2},{"Project":"Pfizer (FS)","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Pfizer (FS\/FLM\/RBM)","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":1,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":1,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":2,"Oct MET\/NOT_MET_NotReported":2,"Nov MET\/NOT_MET_NotReported":1,"Dec MET\/NOT_MET_NotReported":1,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":5},{"Project":"Pfizer (FS & FLM) (Chennai)","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Pidilite","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":12,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"SKF","Region":"North","Practice Head":"Naved","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Tata Motors","Region":"West 1","Practice Head":"Shweta","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"TATA Power","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"ISUZU (UD Trucks)","Region":"South 1 ","Practice Head":"Sulabh","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":8,"Aug MET\/NOT_MET_NotReported":8,"Sep MET\/NOT_MET_NotReported":8,"Oct MET\/NOT_MET_NotReported":8,"Nov MET\/NOT_MET_NotReported":8,"Dec MET\/NOT_MET_NotReported":8,"Jan MET\/NOT_MET_NotReported":8,"Feb MET\/NOT_MET_NotReported":8,"March MET\/NOT_MET_NotReported":8},{"Project":"Vertiv Energy","Region":"West 2","Practice Head":"Shweta","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Siemens - GBS","Region":"South 1 ","Practice Head":"Sulabh","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Siemens - Advanta","Region":"South 1 ","Practice Head":"Sulabh","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Robert Bosch","Region":"South 1 ","Practice Head":"Sulabh","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Servify","Region":"West 1","Practice Head":"Ashish","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Birla Paints","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":1,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Ingram Micro","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":1,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":1,"March MET\/NOT_MET_NotReported":1},{"Project":"Wipro","Region":"South 1 ","Practice Head":"Sulabh","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":1,"March MET\/NOT_MET_NotReported":1},{"Project":"Thyssenkrupp","Region":"West 1","Practice Head":"Shweta","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Siemens - Energy","Region":"South 1 ","Practice Head":"Sulabh","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"HPE","Region":"South 1 ","Practice Head":"Mahak","Apr MET\/NOT_MET_NotReported":18,"May MET\/NOT_MET_NotReported":8,"June MET\/NOT_MET_NotReported":18,"July MET\/NOT_MET_NotReported":18,"Aug MET\/NOT_MET_NotReported":8,"Sep MET\/NOT_MET_NotReported":8,"Oct MET\/NOT_MET_NotReported":8,"Nov MET\/NOT_MET_NotReported":8,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"TATA Marco Polo","Region":"West 1","Practice Head":"Shweta","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":2,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"WTW (Ops)","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":5,"May MET\/NOT_MET_NotReported":2,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"WTW (Tech)","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":5,"May MET\/NOT_MET_NotReported":2,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"WTW (Ops & Tech)","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"FedEx","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"DP World","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":7,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":7,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":7},{"Project":"Ametek","Region":"South 1 ","Practice Head":"Sulabh","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":7,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":7,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":7,"Jan MET\/NOT_MET_NotReported":7,"Feb MET\/NOT_MET_NotReported":7,"March MET\/NOT_MET_NotReported":7},{"Project":"Ultratech","Region":"West 2","Practice Head":"Shweta","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"TATA Electronics","Region":"South 2","Practice Head":"Krishna","Apr MET\/NOT_MET_NotReported":9,"May MET\/NOT_MET_NotReported":9,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":5,"March MET\/NOT_MET_NotReported":5},{"Project":"AMNS","Region":"West 1","Practice Head":"Bikash\/Piyush","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"TITAN","Region":"South 1 ","Practice Head":"Sulabh","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":7,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":7,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Jindal","Region":"North","Practice Head":"Kirti","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":1,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":1},{"Project":"TATA Tele","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"NomiSo","Region":"South 2","Practice Head":"Ashish","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Royal Enfield","Region":"South 2","Practice Head":"Krishna","Apr MET\/NOT_MET_NotReported":7,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"SBI Card","Region":"North","Practice Head":"Naved","Apr MET\/NOT_MET_NotReported":3,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":2,"Dec MET\/NOT_MET_NotReported":2,"Jan MET\/NOT_MET_NotReported":2,"Feb MET\/NOT_MET_NotReported":4,"March MET\/NOT_MET_NotReported":0},{"Project":"Schaeffler","Region":"West 2","Practice Head":"Shweta","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":8,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Excelacom","Region":"South 2","Practice Head":"Krishna","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":7,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Hyundai","Region":"West 2","Practice Head":"Shweta","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":7,"Aug MET\/NOT_MET_NotReported":2,"Sep MET\/NOT_MET_NotReported":2,"Oct MET\/NOT_MET_NotReported":8,"Nov MET\/NOT_MET_NotReported":2,"Dec MET\/NOT_MET_NotReported":2,"Jan MET\/NOT_MET_NotReported":2,"Feb MET\/NOT_MET_NotReported":2,"March MET\/NOT_MET_NotReported":2},{"Project":"Maruti Suzuki","Region":"North","Practice Head":"Naved","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":7,"Sep MET\/NOT_MET_NotReported":7,"Oct MET\/NOT_MET_NotReported":7,"Nov MET\/NOT_MET_NotReported":7,"Dec MET\/NOT_MET_NotReported":7,"Jan MET\/NOT_MET_NotReported":7,"Feb MET\/NOT_MET_NotReported":7,"March MET\/NOT_MET_NotReported":7},{"Project":"TATA Fiber","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":2,"Jan MET\/NOT_MET_NotReported":7,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"TATA Consumer","Region":"West 1","Practice Head":"Usha","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Atomberg","Region":"West 1","Practice Head":"Elton","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0},{"Project":"Subros","Region":"North","Practice Head":"Naved","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":7,"Jan MET\/NOT_MET_NotReported":3,"Feb MET\/NOT_MET_NotReported":3,"March MET\/NOT_MET_NotReported":0},{"Project":"Sterling tools","Region":"North","Practice Head":"Naved","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":6},{"Project":"Ashok Leyland","Region":"South 2","Practice Head":"Krishna","Apr MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0,"Oct MET\/NOT_MET_NotReported":0,"Nov MET\/NOT_MET_NotReported":0,"Dec MET\/NOT_MET_NotReported":0,"Jan MET\/NOT_MET_NotReported":0,"Feb MET\/NOT_MET_NotReported":0,"March MET\/NOT_MET_NotReported":0}],
    fy25_26: [{"Project":"BITS","Region":"South 2","Practice Head":"Krishna","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Honeywell","Region":"South 1 ","Practice Head":"Bapi Reddy","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"M&M","Region":"West 1","Practice Head":"Megha","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":14,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":14,"Sep MET\/NOT_MET_NotReported":14},{"Project":"Mahindra Holidays","Region":"West 1","Practice Head":"Geetu","April MET\/NOT_MET_NotReported":8,"May MET\/NOT_MET_NotReported":8,"June MET\/NOT_MET_NotReported":8,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":8,"Sep MET\/NOT_MET_NotReported":8},{"Project":"Mahindra Finance","Region":"West 1","Practice Head":"Geetu","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"P&G","Region":"South 2","Practice Head":"Krishna","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Pfizer (FLM\/RBM)","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":6,"May MET\/NOT_MET_NotReported":6,"June MET\/NOT_MET_NotReported":6,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":6,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Pfizer (FS & FLM)","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":2,"May MET\/NOT_MET_NotReported":2,"June MET\/NOT_MET_NotReported":2,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":1,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Pfizer (FS)","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":7,"May MET\/NOT_MET_NotReported":7,"June MET\/NOT_MET_NotReported":7,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Pfizer (FS\/FLM\/RBM)","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":7,"May MET\/NOT_MET_NotReported":7,"June MET\/NOT_MET_NotReported":7,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":4,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Pfizer (FS & FLM) (Chennai)","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Pidilite","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"SKF","Region":"North","Practice Head":"Naved","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"TATA Power","Region":"West 1","Practice Head":"Elton","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"ISUZU (UD Trucks)","Region":"South 1 ","Practice Head":"Sulabh","April MET\/NOT_MET_NotReported":8,"May MET\/NOT_MET_NotReported":8,"June MET\/NOT_MET_NotReported":8,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":8,"Sep MET\/NOT_MET_NotReported":8},{"Project":"Vertiv Energy","Region":"West 2","Practice Head":"Shweta","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":1,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Siemens - GBS","Region":"South 1 ","Practice Head":"Sulabh","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":11},{"Project":"Siemens - Advanta","Region":"South 1 ","Practice Head":"Sulabh","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":11},{"Project":"Robert Bosch","Region":"South 1 ","Practice Head":"Sulabh","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Servify","Region":"West 1","Practice Head":"Ashish","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Birla Paints","Region":"West 1","Practice Head":"Geetu","April MET\/NOT_MET_NotReported":8,"May MET\/NOT_MET_NotReported":8,"June MET\/NOT_MET_NotReported":8,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":8,"Sep MET\/NOT_MET_NotReported":8},{"Project":"Ingram Micro","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":1,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Wipro","Region":"South 1 ","Practice Head":"Sulabh","April MET\/NOT_MET_NotReported":1,"May MET\/NOT_MET_NotReported":1,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Siemens - Energy","Region":"South 1 ","Practice Head":"Sulabh","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":11},{"Project":"HPE","Region":"South 1 ","Practice Head":"Mahak","April MET\/NOT_MET_NotReported":10,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"WTW (Ops)","Region":"West 1","Practice Head":"Elton","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"WTW (Tech)","Region":"West 1","Practice Head":"Elton","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"WTW (Ops & Tech)","Region":"West 1","Practice Head":"Elton","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"DP World","Region":"West 1","Practice Head":"Geetu","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":7,"Sep MET\/NOT_MET_NotReported":7},{"Project":"Ametek","Region":"South 1 ","Practice Head":"Sulabh","April MET\/NOT_MET_NotReported":7,"May MET\/NOT_MET_NotReported":7,"June MET\/NOT_MET_NotReported":7,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":7,"Sep MET\/NOT_MET_NotReported":7},{"Project":"Ultratech","Region":"West 2","Practice Head":"Shweta","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"TATA Electronics","Region":"South 2","Practice Head":"Krishna","April MET\/NOT_MET_NotReported":9,"May MET\/NOT_MET_NotReported":5,"June MET\/NOT_MET_NotReported":5,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":9},{"Project":"AMNS","Region":"West 1","Practice Head":"Alifiya","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"TITAN","Region":"South 1 ","Practice Head":"Sulabh","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Jindal","Region":"North","Practice Head":"Kirti","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":1,"June MET\/NOT_MET_NotReported":1,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":1,"Sep MET\/NOT_MET_NotReported":1},{"Project":"TATA Tele","Region":"West 1","Practice Head":"Elton","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Royal Enfield","Region":"South 2","Practice Head":"Krishna","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":8},{"Project":"SBI Card","Region":"North","Practice Head":"Naved","April MET\/NOT_MET_NotReported":12,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":1,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":12,"Sep MET\/NOT_MET_NotReported":12},{"Project":"Schaeffler","Region":"West 2","Practice Head":"Shweta","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":1,"June MET\/NOT_MET_NotReported":2,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":1,"Sep MET\/NOT_MET_NotReported":1},{"Project":"Excelacom","Region":"South 2","Practice Head":"Krishna","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Hyundai","Region":"West 2","Practice Head":"Shweta","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":2,"June MET\/NOT_MET_NotReported":2,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":2,"Sep MET\/NOT_MET_NotReported":2},{"Project":"Maruti Suzuki","Region":"North","Practice Head":"Naved","April MET\/NOT_MET_NotReported":8,"May MET\/NOT_MET_NotReported":1,"June MET\/NOT_MET_NotReported":3,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"TATA Fiber","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":7,"May MET\/NOT_MET_NotReported":7,"June MET\/NOT_MET_NotReported":7,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":7},{"Project":"TATA Consumer","Region":"West 1","Practice Head":"Usha","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Atomberg","Region":"West 1","Practice Head":"Geetu","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Subros","Region":"North","Practice Head":"Naved","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":8},{"Project":"Sterling tools","Region":"North","Practice Head":"Naved","April MET\/NOT_MET_NotReported":6,"May MET\/NOT_MET_NotReported":6,"June MET\/NOT_MET_NotReported":6,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":0},{"Project":"Ashok Leyland","Region":"South 2","Practice Head":"Krishna","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":0,"June MET\/NOT_MET_NotReported":0,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":0,"Sep MET\/NOT_MET_NotReported":9},{"Project":"Bridgestone","Region":"West 2","Practice Head":"Shweta","April MET\/NOT_MET_NotReported":0,"May MET\/NOT_MET_NotReported":2,"June MET\/NOT_MET_NotReported":2,"July MET\/NOT_MET_NotReported":0,"Aug MET\/NOT_MET_NotReported":2,"Sep MET\/NOT_MET_NotReported":2}]
};

// Process Not Reported data for easy access
function processNotReportedData() {
    const processed = {
        fy24_25: {},
        fy25_26: {}
    };
    
    // Process FY24-25
    notReportedData.fy24_25.forEach(row => {
        const account = row.Project;
        const months = {};
        let total = 0;
        
        Object.keys(row).forEach(key => {
            if (key.includes('NotReported')) {
                const month = key.split(' ')[0];
                const value = row[key] || 0;
                months[month] = value;
                total += value;
            }
        });
        
        processed.fy24_25[account] = {
            account: account,
            regionalHead: row['Regional Head '] || row['Regional Head'],
            region: row.Region,
            practiceHead: row['Practice Head'],
            months: months,
            total: total
        };
    });
    
    // Process FY25-26
    notReportedData.fy25_26.forEach(row => {
        const account = row.Project;
        const months = {};
        let total = 0;
        
        Object.keys(row).forEach(key => {
            if (key.includes('NotReported')) {
                const month = key.split(' ')[0];
                const value = row[key] || 0;
                months[month] = value;
                total += value;
            }
        });
        
        processed.fy25_26[account] = {
            account: account,
            regionalHead: row['Regional Head '] || row['Regional Head'],
            region: row.Region,
            practiceHead: row['Practice Head'],
            months: months,
            total: total
        };
    });
    
    return processed;
}

const processedNotReported = processNotReportedData();


let rawData = null;
        let fy2425NotReportedData = [];
        let fy2526NotReportedData = [];
        let parsedData = null;
        let filteredData = null;
        let currentView = 'overview';
        let charts = {};
        let audioEnabled = false;

        let audioLanguage = 'en-US'; // Default to English
        let voicesLoaded = false;
        
        // Load voices when available
        if ('speechSynthesis' in window) {
            window.speechSynthesis.onvoiceschanged = function() {
                voicesLoaded = true;
            };
            // Try to load voices immediately
            window.speechSynthesis.getVoices();
        }
        
        function changeAudioLanguage() {
            audioLanguage = document.getElementById('audioLanguage').value;
            const langName = audioLanguage === 'hi-IN' ? 'Hindi' : 'English';
            
            // Check if selected language voice is available
            const voices = window.speechSynthesis.getVoices();
            const hasVoice = voices.some(voice => voice.lang.startsWith(audioLanguage.split('-')[0]));
            
            if (audioLanguage === 'hi-IN' && !hasVoice) {
                showToast(`âš ï¸ Audio language set to ${langName}, but Hindi voice may not be available. Install Hindi language pack in your browser for Hindi audio.`);
                if (audioEnabled) {
                    // Speak in English to inform about the limitation
                    const tempLang = audioLanguage;
                    audioLanguage = 'en-US';
                    speak('Hindi voice not available. Please install Hindi language pack in your browser settings.');
                    audioLanguage = tempLang;
                }
            } else {
                showToast(`Audio language changed to ${langName}`);
                if (audioEnabled) {
                    speak(`Audio language changed to ${langName}`);
                }
            }
        }

        let activeFilters = {
            fy: 'all',
            regionalHead: [],
            region: [],
            practice: [],
            account: [],
            month: 'all'
        };

        // Industry Benchmarks (Investment column removed)
        const industryBenchmarks = {
            competitors: {
                'Korn Ferry': { 
                    sla: 89.5, 
                    feature: 'AI-Powered Talent Intelligence Platform', 
                    sourceUrl: 'https://ir.kornferry.com/annual-reports-and-proxy',
                    sourceName: 'Korn Ferry Annual Report 2024',
                    innovation: 'Korn Ferry Intelligence Cloud with GenAI-powered talent insights, predictive succession planning, and skills ontology mapping across 50M+ professionals',
                    innovationSource: 'Korn Ferry Technology Innovations 2024',
                    innovationUrl: 'https://www.kornferry.com/insights/this-week-in-leadership/talent-intelligence-ai'
                },
                'Randstad': { 
                    sla: 87.8, 
                    feature: 'Predictive Analytics for Client Retention', 
                    sourceUrl: 'https://www.randstad.com/investor-relations/reports-and-presentations/',
                    sourceName: 'Randstad Annual Report 2024',
                    innovation: 'Randstad AI Matching Engine with automated candidate screening, video interview analysis, and 48-hour time-to-shortlist guarantee using ML algorithms',
                    innovationSource: 'Randstad Digital Innovation Report 2024',
                    innovationUrl: 'https://www.randstad.com/workforce-insights/talent-acquisition/ai-recruitment/'
                },
                'Robert Half': { 
                    sla: 86.4, 
                    feature: 'Real-time Candidate Matching & Chatbot', 
                    sourceUrl: 'https://www.roberthalf.com/investors/financial-information/annual-reports',
                    sourceName: 'Robert Half Annual Report 2024',
                    innovation: 'Robert Half Digital Platform with GPT-4 powered career chatbot handling 10,000+ daily interactions, automated skill assessments, and mobile-first candidate experience',
                    innovationSource: 'Robert Half Technology Roadmap 2024',
                    innovationUrl: 'https://www.roberthalf.com/us/en/insights/management-resources/ai-recruiting-tools'
                },
                'ManpowerGroup': { 
                    sla: 85.9, 
                    feature: 'Global Talent Pool Network & Blockchain', 
                    sourceUrl: 'https://investor.manpowergroup.com/financials/annual-reports',
                    sourceName: 'ManpowerGroup Annual Report 2024',
                    innovation: 'ManpowerGroup MyPath with blockchain-verified credentials, VR job simulations for 200+ roles, and AI-driven upskilling recommendations integrated with learning platforms',
                    innovationSource: 'ManpowerGroup Skills Revolution Report 2024',
                    innovationUrl: 'https://www.manpowergroup.com/workforce-insights/world-of-work/skills-revolution'
                },
                'Adecco Group': { 
                    sla: 84.7, 
                    feature: 'Mobile-First Platform & Skills Analytics', 
                    sourceUrl: 'https://www.adeccogroup.com/investors/financial-reports/',
                    sourceName: 'Adecco Group Annual Report 2024',
                    innovation: 'Adecco Digital Factory with AI job recommendations, automated onboarding in 24 hours, real-time workforce analytics dashboard, and predictive demand forecasting',
                    innovationSource: 'Adecco Digital Transformation Report 2024',
                    innovationUrl: 'https://www.adeccogroup.com/future-of-work/latest-research/digital-transformation/'
                },
                'Hays': { 
                    sla: 83.6, 
                    feature: 'Sector-Specific Expertise & Digital Tools', 
                    sourceUrl: 'https://www.haysplc.com/investors/results-and-reports',
                    sourceName: 'Hays Annual Report & Accounts 2024',
                    innovation: 'Hays Talent Solutions with sector-specific AI models for Tech, Finance, Healthcare; automated compliance checking; and predictive salary benchmarking across 33 countries',
                    innovationSource: 'Hays Technology & Innovation Report 2024',
                    innovationUrl: 'https://www.hays.com/what-we-do/hays-talent-solutions'
                },
                'Allegis Group': { 
                    sla: 82.8, 
                    feature: 'Integrated Talent Solutions Suite', 
                    sourceUrl: 'https://www.allegisgroup.com/en/insights',
                    sourceName: 'Allegis Group Industry Report 2024',
                    innovation: 'Allegis Intelligent Talent Platform with unified candidate database, AI-powered workforce planning, automated contract worker onboarding, and integrated MSP/RPO solutions',
                    innovationSource: 'Allegis Group Technology Insights 2024',
                    innovationUrl: 'https://www.allegisgroup.com/en/insights/intelligent-talent'
                },
                'Kelly Services': { 
                    sla: 81.5, 
                    feature: 'Workforce Analytics & Compliance Tools', 
                    sourceUrl: 'https://ir.kellyservices.com/financials/annual-reports',
                    sourceName: 'Kelly Services Annual Report 2024',
                    innovation: 'Kelly Talent Network with predictive workforce analytics, automated compliance monitoring for 50+ countries, AI-driven contingent workforce optimization, and real-time labor market intelligence',
                    innovationSource: 'Kelly Services Workforce Intelligence Report 2024',
                    innovationUrl: 'https://www.kellyservices.com/us/insights/workforce-trends/'
                }
            },
            trends: [
                {
                    category: 'AI & Automation',
                    title: 'AI-Powered Candidate Matching Reduces Time-to-Fill by 42%',
                    description: 'Advanced AI algorithms analyze candidate profiles, job requirements, and historical placement success to automatically match talent with open positions. Leading RPO providers report 40-45% reduction in time-to-fill, 35% improvement in candidate quality scores, and 28% increase in offer acceptance rates.',
                    impact: 'Critical',
                    source: 'Gartner Talent Acquisition Technology Report 2024',
                    sourceUrl: 'https://www.gartner.com/en/human-resources/topics/talent-acquisition',
                    metric: '42% faster time-to-fill, 35% better candidate quality',
                    timeline: 'Current - Q4 2024',
                    keyStats: ['40-45% time-to-fill reduction', '35% quality improvement', '28% higher offer acceptance']
                },
                {
                    category: 'AI & Automation',
                    title: 'Intelligent Chatbots Handle 68% of Candidate Inquiries Automatically',
                    description: 'GPT-4 powered recruitment chatbots provide 24/7 candidate engagement, answering questions about job requirements, application status, interview scheduling, and company culture. Robert Half and Randstad report 65-70% of routine inquiries handled without human intervention.',
                    impact: 'High',
                    source: 'Forrester Future of Work Report 2024',
                    sourceUrl: 'https://www.forrester.com/bold',
                    metric: '68% automated inquiries, 89% satisfaction',
                    timeline: 'November 2024',
                    keyStats: ['65-70% inquiry automation', '45% less admin work', '24/7 candidate support']
                },
                {
                    category: 'AI & Automation',
                    title: 'Predictive Analytics Prevents 76% of Client Attrition Risk',
                    description: 'Machine learning models analyze client engagement patterns, SLA compliance trends, and market signals to predict at-risk client relationships 90-120 days in advance. Randstad achieves 89% client retention vs. 73% industry average.',
                    impact: 'Critical',
                    source: 'McKinsey RPO Market Analysis 2024',
                    sourceUrl: 'https://www.mckinsey.com/industries/technology-media-and-telecommunications/our-insights',
                    metric: '76% attrition prevention, 89% retention rate',
                    timeline: 'October-December 2024',
                    keyStats: ['90-120 day advance warning', '82% prediction accuracy', '$2.3M savings per account']
                },
                {
                    category: 'AI & Automation',
                    title: 'Automated Resume Screening Processes 85% More Candidates',
                    description: 'AI-powered resume parsing and screening tools use natural language processing to extract skills, experience, and qualifications automatically. Korn Ferry reports processing 500+ resumes per hour vs. 60 manual, with 92% accuracy.',
                    impact: 'High',
                    source: 'SHRM HR Technology Trends Report 2024',
                    sourceUrl: 'https://www.shrm.org/topics-tools/research',
                    metric: '85% more candidates screened, 92% accuracy',
                    timeline: 'Q3-Q4 2024',
                    keyStats: ['500+ resumes/hour vs 60 manual', '85% time savings', '92% qualification accuracy']
                },
                {
                    category: 'Cloud & Digital Transformation',
                    title: 'Cloud-Based ATS Platforms Achieve 99.8% Uptime',
                    description: 'Modern cloud-native Applicant Tracking Systems provide 99.8%+ uptime SLAs, enabling distributed recruiting teams to collaborate in real-time across time zones. Cloud ATS implementations show 67% faster deployment and 45% lower TCO.',
                    impact: 'High',
                    source: 'Nucleus Research ATS ROI Report 2024',
                    sourceUrl: 'https://nucleusresearch.com/research-topics/talent-management/',
                    metric: '99.8% uptime, 67% faster deployment',
                    timeline: 'November-December 2024',
                    keyStats: ['99.8% availability', '45% lower TCO', '82% mobile-enabled activities']
                },
                {
                    category: 'Cloud & Digital Transformation',
                    title: 'Mobile Recruiting Apps Capture 72% of Applications',
                    description: 'Mobile-optimized career sites and recruiting apps enable seamless application experiences. Industry data shows 72% of applications now submitted via mobile devices, with 85% of Gen Z candidates preferring mobile process.',
                    impact: 'Critical',
                    source: 'Appcast Mobile Recruiting Benchmark 2024',
                    sourceUrl: 'https://www.appcast.io/recruit-smarter-resources/',
                    metric: '72% mobile applications, 3.2x completion rates',
                    timeline: 'Current - accelerating adoption',
                    keyStats: ['72% mobile submissions', '85% Gen Z preference', '58% abandon non-mobile']
                },
                {
                    category: 'Cloud & Digital Transformation',
                    title: 'Video Interview Platforms Reduce Travel Costs by $4,200 Per Hire',
                    description: 'Cloud video interviewing solutions eliminate geographic barriers and travel requirements for interviews. Organizations report $4,200 average savings per hire from eliminated travel, plus 67% faster interview scheduling.',
                    impact: 'High',
                    source: 'Aberdeen Strategy & Research Video Interviewing ROI',
                    sourceUrl: 'https://www.aberdeen.com/',
                    metric: '$4,200 savings per hire, 67% faster scheduling',
                    timeline: 'Enterprise adoption accelerating Q4 2024',
                    keyStats: ['$4,200 per-hire savings', '3x more interviews', '45% wider talent pool']
                },
                {
                    category: 'Emerging Technologies',
                    title: 'Blockchain Credential Verification Reduces Background Check Time by 73%',
                    description: 'Blockchain-based credential verification systems create immutable records of education, certifications, and work history. ManpowerGroup pilot shows background checks completed in 2-3 days vs. 8-12 days traditionally.',
                    impact: 'Medium',
                    source: 'IEEE Blockchain in HR Study 2024',
                    sourceUrl: 'https://blockchain.ieee.org/',
                    metric: '73% faster verification, 95% accuracy',
                    timeline: 'Pilot phase - 2024/2025 scaling',
                    keyStats: ['2-3 days vs 8-12 days', '$180 savings per check', 'Zero fraud incidents']
                },
                {
                    category: 'Emerging Technologies',
                    title: 'Skills Ontology Platforms Map 50,000+ Skills with AI',
                    description: 'Advanced skills ontology engines create detailed taxonomies of 50,000+ skills and competencies. These platforms enable skills-based hiring, uncover hidden talent matches, and identify transferable skills across roles.',
                    impact: 'High',
                    source: 'Josh Bersin Company Skills Tech Research 2024',
                    sourceUrl: 'https://joshbersin.com/research/',
                    metric: '50,000+ skills mapped, 56% more candidates found',
                    timeline: 'Q4 2024 enterprise adoption',
                    keyStats: ['50,000+ skill taxonomy', '42% fewer unfilled roles', '38% better mobility']
                },
                {
                    category: 'Market Intelligence',
                    title: 'RPO Market Projected to Reach $18.9B by 2028 at 16.4% CAGR',
                    description: 'The global Recruitment Process Outsourcing market is experiencing accelerated growth driven by digital transformation and skills shortages. Market forecasts predict growth from $8.2B in 2023 to $18.9B by 2028.',
                    impact: 'Strategic',
                    source: 'MarketsandMarkets RPO Market Report 2024',
                    sourceUrl: 'https://www.marketsandmarkets.com/Market-Reports/recruitment-process-outsourcing-market.html',
                    metric: '$18.9B by 2028, 16.4% CAGR',
                    timeline: '2023-2028 market expansion',
                    keyStats: ['$8.2B â†’ $18.9B (5 years)', '16.4% annual growth', 'Asia-Pacific 19.2% CAGR']
                },
                {
                    category: 'Market Intelligence',
                    title: 'Skills-Based Hiring Replaces Degrees for 45% of Roles',
                    description: 'Major corporations eliminate college degree requirements for many positions, focusing on demonstrated skills instead. This skills-first approach expands talent pools by 2.4x and improves diversity metrics by 38%.',
                    impact: 'High',
                    source: 'Gartner Future of Work Report 2024',
                    sourceUrl: 'https://www.gartner.com/en/human-resources/trends/future-of-work',
                    metric: '45% roles now skills-based, 2.4x larger pools',
                    timeline: '2024-2026 transformation',
                    keyStats: ['2.4x talent pool expansion', '38% diversity improvement', '50% adoption by 2026']
                },
                {
                    category: 'AI Innovations',
                    title: 'Generative AI Creates Job Descriptions in Under 60 Seconds',
                    description: 'GPT-4 and specialized models generate optimized, inclusive job descriptions tailored to role requirements and company culture. AI-written JDs show 42% more applications from diverse candidates and 35% higher conversion rates.',
                    impact: 'High',
                    source: 'Textio Job Description Analytics Report 2024',
                    sourceUrl: 'https://textio.com/resources/',
                    metric: '60-second JD creation, 42% more diverse applications',
                    timeline: 'September-November 2024',
                    keyStats: ['89% time savings', '35% better conversion', '42% diversity improvement']
                },
                {
                    category: 'AI Innovations',
                    title: 'AI-Powered Sourcing Identifies Passive Candidates with 84% Accuracy',
                    description: 'AI sourcing tools scan 800M+ professional profiles across LinkedIn, GitHub, and niche platforms to identify passive candidates matching specific criteria. Machine learning predicts candidate openness to opportunities with 84% accuracy.',
                    impact: 'Critical',
                    source: 'ERE Media AI Sourcing Effectiveness Study 2024',
                    sourceUrl: 'https://www.ere.net/',
                    metric: '84% contact accuracy, 3.7x response rates',
                    timeline: 'Current - Q4 2024',
                    keyStats: ['800M+ profiles scanned', '84% accuracy', '3.7x better responses']
                },
                {
                    category: 'AI Innovations',
                    title: 'Diversity AI Increases Underrepresented Hires by 54%',
                    description: 'AI-powered diversity tools anonymize resumes, remove biased language, ensure diverse candidate slates, and flag potential bias in interview feedback. Organizations report 54% increase in underrepresented minority hires.',
                    impact: 'Critical',
                    source: 'Ideal.com Diversity Hiring Analytics 2024',
                    sourceUrl: 'https://ideal.com/diversity-hiring/',
                    metric: '54% more underrepresented hires, 67% less bias risk',
                    timeline: 'Current deployment - accelerating',
                    keyStats: ['54% URM increase', '48% women in leadership', '67% bias risk reduction']
                }
            ]
        };

        // Chart.js Configuration with TAGGD Orange Theme
        Chart.defaults.font.family = "'Inter', 'Segoe UI', sans-serif";
        Chart.defaults.plugins.legend.labels.usePointStyle = true;

        // Remove grid lines from all charts globally
        Chart.defaults.scales.x = Chart.defaults.scales.x || {};
        Chart.defaults.scales.x.grid = {
            display: false,
            drawBorder: true
        };
        Chart.defaults.scales.y = Chart.defaults.scales.y || {};
        Chart.defaults.scales.y.grid = {
            display: false,
            drawBorder: true
        };
        
        Chart.defaults.plugins.datalabels = {
            display: true,
            color: function(context) {
                // Use RAG colors for data labels
                const value = context.dataset.data[context.dataIndex];
                if (value === null || value === undefined || value === 0) return 'transparent';
                if (typeof value === 'number' && value < 100) {
                    if (value >= 75) return '#fff';  // White on green
                    if (value >= 50) return '#000';  // Black on amber
                    return '#fff';  // White on red
                }
                return '#fff';
            },
            font: {
                weight: 'bold',
                size: 13
            },
            formatter: (value) => {
                if (value === null || value === undefined || value === 0) return '';
                return typeof value === 'number' ? value.toFixed(1) + '%' : value;
            },
            anchor: 'center',
            align: 'center'
        };
        Chart.register(ChartDataLabels);

        // ===================================================================
        // HELPER FUNCTIONS FOR CROSS-FISCAL-YEAR DATA HANDLING
        // ===================================================================
        
        /**
         * Get correct month column names based on fiscal year
         * FY 24-25: Apr_Met, May_Met, etc.
         * FY 25-26: April_Met, May_Met, etc. (April is fully spelled out)
         */
        function getMonthColumnName(month, fyKey) {
            // Both FY sheets use consistent naming now: Apr, May, June, etc.
            return month; // Use as-is for both fiscal years
        }
        
        /**
         * Safely get month data from a row with fiscal year awareness
         * @param {Object} row - Data row from Excel
         * @param {string} month - Month name (Apr, May, June, etc.)
         * @param {string} fyKey - Fiscal year key (fy24_25 or fy25_26)
         * @param {string} type - Data type (Met or Not_Met)
         * @returns {number} The data value, or 0 if not found
         */
        function getMonthData(row, month, fyKey, type = 'Met') {
            // Try the month name as-is first
            let columnName = `${month}_${type}`;
            if (row[columnName] !== undefined) {
                return parseInt(row[columnName]) || 0;
            }
            
            // Try full month name (e.g., "June" instead of "Jun")
            const fullMonth = getFullMonthName(month);
            columnName = `${fullMonth}_${type}`;
            if (row[columnName] !== undefined) {
                return parseInt(row[columnName]) || 0;
            }
            
            // Try short month name (e.g., "Jun" instead of "June")
            const shortMonth = normalizeMonthName(month);
            columnName = `${shortMonth}_${type}`;
            if (row[columnName] !== undefined) {
                return parseInt(row[columnName]) || 0;
            }
            
            return 0;
        }
        // Get RAG color based on compliance percentage
        function getRAGColor(percentage) {
            if (percentage >= 75) return '#10b981'; // Green
            if (percentage >= 50) return '#f59e0b'; // Amber
            return '#ef4444'; // Red
        }
        
        // Format percentage with RAG color
        
        // Format Year-over-Year change with NEW/NA logic
        function formatYoYChange(fy24Value, fy25Value) {
            // If FY24 has no data (0 or null) and FY25 has data
            if ((!fy24Value || fy24Value === 0) && fy25Value && fy25Value > 0) {
                return '<span class="badge status-new">NEW</span>';
            }
            // If FY24 has data and FY25 has no data (0 or null)
            if (fy24Value && fy24Value > 0 && (!fy25Value || fy25Value === 0)) {
                return '<span class="badge status-na">N/A</span>';
            }
            // If both have data, calculate difference with RAG color
            if (fy24Value && fy25Value) {
                const diff = fy25Value - fy24Value;
                const color = getRAGColor(fy25Value);
                return `<span style="color: ${color}; font-weight: bold;">${diff >= 0 ? '+' : ''}${diff.toFixed(1)}%</span>`;
            }
            // Both have no data
            return '<span class="badge status-na">N/A</span>';
        }


        function formatPercentageWithRAG(percentage) {
            const color = getRAGColor(percentage);
            return `<span style="color: ${color}; font-weight: bold;">${percentage.toFixed(1)}%</span>`;
        }



        // Audio Mode Management
        function toggleAudioMode() {
            audioEnabled = !audioEnabled;
            const btn = document.getElementById('audioBtn');
            const icon = document.getElementById('audioIcon');
            const text = document.getElementById('audioText');
            
            if (audioEnabled) {
                btn.classList.add('audio-active');
                icon.className = 'bi bi-volume-up-fill';
                text.textContent = 'Audio Enabled';
                speak('Audio description mode enabled. All clicks will now be announced.');
            } else {
                btn.classList.remove('audio-active');
                icon.className = 'bi bi-volume-up';
                text.textContent = 'Enable Audio';
                speak('Audio description mode disabled.');
            }
        }

        function speak(text) {
            if (!audioEnabled || !('speechSynthesis' in window)) return;
            
            // Cancel any ongoing speech
            window.speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = audioLanguage; // Use selected language
            utterance.rate = 1.0;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            // Try to find a voice that matches the selected language
            const voices = window.speechSynthesis.getVoices();
            const matchingVoice = voices.find(voice => voice.lang.startsWith(audioLanguage.split('-')[0]));
            if (matchingVoice) {
                utterance.voice = matchingVoice;
            } else if (audioLanguage === 'hi-IN') {
                // If Hindi is selected but no Hindi voice available, show a warning
                console.warn('Hindi voice not available. Please install Hindi language pack in your browser.');
                showToast('âš ï¸ Hindi voice not available. Using default voice.', 'warning');
            }
            
            window.speechSynthesis.speak(utterance);
        }

        function speakAndExecute(description, callback) {
            speak(description);
            if (typeof callback === 'function') {
                callback();
            }
            
            // Auto-close mobile menu after action
            if (window.innerWidth <= 768) {
                closeMobileMenu();
            }
        }

        // Theme Management
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            
            if (newTheme === 'dark') {
                themeIcon.className = 'bi bi-sun';
                themeText.textContent = 'Light Mode';
                speak('Switched to dark mode');
            } else {
                themeIcon.className = 'bi bi-moon-stars';
                themeText.textContent = 'Dark Mode';
                speak('Switched to light mode');
            }
            
            showToast(`Switched to ${newTheme} mode`);
        }

        // Welcome Modal Functions
        function showWelcomeModal() {
            // Check if user has seen the welcome modal before
            const hasSeenWelcome = localStorage.getItem('taggd_welcome_shown');
            if (!hasSeenWelcome) {
                const modal = document.getElementById('welcomeModal');
                if (modal) {
                    modal.style.display = 'block';
                }
            }
        }
        
        function closeWelcomeModal() {
            const modal = document.getElementById('welcomeModal');
            if (modal) {
                modal.style.display = 'none';
                // Remember that user has seen the welcome
                localStorage.setItem('taggd_welcome_shown', 'true');
            }
        }
        
        // Mobile Menu Functions
        function toggleMobileMenu() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('mobileOverlay');
            const toggleBtn = document.getElementById('mobileMenuToggle');
            
            if (sidebar && overlay && toggleBtn) {
                sidebar.classList.toggle('mobile-open');
                overlay.classList.toggle('active');
                toggleBtn.classList.toggle('active');
                
                // Change icon
                const icon = toggleBtn.querySelector('i');
                if (icon) {
                    if (sidebar.classList.contains('mobile-open')) {
                        icon.className = 'bi bi-x-lg';
                    } else {
                        icon.className = 'bi bi-list';
                    }
                }
            }
        }
        
        function closeMobileMenu() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('mobileOverlay');
            const toggleBtn = document.getElementById('mobileMenuToggle');
            
            if (sidebar && overlay && toggleBtn) {
                sidebar.classList.remove('mobile-open');
                overlay.classList.remove('active');
                toggleBtn.classList.remove('active');
                
                // Reset icon
                const icon = toggleBtn.querySelector('i');
                if (icon) {
                    icon.className = 'bi bi-list';
                }
            }
        }
        
        // Close mobile menu when a menu item is clicked
        function handleMenuItemClick(callback) {
            // Execute the callback (navigate to view)
            if (typeof callback === 'function') {
                callback();
            }
            
            // Close mobile menu on smaller screens
            if (window.innerWidth <= 768) {
                closeMobileMenu();
            }
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('welcomeModal');
            if (event.target === modal) {
                closeWelcomeModal();
            }
        }

        // Initialize on page load
        window.onload = function() {
            console.log('ðŸš€ Dashboard initializing...');
            loadInitialData();
            
            // Welcome modal disabled - users can access "About Dashboard" view instead
            // setTimeout(() => showWelcomeModal(), 1000);
            
            // Set up file upload listener
            const fileInput = document.getElementById('fileUpload');
            if (fileInput) {
                console.log('âœ… File input element found');
                fileInput.addEventListener('change', function() {
                    console.log('ðŸ“‚ File selected, calling loadFile()...');
                    loadFile();
                });
            } else {
                console.error('âŒ File input element not found!');
            }

            // Initialize Select2 for multi-select filters
            $('#regionalHeadFilter').select2({
                placeholder: 'Select regional heads...',
                allowClear: true
            }).on('change', function() {
                updateRegionFilter();
                updatePracticeHeadFilter();
                updateAccountFilter();
                applyFilters();
            });

            $('#regionFilter').select2({
                placeholder: 'Select regions...',
                allowClear: true
            }).on('change', function() {
                updatePracticeHeadFilter();
                updateAccountFilter();
                applyFilters();
            });

            $('#practiceFilter').select2({
                placeholder: 'Select practice heads...',
                allowClear: true
            }).on('change', function() {
                updateAccountFilter();
                applyFilters();
            });

            $('#accountFilter').select2({
                placeholder: 'Select accounts...',
                allowClear: true
            }).on('change', function() {
                applyFilters();
            });
        };

        // Load initial data
        function loadInitialData() {
            console.log('ðŸ”„ Attempting to load default data...');
            
            // Try to load sample_data.json
            fetch('sample_data.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Sample data file not found');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('âœ… Default data loaded successfully');
                    
                    // Process the JSON data (same structure as Excel parsing)
                    rawData = {
                        fy24_25: data.fy24_25,
                        fy25_26: data.fy25_26
                    };
                    
                    // Load Not Reported data if available
                    fy2425NotReportedData = data.fy2425NotReported || [];
                    fy2526NotReportedData = data.fy2526NotReported || [];
                    
                    console.log('ðŸ” Not Reported data loaded from sample_data.json:');
                    console.log('  - FY24-25 Not Reported:', fy2425NotReportedData.length, 'rows');
                    console.log('  - FY25-26 Not Reported:', fy2526NotReportedData.length, 'rows');
                    if (fy2425NotReportedData.length > 0) {
                        console.log('  - Sample FY24-25 columns:', Object.keys(fy2425NotReportedData[0]));
                    }
                    if (fy2526NotReportedData.length > 0) {
                        console.log('  - Sample FY25-26 columns:', Object.keys(fy2526NotReportedData[0]));
                    }
                    
                    parsedData = rawData;
                    
                    console.log('Data loaded, populating filters...');
                    populateFilters();
                    
                    console.log('Initializing cascading filters...');
                    updateRegionFilter();
                    updatePracticeHeadFilter();
                    updateAccountFilter();
                    
                    console.log('Applying filters...');
                    applyFilters();
                    
                    showToast('âœ“ Default data loaded successfully! You can upload your own Excel file to override.');
                    speak('Default data loaded. Dashboard is ready. You can upload your own data anytime.');
                })
                .catch(error => {
                    console.log('âš ï¸ Could not load default data:', error.message);
                    console.log('Showing upload prompt...');
                    document.getElementById('dashboardContent').innerHTML = '<div class="loading"><i class="bi bi-upload"></i> Please upload your Excel file to begin analysis.</div>';
                });
        }

        // Show Toast Notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Load file from upload
        
        // Load file from upload
        function loadFile() {
            console.log('ðŸ“‚ loadFile() called');
            const fileInput = document.getElementById('fileUpload');
            console.log('File input element:', fileInput);
            
            if (!fileInput) {
                console.error('âŒ File input element not found!');
                alert('Error: File input element not found!');
                return;
            }
            
            const file = fileInput.files[0];
            console.log('Selected file:', file);
            
            if (!file) {
                console.log('âš ï¸  No file selected');
                alert('Please select a file first!');
                return;
            }
            
            console.log('âœ… Loading file:', file.name, 'Size:', file.size, 'bytes');

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    console.log('File read successfully, parsing...');
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    
                    console.log('Workbook sheets:', workbook.SheetNames);
                    
                    // Check if required sheets exist
                    if (!workbook.SheetNames.includes('FY 24-25 Summary')) {
                        alert('âŒ Error: Sheet "FY 24-25 Summary" not found.\n\nAvailable sheets: ' + workbook.SheetNames.join(', '));
                        return;
                    }
                    
                    if (!workbook.SheetNames.includes('FY 25-26 Summary')) {
                        alert('âŒ Error: Sheet "FY 25-26 Summary" not found.\n\nAvailable sheets: ' + workbook.SheetNames.join(', '));
                        return;
                    }
                    
                    const fy24_25 = XLSX.utils.sheet_to_json(workbook.Sheets['FY 24-25 Summary']);
                    const fy25_26 = XLSX.utils.sheet_to_json(workbook.Sheets['FY 25-26 Summary']);
                    
                    // Process Not Reported sheets
                    fy2425NotReportedData = [];
                    fy2526NotReportedData = [];
                    
                    console.log('ðŸ” Checking for Not Reported sheets...');
                    console.log('Available sheets:', workbook.SheetNames);
                    
                    if (workbook.Sheets['FY24-25 Not Reported']) {
                        fy2425NotReportedData = XLSX.utils.sheet_to_json(workbook.Sheets['FY24-25 Not Reported']);
                        console.log('âœ… FY24-25 Not Reported data loaded:', fy2425NotReportedData.length, 'rows');
                        if (fy2425NotReportedData.length > 0) {
                            console.log('Sample row columns:', Object.keys(fy2425NotReportedData[0]));
                        }
                    } else {
                        console.warn('âš ï¸ Sheet "FY24-25 Not Reported" not found in workbook!');
                    }
                    
                    if (workbook.Sheets['FY25-26 Not Reported']) {
                        fy2526NotReportedData = XLSX.utils.sheet_to_json(workbook.Sheets['FY25-26 Not Reported']);
                        console.log('âœ… FY25-26 Not Reported data loaded:', fy2526NotReportedData.length, 'rows');
                        if (fy2526NotReportedData.length > 0) {
                            console.log('Sample row columns:', Object.keys(fy2526NotReportedData[0]));
                        }
                    } else {
                        console.warn('âš ï¸ Sheet "FY25-26 Not Reported" not found in workbook!');
                    }
                    
                    console.log('FY 24-25 rows:', fy24_25.length);
                    console.log('FY 25-26 rows:', fy25_26.length);
                    
                    if (fy24_25.length === 0) {
                        alert('âŒ Error: "FY 24-25 Summary" sheet is empty!');
                        return;
                    }
                    
                    if (fy25_26.length === 0) {
                        alert('âŒ Error: "FY 25-26 Summary" sheet is empty!');
                        return;
                    }
                    
                    // Check for required columns
                    const requiredColumns = ['Project', 'Region', 'Practice Head'];
                    const firstRow = fy25_26[0];
                    const availableColumns = Object.keys(firstRow);
                    console.log('Available columns:', availableColumns);
                    
                    const missingColumns = requiredColumns.filter(col => !availableColumns.includes(col));
                    if (missingColumns.length > 0) {
                        alert('âŒ Error: Missing required columns: ' + missingColumns.join(', ') + '\n\nAvailable columns: ' + availableColumns.join(', '));
                        return;
                    }
                    
                    rawData = { 
                        fy24_25: fy24_25, 
                        fy25_26: fy25_26 
                    };
                    
                    parsedData = rawData;
                    
                    console.log('Data loaded successfully, populating filters...');
                    populateFilters();
                    
                    console.log('Initializing cascading filters...');
                    updatePracticeHeadFilter();
                    updateAccountFilter();

                    console.log('Applying filters...');
                    applyFilters();
                    
                    // Update last updated timestamp
                    updateLastUpdatedTimestamp();
                    
                    showToast('âœ“ Data loaded successfully!');
                    speak('Data loaded successfully. Dashboard is now ready.');
                    
                    console.log('âœ… File upload complete');
                } catch(error) {
                    console.error('Error loading file:', error);
                    alert('âŒ Error loading file: ' + error.message + '\n\nPlease check the console for details.');
                }
            };
            
            reader.onerror = function(error) {
                console.error('FileReader error:', error);
                alert('âŒ Error reading file. Please try again.');
            };
            
            reader.readAsArrayBuffer(file);
        }


        // Populate filter dropdowns
        
        // Populate filter dropdowns
        
        // Populate filter dropdowns
        function populateFilters() {
            if (!rawData) {
                console.warn('No data to populate filters');
                return;
            }

            console.log('Populating filters...');

            // Get unique values
            const regionalHeads = new Set();
            const regions = new Set();
            const practices = new Set();
            const projects = new Set();
            
            [...rawData.fy24_25, ...rawData.fy25_26].forEach(row => {
                // Note: FY 25-26 has 'Regional Head ' (with space), FY 24-25 has 'Regional Head' (no space)
                const rh = row['Regional Head '] || row['Regional Head'];
                if (rh) regionalHeads.add(rh);
                if (row.Region) regions.add(row.Region);
                if (row['Practice Head']) practices.add(row['Practice Head']);
                if (row.Project) projects.add(row.Project);
            });
            
            console.log('Unique regional heads:', regionalHeads.size);
            console.log('Unique regions:', regions.size);
            console.log('Unique practice heads:', practices.size);
            console.log('Unique projects:', projects.size);

            // Populate Regional Head filter
            const regionalHeadFilter = $('#regionalHeadFilter');
            regionalHeadFilter.empty();
            Array.from(regionalHeads).sort().forEach(rh => {
                regionalHeadFilter.append(new Option(rh, rh));
            });
            
            // Populate Region filter
            const regionFilter = $('#regionFilter');
            regionFilter.empty();
            Array.from(regions).sort().forEach(region => {
                regionFilter.append(new Option(region, region));
            });
            
            // Populate Practice Head filter
            const practiceFilter = $('#practiceFilter');
            practiceFilter.empty();
            Array.from(practices).sort().forEach(practice => {
                practiceFilter.append(new Option(practice, practice));
            });
            
            // Populate Project filter (formerly Account)
            const accountFilter = $('#accountFilter');
            accountFilter.empty();
            Array.from(projects).sort().forEach(project => {
                accountFilter.append(new Option(project, project));
            });
            
            console.log('âœ… Filters populated successfully');
        }



        // Apply filters
        
        // ==================== ADVANCED CASCADING FILTERS ====================
        
        // Update Region filter based on selected Regional Heads
        function updateRegionFilter() {
            const selectedRegionalHeads = $('#regionalHeadFilter').val() || [];
            const regionFilter = $('#regionFilter');
            const currentValues = regionFilter.val() || [];
            
            // Get unique regions for selected regional heads
            let availableRegions = new Set();
            
            if (selectedRegionalHeads.length === 0) {
                // No regional head selected - show all regions
                [...parsedData.fy24_25, ...parsedData.fy25_26].forEach(row => {
                    if (row.Region) {
                        availableRegions.add(row.Region);
                    }
                });
            } else {
                // Filter regions by selected regional heads
                [...parsedData.fy24_25, ...parsedData.fy25_26].forEach(row => {
                    const rh = row['Regional Head '] || row['Regional Head'];
                    if (selectedRegionalHeads.includes(rh) && row.Region) {
                        availableRegions.add(row.Region);
                    }
                });
            }
            
            // Rebuild region dropdown
            regionFilter.empty();
            const sortedRegions = Array.from(availableRegions).sort();
            sortedRegions.forEach(region => {
                regionFilter.append(new Option(region, region));
            });
            
            // Restore previously selected values if they still exist
            const validValues = currentValues.filter(val => sortedRegions.includes(val));
            regionFilter.val(validValues).trigger('change.select2');
            
            console.log(`Updated Region filter: ${sortedRegions.length} options available`);
        }
        
        // Update Practice Head filter based on selected regional heads and regions
        function updatePracticeHeadFilter() {
            const selectedRegionalHeads = $('#regionalHeadFilter').val() || [];
            const selectedRegions = $('#regionFilter').val() || [];
            const practiceFilter = $('#practiceFilter');
            const currentValues = practiceFilter.val() || [];
            
            // Get unique practice heads for selected regional heads and regions
            let availablePractices = new Set();
            
            if (selectedRegionalHeads.length === 0 && selectedRegions.length === 0) {
                // No filters selected - show all practice heads
                [...parsedData.fy24_25, ...parsedData.fy25_26].forEach(row => {
                    if (row['Practice Head']) {
                        availablePractices.add(row['Practice Head']);
                    }
                });
            } else {
                // Filter practice heads by selected regional heads and regions
                [...parsedData.fy24_25, ...parsedData.fy25_26].forEach(row => {
                    let includeRow = true;
                    
                    // Filter by regional head if selected
                    if (selectedRegionalHeads.length > 0) {
                        const rh = row['Regional Head '] || row['Regional Head'];
                        if (!selectedRegionalHeads.includes(rh)) {
                            includeRow = false;
                        }
                    }
                    
                    // Filter by region if selected
                    if (selectedRegions.length > 0 && !selectedRegions.includes(row.Region)) {
                        includeRow = false;
                    }
                    
                    if (includeRow && row['Practice Head']) {
                        availablePractices.add(row['Practice Head']);
                    }
                });
            }
            
            // Rebuild practice head dropdown
            practiceFilter.empty();
            const sortedPractices = Array.from(availablePractices).sort();
            sortedPractices.forEach(practice => {
                practiceFilter.append(new Option(practice, practice));
            });
            
            // Restore previously selected values if they still exist
            const validValues = currentValues.filter(val => sortedPractices.includes(val));
            practiceFilter.val(validValues).trigger('change.select2');
            
            console.log(`Updated Practice Head filter: ${sortedPractices.length} options available`);
        }
        
        // Update Account filter based on selected regional heads, regions and practice heads
        function updateAccountFilter() {
            const selectedRegionalHeads = $('#regionalHeadFilter').val() || [];
            const selectedRegions = $('#regionFilter').val() || [];
            const selectedPractices = $('#practiceFilter').val() || [];
            const accountFilter = $('#accountFilter');
            const currentValues = accountFilter.val() || [];
            
            // Get unique accounts based on filters
            let availableAccounts = new Set();
            
            [...parsedData.fy24_25, ...parsedData.fy25_26].forEach(row => {
                let includeAccount = true;
                
                // Filter by regional head if selected
                if (selectedRegionalHeads.length > 0) {
                    const rh = row['Regional Head '] || row['Regional Head'];
                    if (!selectedRegionalHeads.includes(rh)) {
                        includeAccount = false;
                    }
                }
                
                // Filter by region if selected
                if (selectedRegions.length > 0 && !selectedRegions.includes(row.Region)) {
                    includeAccount = false;
                }
                
                // Filter by practice head if selected
                if (selectedPractices.length > 0 && !selectedPractices.includes(row['Practice Head'])) {
                    includeAccount = false;
                }
                
                if (includeAccount && row.Project) {
                    availableAccounts.add(row.Project);
                }
            });
            
            // Rebuild account dropdown
            accountFilter.empty();
            const sortedAccounts = Array.from(availableAccounts).sort();
            sortedAccounts.forEach(account => {
                accountFilter.append(new Option(account, account));
            });
            
            // Restore previously selected values if they still exist
            const validValues = currentValues.filter(val => sortedAccounts.includes(val));
            accountFilter.val(validValues).trigger('change.select2');
            
            console.log(`Updated Account filter: ${sortedAccounts.length} options available`);
        }
        
        // ==================== END CASCADING FILTERS ====================

        function applyFilters() {
            if (!rawData) {
                console.warn('No data loaded yet');
                return;
            }
            if (!rawData) return;

            // Get filter values
            activeFilters.fy = document.getElementById('fyFilter').value;
            activeFilters.regionalHead = $('#regionalHeadFilter').val() || [];
            activeFilters.region = $('#regionFilter').val() || [];
            activeFilters.practice = $('#practiceFilter').val() || [];
            activeFilters.account = $('#accountFilter').val() || [];
            activeFilters.month = document.getElementById('monthFilter').value;

            // Start with all data
            let fy24Data = [...rawData.fy24_25];
            let fy25Data = [...rawData.fy25_26];

            // Apply filters
            if (activeFilters.regionalHead.length > 0) {
                fy24Data = fy24Data.filter(row => {
                    const rh = row['Regional Head '] || row['Regional Head'];
                    return activeFilters.regionalHead.includes(rh);
                });
                fy25Data = fy25Data.filter(row => {
                    const rh = row['Regional Head '] || row['Regional Head'];
                    return activeFilters.regionalHead.includes(rh);
                });
            }

            if (activeFilters.region.length > 0) {
                fy24Data = fy24Data.filter(row => activeFilters.region.includes(row.Region));
                fy25Data = fy25Data.filter(row => activeFilters.region.includes(row.Region));
            }

            if (activeFilters.practice.length > 0) {
                fy24Data = fy24Data.filter(row => activeFilters.practice.includes(row['Practice Head']));
                fy25Data = fy25Data.filter(row => activeFilters.practice.includes(row['Practice Head']));
            }

            if (activeFilters.account.length > 0) {
                fy24Data = fy24Data.filter(row => activeFilters.account.includes(row.Project));
                fy25Data = fy25Data.filter(row => activeFilters.account.includes(row.Project));
            }

            // Apply FY filter
            if (activeFilters.fy === 'fy24_25') {
                fy25Data = [];
            } else if (activeFilters.fy === 'fy25_26') {
                fy24Data = [];
            }

            filteredData = {
                fy24_25: fy24Data,
                fy25_26: fy25Data
            };

            // Update cascading filters based on current data
            updateCascadingFilters();

            // Refresh current view
            showView(currentView);
            
            showToast('Filters applied');
            speak('Filters applied successfully');
        }

        // Update cascading filters
        function updateCascadingFilters() {
            const currentData = [...filteredData.fy24_25, ...filteredData.fy25_26];
            
            // Update Region options based on other filters
            if (activeFilters.region === 'all') {
                const availableRegions = new Set(currentData.map(row => row.Region).filter(r => r));
                const regionFilter = document.getElementById('regionFilter');
                Array.from(regionFilter.options).forEach(option => {
                    if (option.value !== 'all') {
                        option.disabled = !availableRegions.has(option.value);
                    }
                });
            }

            // Update Practice Head options
            if (activeFilters.practice === 'all') {
                const availablePractices = new Set(currentData.map(row => row['Practice Head']).filter(p => p));
                const practiceFilter = document.getElementById('practiceFilter');
                Array.from(practiceFilter.options).forEach(option => {
                    if (option.value !== 'all') {
                        option.disabled = !availablePractices.has(option.value);
                    }
                });
            }

            // Update Account options
            if (activeFilters.account === 'all') {
                const availableAccounts = new Set(currentData.map(row => row.Project).filter(a => a));
                const accountFilter = document.getElementById('accountFilter');
                Array.from(accountFilter.options).forEach(option => {
                    if (option.value !== 'all') {
                        option.disabled = !availableAccounts.has(option.value);
                    }
                });
            }
        }

        // Clear all filters
        function clearAllFilters() {
            document.getElementById('fyFilter').value = 'all';
            $('#regionalHeadFilter').val(null).trigger('change');
            $('#regionFilter').val(null).trigger('change');
            $('#practiceFilter').val(null).trigger('change');
            $('#accountFilter').val(null).trigger('change');
            document.getElementById('monthFilter').value = 'all';
            
            activeFilters = {
                fy: 'all',
                regionalHead: [],
                region: [],
                practice: [],
                account: [],
                month: 'all'
            };
            
            applyFilters();
        }

        // Show view
        
// ============================================================================
// NOT REPORTED ANALYSIS VIEW
// ============================================================================
function showNotReportedAnalysis() {
    const filteredFY24 = applyFiltersToNotReported(processedNotReported.fy24_25, 'fy24_25');
    const filteredFY25 = applyFiltersToNotReported(processedNotReported.fy25_26, 'fy25_26');
    
    // Calculate summary statistics
    const fy24Total = Object.values(filteredFY24).reduce((sum, item) => sum + item.total, 0);
    const fy25Total = Object.values(filteredFY25).reduce((sum, item) => sum + item.total, 0);
    const changePercent = fy24Total > 0 ? (((fy25Total - fy24Total) / fy24Total) * 100).toFixed(1) : 0;
    const trendIcon = fy25Total < fy24Total ? 'â†“' : fy25Total > fy24Total ? 'â†‘' : 'â†’';
    const trendClass = fy25Total < fy24Total ? 'trend-up' : fy25Total > fy24Total ? 'trend-down' : 'trend-stable';
    
    // Get top offenders
    const fy24Sorted = Object.values(filteredFY24).sort((a, b) => b.total - a.total).slice(0, 10);
    const fy25Sorted = Object.values(filteredFY25).sort((a, b) => b.total - a.total).slice(0, 10);
    
    // Month-wise breakdown for FY24-25
    const fy24MonthTotals = {};
    Object.values(filteredFY24).forEach(item => {
        Object.keys(item.months).forEach(month => {
            fy24MonthTotals[month] = (fy24MonthTotals[month] || 0) + (item.months[month] || 0);
        });
    });
    
    // Month-wise breakdown for FY25-26
    const fy25MonthTotals = {};
    Object.values(filteredFY25).forEach(item => {
        Object.keys(item.months).forEach(month => {
            fy25MonthTotals[month] = (fy25MonthTotals[month] || 0) + (item.months[month] || 0);
        });
    });
    
    return `
        <div class="insights-section animate__animated animate__fadeIn">
            <h3><i class="bi bi-exclamation-triangle-fill"></i> Not Reported SLA Analysis - Key Insights</h3>
            <div class="insight-item">
                <h4>ðŸ“Š Overall Trend</h4>
                <p><strong>FY 2024-25:</strong> ${fy24Total} SLAs Not Reported | <strong>FY 2025-26:</strong> ${fy25Total} SLAs Not Reported</p>
                <p>Change: <span class="${trendClass}">${trendIcon} ${Math.abs(changePercent)}% ${fy25Total < fy24Total ? 'Improvement (Reduction)' : fy25Total > fy24Total ? 'Deterioration (Increase)' : 'No Change'}</span></p>
            </div>
            <div class="insight-item">
                <h4>ðŸŽ¯ Focus Areas</h4>
                <p>Top 3 Accounts with Most Not Reported (FY 25-26): ${fy25Sorted.slice(0, 3).map(item => `<strong>${item.account}</strong> (${item.total})`).join(', ')}</p>
                <p>${fy25Total === 0 ? 'âœ… Excellent! Zero SLAs not reported in current FY.' : fy25Total < fy24Total ? 'âœ… Positive trend - reduction in not reported SLAs.' : 'âš ï¸ Action needed - increase in not reported SLAs.'}</p>
            </div>
        </div>

        <div class="comparison-widget">
            <div class="metric-box fy24 animated-widget">
                <div class="metric-label">FY 2024-25 Not Reported</div>
                <div class="metric-value">${fy24Total}</div>
            </div>
            <div class="metric-box fy25 animated-widget">
                <div class="metric-label">FY 2025-26 Not Reported</div>
                <div class="metric-value">${fy25Total}</div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Month-wise Trend Chart -->
            <div class="card animated-card">
                <h3><i class="bi bi-graph-up"></i> Month-wise Not Reported Trend</h3>
                <div class="chart-container">
                    <canvas id="notReportedTrendChart"></canvas>
                </div>
            </div>

            <!-- FY Comparison Chart -->
            <div class="card animated-card">
                <h3><i class="bi bi-bar-chart"></i> Fiscal Year Comparison</h3>
                <div class="chart-container">
                    <canvas id="notReportedFYChart"></canvas>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Top 10 Offenders FY24-25 -->
            <div class="card animated-card">
                <h3><i class="bi bi-trophy"></i> Top 10 Accounts - FY 2024-25</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Account</th>
                            <th>Region</th>
                            <th>Practice Head</th>
                            <th>Total Not Reported</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${fy24Sorted.map((item, index) => `
                            <tr>
                                <td><strong>${index + 1}</strong></td>
                                <td>${item.account}</td>
                                <td>${item.region}</td>
                                <td>${item.practiceHead}</td>
                                <td><strong>${item.total}</strong></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>

            <!-- Top 10 Offenders FY25-26 -->
            <div class="card animated-card">
                <h3><i class="bi bi-trophy-fill"></i> Top 10 Accounts - FY 2025-26</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Account</th>
                            <th>Region</th>
                            <th>Practice Head</th>
                            <th>Total Not Reported</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${fy25Sorted.map((item, index) => `
                            <tr>
                                <td><strong>${index + 1}</strong></td>
                                <td>${item.account}</td>
                                <td>${item.region}</td>
                                <td>${item.practiceHead}</td>
                                <td><strong>${item.total}</strong></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card animated-card">
            <h3><i class="bi bi-table"></i> Detailed Month-wise Breakdown - All Accounts</h3>
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Account</th>
                            <th>Region</th>
                            <th>Practice Head</th>
                            <th>FY</th>
                            <th>Apr</th>
                            <th>May</th>
                            <th>Jun</th>
                            <th>Jul</th>
                            <th>Aug</th>
                            <th>Sep</th>
                            <th>Oct</th>
                            <th>Nov</th>
                            <th>Dec</th>
                            <th>Jan</th>
                            <th>Feb</th>
                            <th>Mar</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${Object.values(filteredFY24).sort((a, b) => b.total - a.total).map(item => `
                            <tr>
                                <td><strong>${item.account}</strong></td>
                                <td>${item.region}</td>
                                <td>${item.practiceHead}</td>
                                <td>FY 24-25</td>
                                <td>${item.months.Apr || 0}</td>
                                <td>${item.months.May || 0}</td>
                                <td>${item.months.June || 0}</td>
                                <td>${item.months.July || 0}</td>
                                <td>${item.months.Aug || 0}</td>
                                <td>${item.months.Sep || 0}</td>
                                <td>${item.months.Oct || 0}</td>
                                <td>${item.months.Nov || 0}</td>
                                <td>${item.months.Dec || 0}</td>
                                <td>${item.months.Jan || 0}</td>
                                <td>${item.months.Feb || 0}</td>
                                <td>${item.months.March || 0}</td>
                                <td><strong>${item.total}</strong></td>
                            </tr>
                        `).join('')}
                        ${Object.values(filteredFY25).sort((a, b) => b.total - a.total).map(item => `
                            <tr>
                                <td><strong>${item.account}</strong></td>
                                <td>${item.region}</td>
                                <td>${item.practiceHead}</td>
                                <td>FY 25-26</td>
                                <td>${item.months.April || 0}</td>
                                <td>${item.months.May || 0}</td>
                                <td>${item.months.June || 0}</td>
                                <td>${item.months.July || 0}</td>
                                <td>${item.months.Aug || 0}</td>
                                <td>${item.months.Sep || 0}</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td><strong>${item.total}</strong></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
        </div>
    `;
}

// Helper function to apply filters to Not Reported data
function applyFiltersToNotReported(data, fy) {
    const filtered = {};
    const selectedRegionalHeads = getSelectedFilters('regionalHeadFilter');
    const selectedRegions = getSelectedFilters('regionFilter');
    const selectedPractices = getSelectedFilters('practiceFilter');
    const selectedAccounts = getSelectedFilters('accountFilter');
    
    Object.keys(data).forEach(account => {
        const item = data[account];
        let include = true;
        
        if (selectedRegionalHeads.length > 0 && !selectedRegionalHeads.includes(item.regionalHead)) {
            include = false;
        }
        if (selectedRegions.length > 0 && !selectedRegions.includes(item.region)) {
            include = false;
        }
        if (selectedPractices.length > 0 && !selectedPractices.includes(item.practiceHead)) {
            include = false;
        }
        if (selectedAccounts.length > 0 && !selectedAccounts.includes(item.account)) {
            include = false;
        }
        
        if (include) {
            filtered[account] = item;
        }
    });
    
    return filtered;
}

// Render Not Reported Charts
function renderNotReportedCharts() {
    const filteredFY24 = applyFiltersToNotReported(processedNotReported.fy24_25, 'fy24_25');
    const filteredFY25 = applyFiltersToNotReported(processedNotReported.fy25_26, 'fy25_26');
    
    // Month-wise trend
    const months = ['Apr', 'May', 'June', 'July', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'March'];
    const fy24Data = months.map(month => {
        return Object.values(filteredFY24).reduce((sum, item) => sum + (item.months[month] || 0), 0);
    });
    
    const fy25Months = ['April', 'May', 'June', 'July', 'Aug', 'Sep'];
    const fy25Data = fy25Months.map(month => {
        return Object.values(filteredFY25).reduce((sum, item) => sum + (item.months[month] || 0), 0);
    });
    
    // Trend Chart
    const trendCtx = document.getElementById('notReportedTrendChart');
    if (trendCtx) {
        new Chart(trendCtx, {
            type: 'line',
            data: {
                labels: months,
                datasets: [{
                    label: 'FY 2024-25',
                    data: fy24Data,
                    borderColor: '#3a1c71',
                    backgroundColor: 'rgba(58, 28, 113, 0.1)',
                    tension: 0.4,
                    fill: true
                }, {
                    label: 'FY 2025-26',
                    data: [...fy25Data, ...Array(6).fill(null)],
                    borderColor: '#FF6B35',
                    backgroundColor: 'rgba(255, 107, 53, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'top' },
                    title: { display: false }
                },
                scales: {
                    y: { 
                        beginAtZero: true,
                        title: { display: true, text: 'Not Reported Count' }
                    }
                }
            }
        });
    }
    
    // FY Comparison
    const fy24Total = Object.values(filteredFY24).reduce((sum, item) => sum + item.total, 0);
    const fy25Total = Object.values(filteredFY25).reduce((sum, item) => sum + item.total, 0);
    
    const fyCtx = document.getElementById('notReportedFYChart');
    if (fyCtx) {
        new Chart(fyCtx, {
            type: 'bar',
            data: {
                labels: ['FY 2024-25', 'FY 2025-26'],
                datasets: [{
                    label: 'Total Not Reported',
                    data: [fy24Total, fy25Total],
                    backgroundColor: ['#3a1c71', '#FF6B35']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                        formatter: (value) => value,
                        font: { weight: 'bold', size: 14 }
                    }
                },
                scales: {
                    y: { 
                        beginAtZero: true,
                        title: { display: true, text: 'Not Reported Count' }
                    }
                }
            }
        });
    }
}


function showView(view) {
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const navItem = document.getElementById('nav-' + view);
            if (navItem) {
                navItem.classList.add('active');
            }
            
            currentView = view;
            
            if (!rawData || !filteredData) {
                document.getElementById('dashboardContent').innerHTML = '<div class="loading"><i class="bi bi-upload"></i> Please upload your Excel file to begin analysis.</div>';
                return;
            }
            
            // Clear existing charts
            Object.values(charts).forEach(chart => {
                if (chart && typeof chart.destroy === 'function') {
                    chart.destroy();
                }
            });
            charts = {};
            
            switch(view) {
                case 'overview':
                    renderOverview();
                    break;
                case 'executive':
                    renderExecutiveView();
                    break;
                case 'monthly':
                    renderMonthlyView();
                    break;
                case 'quarterly':
                    renderQuarterlyView();
                    break;
                case 'yearly':
                    renderYearlyView();
                    break;
                case 'account':
                    renderAccountView();
                    break;
                case 'region':
                    renderRegionView();
                    break;
                case 'practice':
                    renderPracticeView();
                    break;
                case 'benchmarking':
                    renderBenchmarkingView();
                    break;
                case 'notreported':
            renderNotReportedView();
            break;
        
        case 'about':
                    renderAboutView();
                    break;
        
        case 'manual':
                    renderUserManual();
                    break;
            }
        }

        // Calculate overall metrics
        function calculateOverallMetrics(data, fyKey) {
            // Dynamically extract available months from the data
            // NOTE: extractMonthsFromData already handles the month filter
            const months = extractMonthsFromData(
                fyKey === 'fy24_25' ? data : null,
                fyKey === 'fy25_26' ? data : null
            );
            
            let totalMet = 0;
            let totalNotMet = 0;
            
            // extractMonthsFromData already filtered by activeFilters.month
            // So we use all returned months directly
            const monthsToUse = months;
            
            data.forEach(row => {
                monthsToUse.forEach(month => {
                    const met = getMonthData(row, month, fyKey, 'Met');
                    const notMet = getMonthData(row, month, fyKey, 'Not_Met');
                    totalMet += met;
                    totalNotMet += notMet;
                });
            });
            
            const total = totalMet + totalNotMet;
            const compliance = total > 0 ? ((totalMet / total) * 100).toFixed(1) : 0;
            
            return {
                totalMet,
                totalNotMet,
                total,
                compliance: parseFloat(compliance)
            };
        }

        // Get RAG status
        function getRAGStatus(compliance) {
            if (compliance >= 85) return 'green';
            if (compliance >= 70) return 'amber';
            return 'red';
        }

        // Generate insights
        function generateInsights(fy24Metrics, fy25Metrics) {
            const insights = [];
            
            // Compliance comparison
            const complianceDiff = fy25Metrics.compliance - fy24Metrics.compliance;
            if (complianceDiff > 5) {
                insights.push({
                    title: 'ðŸ“ˆ Significant Performance Improvement',
                    description: `FY 25-26 shows a remarkable ${complianceDiff.toFixed(1)}% increase in SLA compliance. The current strategies are highly effective and should be maintained.`
                });
            } else if (complianceDiff > 0) {
                insights.push({
                    title: 'âœ… Steady Performance Growth',
                    description: `FY 25-26 demonstrates a positive ${complianceDiff.toFixed(1)}% improvement in compliance rate, indicating stable progress.`
                });
            } else if (complianceDiff < -5) {
                insights.push({
                    title: 'âš ï¸ Critical Performance Decline',
                    description: `FY 25-26 shows a concerning ${Math.abs(complianceDiff).toFixed(1)}% decrease in compliance. Immediate corrective action required.`
                });
            } else if (complianceDiff < 0) {
                insights.push({
                    title: 'ðŸ“‰ Slight Performance Decline',
                    description: `FY 25-26 compliance has dropped by ${Math.abs(complianceDiff).toFixed(1)}%. Monitor closely and consider process improvements.`
                });
            }
            
            // RAG status insight
            const fy25Status = getRAGStatus(fy25Metrics.compliance);
            if (fy25Status === 'green') {
                insights.push({
                    title: 'ðŸŸ¢ Excellent Compliance Level',
                    description: `Current compliance at ${fy25Metrics.compliance}% exceeds the 85% threshold, placing TAGGD in the excellent performance category.`
                });
            } else if (fy25Status === 'amber') {
                insights.push({
                    title: 'ðŸŸ¡ Needs Attention',
                    description: `Current compliance at ${fy25Metrics.compliance}% falls in the amber zone (70-84%). Focus on improving processes to reach green status.`
                });
            } else {
                insights.push({
                    title: 'ðŸ”´ Critical Status',
                    description: `Current compliance at ${fy25Metrics.compliance}% is below 70%. Urgent intervention required to improve SLA delivery.`
                });
            }
            
            // Volume insight
            if (fy25Metrics.total > 0) {
                insights.push({
                    title: 'ðŸ“Š Volume Analysis',
                    description: `Processing ${fy25Metrics.total} total SLAs with ${fy25Metrics.totalMet} met and ${fy25Metrics.totalNotMet} not met. Success rate: ${fy25Metrics.compliance}%.`
                });
            }
            
            return insights;
        }

        // Render Overview
        
        // Helper function to dynamically extract months from data
        function extractMonthsFromData(data2425, data2526) {
            // If month filter is active and not 'all', return only that month
            if (activeFilters.month && activeFilters.month !== 'all' && activeFilters.month !== 'All') {
                const selectedMonth = activeFilters.month;
                // Normalize the selected month (e.g., "June" -> "Jun")
                const normalizedMonth = normalizeMonthName(selectedMonth);
                return [normalizedMonth];
            }
            
            const monthsSet = new Set();
            
            // Extract from FY 24-25 data
            if (data2425 && data2425.length > 0) {
                Object.keys(data2425[0]).forEach(key => {
                    // Match patterns like "Apr_Met", "May_Not_Met", "June_Met", etc.
                    const match = key.match(/^([A-Za-z]+)_(Met|Not_Met)$/);
                    if (match) {
                        const month = match[1];
                        // Normalize to short form
                        const shortMonth = normalizeMonthName(month);
                        monthsSet.add(shortMonth);
                    }
                });
            }
            
            // Extract from FY 25-26 data
            if (data2526 && data2526.length > 0) {
                Object.keys(data2526[0]).forEach(key => {
                    const match = key.match(/^([A-Za-z]+)_(Met|Not_Met)$/);
                    if (match) {
                        const month = match[1];
                        const shortMonth = normalizeMonthName(month);
                        monthsSet.add(shortMonth);
                    }
                });
            }
            
            // Convert to array and sort by fiscal year order
            const allMonths = Array.from(monthsSet);
            const fiscalOrder = ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar'];
            
            return fiscalOrder.filter(m => allMonths.includes(m));
        }
        
        // Helper to normalize month names (April->Apr, June->Jun, July->Jul, etc.)
        function normalizeMonthName(month) {
            const mapping = {
                'April': 'Apr',
                'June': 'Jun',
                'July': 'Jul',
                'March': 'Mar',
                'September': 'Sep',
                'October': 'Oct',
                'November': 'Nov',
                'December': 'Dec',
                'January': 'Jan',
                'February': 'Feb',
                'August': 'Aug',
                'May': 'May',
                'Apr': 'Apr',
                'Jun': 'Jun',
                'Jul': 'Jul',
                'Mar': 'Mar',
                'Sep': 'Sep',
                'Oct': 'Oct',
                'Nov': 'Nov',
                'Dec': 'Dec',
                'Jan': 'Jan',
                'Feb': 'Feb',
                'Aug': 'Aug'
            };
            return mapping[month] || month;
        }
        
        // Helper to get full month name from short form
        function getFullMonthName(shortMonth) {
            const mapping = {
                'Apr': 'April',
                'May': 'May',
                'Jun': 'June',
                'Jul': 'July',
                'Aug': 'August',
                'Sep': 'September',
                'Oct': 'October',
                'Nov': 'November',
                'Dec': 'December',
                'Jan': 'January',
                'Feb': 'February',
                'Mar': 'March'
            };
            return mapping[shortMonth] || shortMonth;
        }


        function renderOverview() {
            const fy24Metrics = calculateOverallMetrics(filteredData.fy24_25, 'fy24_25');
            const fy25Metrics = calculateOverallMetrics(filteredData.fy25_26, 'fy25_26');
            const insights = generateInsights(fy24Metrics, fy25Metrics);
            
            // Generate insights HTML
            let insightsHTML = '<div class="insights-section"><h3><i class="bi bi-lightbulb-fill"></i> Key Insights & Highlights</h3>';
            insights.forEach(insight => {
                insightsHTML += `
                    <div class="insight-item">
                        <h4>${insight.title}</h4>
                        <p>${insight.description}</p>
                    </div>`;
            });
            insightsHTML += '</div>';
            
            const html = `
                ${insightsHTML}

                <div class="dashboard-grid">
                        <div class="stat-widget blue drilldown-enabled" style="animation-delay: 0.1s;" onclick="drilldownFY2425()" title="Click to see monthly breakdown">
                        <div class="stat-widget-label">FY 24-25 Compliance</div>
                        <div class="stat-widget-value">${fy24Metrics.compliance}%</div>
                        <p style="margin-top: 10px; opacity: 0.9;">Total SLAs: ${fy24Metrics.total}</p>
                    </div>

                    <div class="stat-widget orange drilldown-enabled" style="animation-delay: 0.2s;" onclick="drilldownFY2526()" title="Click to see account breakdown">
                        <div class="stat-widget-label">FY 25-26 Compliance</div>
                        <div class="stat-widget-value">${fy25Metrics.compliance}%</div>
                        <p style="margin-top: 10px; opacity: 0.9;">Total SLAs: ${fy25Metrics.total}</p>
                    </div>

                    <div class="stat-widget green drilldown-enabled" style="animation-delay: 0.3s;" onclick="drilldownSLAsMet()" title="Click to see regional distribution">
                        <div class="stat-widget-label">SLAs Met (FY 25-26)</div>
                        <div class="stat-widget-value">${fy25Metrics.totalMet}</div>
                        <p style="margin-top: 10px; opacity: 0.9;">Target Achievement</p>
                    </div>

                    <div class="stat-widget purple drilldown-enabled" style="animation-delay: 0.4s;" onclick="drilldownYoY()" title="Click to see quarterly analysis">
                        <div class="stat-widget-label">Year-over-Year Change</div>
                        <div class="stat-widget-value">${(fy25Metrics.compliance - fy24Metrics.compliance).toFixed(1)}%</div>
                        <p style="margin-top: 10px; opacity: 0.9;">${fy25Metrics.compliance >= fy24Metrics.compliance ? 'Improvement' : 'Decline'}</p>
                    </div>
                </div>

                <div class="card">
                    <h3><i class="bi bi-graph-up"></i> Year-over-Year Comparison</h3>
                    <div class="chart-container">
                        <canvas id="overviewChart"></canvas>
                    </div>
                </div>
            `;
            
            document.getElementById('dashboardContent').innerHTML = html;
            
            // Speak insights
            if (audioEnabled && insights.length > 0) {
                speak(`Overview dashboard loaded. ${insights[0].description}`);
            }
            
            // Render chart with TAGGD Orange colors
            const ctx = document.getElementById('overviewChart').getContext('2d');
            charts.overview = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['FY 24-25', 'FY 25-26'],
                    datasets: [
                        {
                            label: 'SLA Met',
                            data: [fy24Metrics.totalMet, fy25Metrics.totalMet],
                            backgroundColor: 'rgba(255, 179, 128, 0.8)',
                            borderColor: 'rgb(16, 185, 129)',
                            borderWidth: 2
                        },
                        {
                            label: 'SLA Not Met',
                            data: [fy24Metrics.totalNotMet, fy25Metrics.totalNotMet],
                            backgroundColor: 'rgba(211, 211, 211, 0.8)',
                            borderColor: 'rgb(239, 68, 68)',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        datalabels: {
                            color: '#fff',
                            font: {
                                weight: 'bold',
                                size: 14
                            },
                            formatter: (value) => value
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Render Executive View - NEW ENHANCED VIEW
        function renderExecutiveView() {
            const fy24Metrics = calculateOverallMetrics(filteredData.fy24_25, 'fy24_25');
            const fy25Metrics = calculateOverallMetrics(filteredData.fy25_26, 'fy25_26');
            
            // Calculate account-level performance for rankings
            const accountPerformance = [];
            const uniqueAccounts = new Set([
                ...filteredData.fy24_25.map(row => row.Project),
                ...filteredData.fy25_26.map(row => row.Project)
            ]);
            
            const fy24months = extractMonthsFromData(filteredData.fy24_25, null);
            const fy25months = extractMonthsFromData(null, filteredData.fy25_26);
            
            uniqueAccounts.forEach(accountName => {
                // FY 24-25 data
                const fy24Rows = filteredData.fy24_25.filter(row => row.Project === accountName);
                let fy24Met = 0, fy24NotMet = 0;
                fy24months.forEach(month => {
                    fy24Rows.forEach(row => {
                        fy24Met += getMonthData(row, month, 'fy24_25', 'Met');
                        fy24NotMet += getMonthData(row, month, 'fy24_25', 'Not_Met');
                    });
                });
                const fy24Total = fy24Met + fy24NotMet;
                const fy24Compliance = fy24Total > 0 ? parseFloat(((fy24Met / fy24Total) * 100).toFixed(1)) : 0;

                // FY 25-26 data
                const fy25Rows = filteredData.fy25_26.filter(row => row.Project === accountName);
                let fy25Met = 0, fy25NotMet = 0;
                fy25months.forEach(month => {
                    fy25Rows.forEach(row => {
                        fy25Met += getMonthData(row, month, 'fy25_26', 'Met');
                        fy25NotMet += getMonthData(row, month, 'fy25_26', 'Not_Met');
                    });
                });
                const fy25Total = fy25Met + fy25NotMet;
                const fy25Compliance = fy25Total > 0 ? parseFloat(((fy25Met / fy25Total) * 100).toFixed(1)) : 0;

                const sampleRow = fy24Rows.length > 0 ? fy24Rows[0] : (fy25Rows.length > 0 ? fy25Rows[0] : null);
                
                if (sampleRow && fy25Total > 0) {
                    accountPerformance.push({
                        account: accountName,
                        region: sampleRow.Region,
                        practice: sampleRow['Practice Head'],
                        fy24Compliance,
                        fy25Compliance,
                        improvement: fy25Compliance - fy24Compliance
                    });
                }
            });
            
            // Top 5 best performers (FY 25-26)
            const top5Best = [...accountPerformance].sort((a, b) => b.fy25Compliance - a.fy25Compliance).slice(0, 5);
            
            // Top 5 worst performers (FY 25-26)
            const top5Worst = [...accountPerformance].sort((a, b) => a.fy25Compliance - b.fy25Compliance).slice(0, 5);
            
            // Top 5 most improved (YoY change)
            const top5Improved = [...accountPerformance].filter(a => a.fy24Compliance > 0).sort((a, b) => b.improvement - a.improvement).slice(0, 5);
            
            // Top 5 most declined (YoY change)
            const top5Declined = [...accountPerformance].filter(a => a.fy24Compliance > 0).sort((a, b) => a.improvement - b.improvement).slice(0, 5);
            
            // Regional rankings
            const regionData = {};
            filteredData.fy25_26.forEach(row => {
                const region = row.Region;
                if (!regionData[region]) {
                    regionData[region] = { met: 0, notMet: 0 };
                }
                fy25months.forEach(month => {
                    regionData[region].met += getMonthData(row, month, 'fy25_26', 'Met');
                    regionData[region].notMet += getMonthData(row, month, 'fy25_26', 'Not_Met');
                });
            });
            
            const regionRankings = Object.entries(regionData).map(([region, data]) => {
                const total = data.met + data.notMet;
                const compliance = total > 0 ? parseFloat(((data.met / total) * 100).toFixed(1)) : 0;
                return { region, compliance };
            }).sort((a, b) => b.compliance - a.compliance);
            
            const top3Regions = regionRankings.slice(0, 3);
            const bottom3Regions = regionRankings.slice(-3).reverse();
            
            // Practice Head rankings
            const practiceData = {};
            filteredData.fy25_26.forEach(row => {
                const practice = row['Practice Head'];
                if (!practiceData[practice]) {
                    practiceData[practice] = { met: 0, notMet: 0 };
                }
                fy25months.forEach(month => {
                    practiceData[practice].met += getMonthData(row, month, 'fy25_26', 'Met');
                    practiceData[practice].notMet += getMonthData(row, month, 'fy25_26', 'Not_Met');
                });
            });
            
            const practiceRankings = Object.entries(practiceData).map(([practice, data]) => {
                const total = data.met + data.notMet;
                const compliance = total > 0 ? parseFloat(((data.met / total) * 100).toFixed(1)) : 0;
                return { practice, compliance, total };
            }).sort((a, b) => b.compliance - a.compliance);
            
            const top3Practices = practiceRankings.slice(0, 3);
            // Filter out practice heads with no FY 25-26 reporting data (total = 0) from bottom ranking
            const practiceRankingsWithData = practiceRankings.filter(p => p.total > 0);
            const bottom3Practices = practiceRankingsWithData.slice(-3).reverse();
            
            const yoyChange = fy25Metrics.compliance - fy24Metrics.compliance;
            
            const html = `
                <div class="insights-section animate__animated animate__fadeIn">
                    <h3><i class="bi bi-star-fill"></i> Executive View - Strategic Performance Overview</h3>
                    <div class="insight-item">
                        <h4>ðŸ“Š Year-over-Year SLA Performance Comparison</h4>
                        <p><strong>FY 2024-25:</strong> ${fy24Metrics.compliance}% | <strong>FY 2025-26:</strong> ${fy25Metrics.compliance}% | 
                        <span class="${yoyChange >= 0 ? 'improvement-badge' : 'decline-badge'}">${yoyChange >= 0 ? 'â†‘' : 'â†“'} ${Math.abs(yoyChange).toFixed(1)}% ${yoyChange >= 0 ? 'Improvement' : 'Decline'}</span></p>
                    </div>
                </div>

                <div class="comparison-widget">
                    <div class="metric-box fy24 animated-widget">
                        <div class="metric-label">FY 2024-25 SLA%</div>
                        <div class="metric-value" style="color: #3a1c71;">${fy24Metrics.compliance}%</div>
                    </div>
                    <div class="metric-box fy25 animated-widget">
                        <div class="metric-label">FY 2025-26 SLA%</div>
                        <div class="metric-value" style="color: var(--primary-color);">${fy25Metrics.compliance}%</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- Top 5 Best Performing Accounts -->
                    <div class="card animated-card">
                        <h3><i class="bi bi-trophy-fill" style="color: gold;"></i> Top 5 Best Performing Accounts (FY 25-26)</h3>
                        <div class="chart-container">
                            <canvas id="top5BestChart"></canvas>
                        </div>
                        <table style="margin-top: 15px;">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Account</th>
                                    <th>Region</th>
                                    <th>SLA %</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${top5Best.map((acc, idx) => `
                                    <tr>
                                        <td><strong>${idx + 1}</strong></td>
                                        <td>${acc.account}</td>
                                        <td>${acc.region}</td>
                                        <td>${formatPercentageWithRAG(acc.fy25Compliance)}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>

                    <!-- Top 5 Worst Performing Accounts -->
                    <div class="card animated-card" style="animation-delay: 0.1s;">
                        <h3><i class="bi bi-exclamation-circle-fill" style="color: #ef4444;"></i> Top 5 Accounts Needing Attention (FY 25-26)</h3>
                        <div class="chart-container">
                            <canvas id="top5WorstChart"></canvas>
                        </div>
                        <table style="margin-top: 15px;">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Account</th>
                                    <th>Region</th>
                                    <th>SLA %</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${top5Worst.map((acc, idx) => `
                                    <tr>
                                        <td><strong>${idx + 1}</strong></td>
                                        <td>${acc.account}</td>
                                        <td>${acc.region}</td>
                                        <td>${formatPercentageWithRAG(acc.fy25Compliance)}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- Top 5 Most Improved Accounts -->
                    <div class="card animated-card" style="animation-delay: 0.2s;">
                        <h3><i class="bi bi-graph-up-arrow" style="color: #10b981;"></i> Top 5 Most Improved Accounts (YoY)</h3>
                        <div class="chart-container">
                            <canvas id="top5ImprovedChart"></canvas>
                        </div>
                        <table style="margin-top: 15px;">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Account</th>
                                    <th>FY 24-25</th>
                                    <th>FY 25-26</th>
                                    <th>Change</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${top5Improved.map((acc, idx) => `
                                    <tr>
                                        <td><strong>${idx + 1}</strong></td>
                                        <td>${acc.account}</td>
                                        <td>${acc.fy24Compliance.toFixed(1)}%</td>
                                        <td>${acc.fy25Compliance.toFixed(1)}%</td>
                                        <td class="improvement-badge">â†‘ +${acc.improvement.toFixed(1)}%</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>

                    <!-- Top 5 Most Declined Accounts -->
                    <div class="card animated-card" style="animation-delay: 0.3s;">
                        <h3><i class="bi bi-graph-down-arrow" style="color: #ef4444;"></i> Top 5 Most Declined Accounts (YoY)</h3>
                        <div class="chart-container">
                            <canvas id="top5DeclinedChart"></canvas>
                        </div>
                        <table style="margin-top: 15px;">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Account</th>
                                    <th>FY 24-25</th>
                                    <th>FY 25-26</th>
                                    <th>Change</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${top5Declined.map((acc, idx) => `
                                    <tr>
                                        <td><strong>${idx + 1}</strong></td>
                                        <td>${acc.account}</td>
                                        <td>${acc.fy24Compliance.toFixed(1)}%</td>
                                        <td>${acc.fy25Compliance.toFixed(1)}%</td>
                                        <td class="decline-badge">â†“ ${acc.improvement.toFixed(1)}%</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- Top 3 & Bottom 3 Regions -->
                    <div class="card animated-card" style="animation-delay: 0.4s;">
                        <h3><i class="bi bi-geo-alt-fill"></i> Regional Rankings (FY 25-26)</h3>
                        <div style="margin-top: 20px;">
                            <h4 style="color: #10b981; margin-bottom: 10px;">ðŸ† Top 3 Regions</h4>
                            <table style="margin-bottom: 30px;">
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Region</th>
                                        <th>SLA %</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${top3Regions.map((reg, idx) => `
                                        <tr>
                                            <td><strong>${idx + 1}</strong></td>
                                            <td>${reg.region}</td>
                                            <td>${formatPercentageWithRAG(reg.compliance)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                            
                            <h4 style="color: #ef4444; margin-bottom: 10px;">âš ï¸ Bottom 3 Regions</h4>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Region</th>
                                        <th>SLA %</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${bottom3Regions.map((reg, idx) => `
                                        <tr>
                                            <td><strong>${regionRankings.length - 2 + idx}</strong></td>
                                            <td>${reg.region}</td>
                                            <td>${formatPercentageWithRAG(reg.compliance)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Top 3 & Bottom 3 Practice Heads -->
                    <div class="card animated-card" style="animation-delay: 0.5s;">
                        <h3><i class="bi bi-people-fill"></i> Practice Head Rankings (FY 25-26)</h3>
                        <div style="margin-top: 20px;">
                            <h4 style="color: #10b981; margin-bottom: 10px;">ðŸ† Top 3 Practice Heads</h4>
                            <table style="margin-bottom: 30px;">
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Practice Head</th>
                                        <th>SLA %</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${top3Practices.map((prac, idx) => `
                                        <tr>
                                            <td><strong>${idx + 1}</strong></td>
                                            <td>${prac.practice}</td>
                                            <td>${formatPercentageWithRAG(prac.compliance)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                            
                            <h4 style="color: #ef4444; margin-bottom: 10px;">âš ï¸ Bottom 3 Practice Heads</h4>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Practice Head</th>
                                        <th>SLA %</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${bottom3Practices.map((prac, idx) => `
                                        <tr>
                                            <td><strong>${practiceRankings.length - 2 + idx}</strong></td>
                                            <td>${prac.practice}</td>
                                            <td>${formatPercentageWithRAG(prac.compliance)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('dashboardContent').innerHTML = html;
            
            if (audioEnabled) {
                speak(`Executive view loaded. Overall compliance ${fy25Metrics.compliance} percent. ${yoyChange >= 0 ? 'Improvement' : 'Decline'} of ${Math.abs(yoyChange).toFixed(1)} percent year over year.`);
            }
            
            // Render charts
            // Top 5 Best Performing
            const ctx1 = document.getElementById('top5BestChart');
            if (ctx1) {
                charts.top5Best = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: top5Best.map(a => a.account),
                        datasets: [{
                            label: 'SLA %',
                            data: top5Best.map(a => a.fy25Compliance),
                            backgroundColor: top5Best.map(a => getRAGColor(a.fy25Compliance)),
                            borderWidth: 0,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            datalabels: {
                                anchor: 'end',
                                align: 'right',
                                color: '#fff',
                                font: { weight: 'bold', size: 12 },
                                formatter: (value) => value.toFixed(1) + '%'
                            }
                        },
                        scales: {
                            x: { 
                                beginAtZero: true,
                                max: 100,
                                ticks: { callback: (value) => value + '%' }
                            }
                        }
                    }
                });
            }
            
            // Top 5 Worst Performing
            const ctx2 = document.getElementById('top5WorstChart');
            if (ctx2) {
                charts.top5Worst = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: top5Worst.map(a => a.account),
                        datasets: [{
                            label: 'SLA %',
                            data: top5Worst.map(a => a.fy25Compliance),
                            backgroundColor: top5Worst.map(a => getRAGColor(a.fy25Compliance)),
                            borderWidth: 0,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            datalabels: {
                                anchor: 'end',
                                align: 'right',
                                color: '#fff',
                                font: { weight: 'bold', size: 12 },
                                formatter: (value) => value.toFixed(1) + '%'
                            }
                        },
                        scales: {
                            x: { 
                                beginAtZero: true,
                                max: 100,
                                ticks: { callback: (value) => value + '%' }
                            }
                        }
                    }
                });
            }
            
            // Top 5 Most Improved
            const ctx3 = document.getElementById('top5ImprovedChart');
            if (ctx3) {
                charts.top5Improved = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: top5Improved.map(a => a.account),
                        datasets: [{
                            label: 'Improvement',
                            data: top5Improved.map(a => a.improvement),
                            backgroundColor: '#10b981',
                            borderWidth: 0,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            datalabels: {
                                anchor: 'end',
                                align: 'right',
                                color: '#000',
                                backgroundColor: 'rgba(255, 255, 255, 0.9)',
                                borderRadius: 4,
                                padding: { top: 4, bottom: 4, left: 6, right: 6 },
                                font: { weight: 'bold', size: 12 },
                                formatter: (value) => '+' + value.toFixed(1) + '%',
                                display: true
                            }
                        },
                        scales: {
                            x: { beginAtZero: true }
                        }
                    }
                });
            }
            
            // Top 5 Most Declined
            const ctx4 = document.getElementById('top5DeclinedChart');
            if (ctx4) {
                charts.top5Declined = new Chart(ctx4, {
                    type: 'bar',
                    data: {
                        labels: top5Declined.map(a => a.account),
                        datasets: [{
                            label: 'Decline',
                            data: top5Declined.map(a => Math.abs(a.improvement)),
                            backgroundColor: '#ef4444',
                            borderWidth: 0,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            datalabels: {
                                anchor: 'end',
                                align: 'right',
                                color: '#000',
                                backgroundColor: 'rgba(255, 255, 255, 0.9)',
                                borderRadius: 4,
                                padding: { top: 4, bottom: 4, left: 6, right: 6 },
                                font: { weight: 'bold', size: 12 },
                                formatter: (value) => '-' + value.toFixed(1) + '%',
                                display: true
                            }
                        },
                        scales: {
                            x: { beginAtZero: true }
                        }
                    }
                });
            }
        }

        // Render Monthly View WITH FY COMPARISON
        function renderMonthlyView() {
            // Dynamically extract months for both fiscal years
            const fy24months = extractMonthsFromData(filteredData.fy24_25, null);
            const fy25months = extractMonthsFromData(null, filteredData.fy25_26);
            const allMonths = ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar'];
            
            // Calculate FY 24-25 data for all its available months
            const fy24Data = allMonths.map(month => {
                const met = filteredData.fy24_25.reduce((sum, row) => {
                    return sum + getMonthData(row, month, 'fy24_25', 'Met');
                }, 0);
                const notMet = filteredData.fy24_25.reduce((sum, row) => {
                    return sum + getMonthData(row, month, 'fy24_25', 'Not_Met');
                }, 0);
                const total = met + notMet;
                return total > 0 ? parseFloat(((met / total) * 100).toFixed(1)) : 0;
            });

            // Calculate FY 25-26 data for all its available months
            const fy25Data = allMonths.map(month => {
                const met = filteredData.fy25_26.reduce((sum, row) => {
                    return sum + getMonthData(row, month, 'fy25_26', 'Met');
                }, 0);
                const notMet = filteredData.fy25_26.reduce((sum, row) => {
                    return sum + getMonthData(row, month, 'fy25_26', 'Not_Met');
                }, 0);
                const total = met + notMet;
                return total > 0 ? parseFloat(((met / total) * 100).toFixed(1)) : 0;
            });

            // Calculate comparison metrics for available FY25 months
            const fy25NonZeroData = fy25Data.filter(v => v > 0);
            const compareMonthCount = Math.min(fy24Data.length, fy25NonZeroData.length);
            const avgFY24 = compareMonthCount > 0 ? (fy24Data.slice(0, compareMonthCount).reduce((a, b) => a + b, 0) / compareMonthCount).toFixed(1) : 0;
            const avgFY25 = fy25NonZeroData.length > 0 ? (fy25NonZeroData.reduce((a, b) => a + b, 0) / fy25NonZeroData.length).toFixed(1) : 0;
            const improvement = (avgFY25 - avgFY24).toFixed(1);

            const insightsHTML = `
                <div class="insights-section">
                    <h3><i class="bi bi-lightbulb-fill"></i> Monthly Performance Comparison</h3>
                    <div class="insight-item">
                        <h4>ðŸ“Š FY 24-25 vs FY 25-26 (First ${fy25months.length} Months)</h4>
                        <p>FY 24-25 Average: ${avgFY24}% | FY 25-26 Average: ${avgFY25}% | Change: ${improvement > 0 ? '+' : ''}${improvement}%</p>
                    </div>
                    <div class="insight-item">
                        <h4>${improvement > 0 ? 'ðŸ“ˆ Performance Improvement' : 'ðŸ“‰ Performance Decline'}</h4>
                        <p>${improvement > 0 ? `FY 25-26 shows ${improvement}% improvement in monthly average compliance.` : `FY 25-26 shows ${Math.abs(improvement)}% decline in monthly average compliance. Focus on recovery strategies.`}</p>
                    </div>
                </div>`;

            // Create comparison widgets
            const comparisonWidget = `
                <div class="comparison-widget">
                    <div class="metric-box fy24">
                        <div class="metric-label">FY 24-25 Avg (${compareMonthCount} months)</div>
                        <div class="metric-value" style="color: #3a1c71;">${avgFY24}%</div>
                    </div>
                    <div class="metric-box fy25">
                        <div class="metric-label">FY 25-26 Avg (${fy25months.length} months)</div>
                        <div class="metric-value" style="color: var(--primary-color);">${avgFY25}%</div>
                    </div>
                </div>`;

            // Build comparison table
            let tableHTML = `
                <table style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th>Month</th>
                            <th>FY 24-25 (%)</th>
                            <th>FY 25-26 (%)</th>
                            <th>Difference</th>
                        </tr>
                    </thead>
                    <tbody>`;
            
            fy25months.forEach((month, idx) => {
                const diff = fy25Data[idx] - fy24Data[idx];
                const diffColor = diff >= 0 ? 'var(--success-color)' : 'var(--danger-color)';
                tableHTML += `
                    <tr>
                        <td><strong>${month}</strong></td>
                        <td style="color: #3a1c71;">${fy24Data[idx].toFixed(1)}%</td>
                        <td style="color: var(--primary-color);">${fy25Data[idx].toFixed(1)}%</td>
                        <td style="color: ${diffColor}; font-weight: bold;">${diff >= 0 ? '+' : ''}${diff.toFixed(1)}%</td>
                    </tr>`;
            });
            tableHTML += '</tbody></table>';
            
            const html = `
                ${insightsHTML}
                ${comparisonWidget}
                <div class="card">
                    <h3><i class="bi bi-calendar-month"></i> Monthly Performance Trend Lines (FY Comparison)</h3>
                    <div class="chart-container">
                        <canvas id="monthlyChart"></canvas>
                    </div>
                    ${tableHTML}
                </div>
            `;
            
            document.getElementById('dashboardContent').innerHTML = html;
            
            if (audioEnabled) {
                speak(`Monthly performance comparison loaded. FY 24-25 average is ${avgFY24} percent. FY 25-26 average is ${avgFY25} percent.`);
            }
            
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            
            // Only show months with actual data - use the maximum months available from either FY
            const maxMonthsToShow = Math.max(fy24months.length, fy25months.length);
            const labelsToShow = allMonths.slice(0, maxMonthsToShow);
            const fy24DataToShow = fy24Data.slice(0, maxMonthsToShow);
            // For FY25, replace 0 values beyond available data with null to avoid showing 0%
            const fy25DataToShow = fy25Data.slice(0, maxMonthsToShow).map((val, idx) => 
                idx < fy25months.length ? val : null
            );
            
            charts.monthly = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labelsToShow,
                    datasets: [
                        {
                            label: 'FY 24-25',
                            data: fy24DataToShow,
                            borderColor: '#3a1c71',
                            backgroundColor: 'rgba(99, 102, 241, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        },
                        {
                            label: `FY 25-26 (${fy25months.join('-')})`,
                            data: fy25DataToShow,
                            borderColor: '#FF6B35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            borderDash: [0, 0, 0, 0, 0, 0, 5, 5],
                            spanGaps: false  // Don't connect null values
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            display: true,
                            align: 'top',
                            font: { size: 10, weight: 'bold' },
                            formatter: (value) => value ? value.toFixed(1) + '%' : ''
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,  // Show 0, 20, 40, 60, 80, 100
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    }
                }
            });
        }

        // Render Quarterly View WITH FY COMPARISON
        function renderQuarterlyView() {
            const quarters = [
                { name: 'Q1 (Apr-Jun)', months: ['Apr', 'May', 'June'] },
                { name: 'Q2 (Jul-Sep)', months: ['July', 'Aug', 'Sep'] },
                { name: 'Q3 (Oct-Dec)', months: ['Oct', 'Nov', 'Dec'] },
                { name: 'Q4 (Jan-Mar)', months: ['Jan', 'Feb', 'March'] }
            ];
            
            // Calculate FY 24-25 quarterly data
            const fy24QuarterlyData = quarters.map(q => {
                let totalMet = 0, totalNotMet = 0;
                q.months.forEach(month => {
                    filteredData.fy24_25.forEach(row => {
                        totalMet += getMonthData(row, month, 'fy24_25', 'Met');
                        totalNotMet += getMonthData(row, month, 'fy24_25', 'Not_Met');
                    });
                });
                const total = totalMet + totalNotMet;
                return total > 0 ? parseFloat(((totalMet / total) * 100).toFixed(1)) : 0;
            });

            // Calculate FY 25-26 quarterly data (calculate all quarters, show only those with data)
            const fy25QuarterlyData = quarters.map((q, idx) => {
                let totalMet = 0, totalNotMet = 0;
                q.months.forEach(month => {
                    filteredData.fy25_26.forEach(row => {
                        totalMet += getMonthData(row, month, 'fy25_26', 'Met');
                        totalNotMet += getMonthData(row, month, 'fy25_26', 'Not_Met');
                    });
                });
                const total = totalMet + totalNotMet;
                return total > 0 ? parseFloat(((totalMet / total) * 100).toFixed(1)) : null;
            });

            // Calculate improvements and count available quarters
            const q1Diff = fy25QuarterlyData[0] !== null ? (fy25QuarterlyData[0] - fy24QuarterlyData[0]) : null;
            const q2Diff = fy25QuarterlyData[1] !== null ? (fy25QuarterlyData[1] - fy24QuarterlyData[1]) : null;
            const q3Diff = fy25QuarterlyData[2] !== null ? (fy25QuarterlyData[2] - fy24QuarterlyData[2]) : null;
            
            const availableQuarters = fy25QuarterlyData.filter(q => q !== null).length;

            let insightsHTML = `
                <div class="insights-section">
                    <h3><i class="bi bi-lightbulb-fill"></i> Quarterly Performance Comparison</h3>`;
            
            if (q1Diff !== null) {
                insightsHTML += `
                    <div class="insight-item">
                        <h4>ðŸ“Š Q1 Comparison</h4>
                        <p>FY 24-25: ${fy24QuarterlyData[0]}% | FY 25-26: ${fy25QuarterlyData[0]}% | Change: ${q1Diff >= 0 ? '+' : ''}${q1Diff.toFixed(1)}%</p>
                    </div>`;
            }
            
            if (q2Diff !== null) {
                insightsHTML += `
                    <div class="insight-item">
                        <h4>ðŸ“Š Q2 Comparison</h4>
                        <p>FY 24-25: ${fy24QuarterlyData[1]}% | FY 25-26: ${fy25QuarterlyData[1]}% | Change: ${q2Diff >= 0 ? '+' : ''}${q2Diff.toFixed(1)}%</p>
                    </div>`;
            }
            
            if (q3Diff !== null) {
                insightsHTML += `
                    <div class="insight-item">
                        <h4>ðŸ“Š Q3 Comparison (Includes October 2025)</h4>
                        <p>FY 24-25: ${fy24QuarterlyData[2]}% | FY 25-26: ${fy25QuarterlyData[2]}% | Change: ${q3Diff >= 0 ? '+' : ''}${q3Diff.toFixed(1)}%</p>
                    </div>`;
            }
            
            insightsHTML += `</div>`;

            // Comparison widgets - dynamically show available quarters
            let comparisonWidget = `<div class="comparison-widget">`;
            
            for (let i = 0; i < availableQuarters && i < 4; i++) {
                if (fy25QuarterlyData[i] !== null) {
                    comparisonWidget += `
                        <div class="metric-box fy24">
                            <div class="metric-label">FY 24-25 Q${i+1}</div>
                            <div class="metric-value" style="color: #3a1c71;">${fy24QuarterlyData[i]}%</div>
                        </div>
                        <div class="metric-box fy25">
                            <div class="metric-label">FY 25-26 Q${i+1}</div>
                            <div class="metric-value" style="color: var(--primary-color);">${fy25QuarterlyData[i]}%</div>
                        </div>`;
                }
            }
            
            comparisonWidget += `</div>`;

            // Build comparison table
            let tableHTML = `
                <table style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th>Quarter</th>
                            <th>FY 24-25 (%)</th>
                            <th>FY 25-26 (%)</th>
                            <th>Difference</th>
                        </tr>
                    </thead>
                    <tbody>`;
            
            quarters.forEach((q, idx) => {
                const fy25Val = fy25QuarterlyData[idx];
                const diff = fy25Val !== null ? fy25Val - fy24QuarterlyData[idx] : null;
                const diffColor = diff !== null && diff >= 0 ? 'var(--success-color)' : 'var(--danger-color)';
                tableHTML += `
                    <tr>
                        <td><strong>${q.name}</strong></td>
                        <td style="color: #3a1c71;">${fy24QuarterlyData[idx].toFixed(1)}%</td>
                        <td style="color: var(--primary-color);">${fy25Val !== null ? fy25Val.toFixed(1) + '%' : 'N/A'}</td>
                        <td style="color: ${diff !== null ? diffColor : 'var(--text-secondary)'}; font-weight: bold;">${diff !== null ? (diff >= 0 ? '+' : '') + diff.toFixed(1) + '%' : 'N/A'}</td>
                    </tr>`;
            });
            tableHTML += '</tbody></table>';
            
            const html = `
                ${insightsHTML}
                ${comparisonWidget}
                <div class="card">
                    <h3><i class="bi bi-calendar3"></i> Quarterly Performance Comparison Chart</h3>
                    <div class="chart-container">
                        <canvas id="quarterlyChart"></canvas>
                    </div>
                    ${tableHTML}
                </div>
            `;
            
            document.getElementById('dashboardContent').innerHTML = html;
            
            if (audioEnabled) {
                speak(`Quarterly performance comparison loaded. Q1 FY 24-25 is ${fy24QuarterlyData[0]} percent. Q1 FY 25-26 is ${fy25QuarterlyData[0]} percent.`);
            }
            
            const ctx = document.getElementById('quarterlyChart').getContext('2d');
            charts.quarterly = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: quarters.map(q => q.name),
                    datasets: [
                        {
                            label: 'FY 24-25',
                            data: fy24QuarterlyData,
                            backgroundColor: '#D3D3D3',
                            borderWidth: 2,
                            borderColor: '#fff'
                        },
                        {
                            label: `FY 25-26 (${availableQuarters === 1 ? 'Q1' : availableQuarters === 2 ? 'Q1-Q2' : availableQuarters === 3 ? 'Q1-Q3' : 'Q1-Q4'})`,
                            data: fy25QuarterlyData,
                            backgroundColor: '#FFB84D',
                            borderWidth: 2,
                            borderColor: '#fff'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            color: '#fff',
                            font: { weight: 'bold', size: 14 },
                            formatter: (value) => value ? value.toFixed(1) + '%' : ''
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,  // Show 0, 20, 40, 60, 80, 100
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    }
                }
            });
        }

        // Render Yearly View
        function renderYearlyView() {
            const fy24Metrics = calculateOverallMetrics(filteredData.fy24_25, 'fy24_25');
            const fy25Metrics = calculateOverallMetrics(filteredData.fy25_26, 'fy25_26');
            
            const yoyChange = fy25Metrics.compliance - fy24Metrics.compliance;
            const yoyPercent = fy24Metrics.compliance > 0 ? ((yoyChange / fy24Metrics.compliance) * 100).toFixed(1) : 0;

            const insightsHTML = `
                <div class="insights-section">
                    <h3><i class="bi bi-lightbulb-fill"></i> Year-over-Year Insights</h3>
                    <div class="insight-item">
                        <h4>${yoyChange >= 0 ? 'ðŸ“ˆ Year-over-Year Improvement' : 'ðŸ“‰ Year-over-Year Decline'}</h4>
                        <p>FY 25-26 shows a ${Math.abs(yoyChange).toFixed(1)}% ${yoyChange >= 0 ? 'improvement' : 'decline'} compared to FY 24-25. This represents a ${Math.abs(yoyPercent)}% ${yoyChange >= 0 ? 'increase' : 'decrease'} in compliance rate.</p>
                    </div>
                    <div class="insight-item">
                        <h4>ðŸŽ¯ Performance Trajectory</h4>
                        <p>${yoyChange >= 0 ? 'Positive momentum indicates effective strategies. Continue current initiatives and consider scaling successful practices.' : 'Declining trend requires immediate attention. Conduct root cause analysis and implement corrective measures.'}</p>
                    </div>
                </div>`;
            
            const html = `
                ${insightsHTML}
                <div class="dashboard-grid">
                    <div class="card">
                        <h3><i class="bi bi-calendar-year"></i> Year-over-Year Comparison</h3>
                        <div class="chart-container">
                            <canvas id="yearlyChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <h3><i class="bi bi-bar-chart"></i> Comparison Metrics</h3>
                        <div style="margin-top: 20px;">
                            <div style="display: flex; justify-content: space-between; padding: 15px; background: var(--light-color); border-radius: 8px; margin-bottom: 10px;">
                                <span>FY 24-25 Compliance:</span>
                                <strong style="color: #3a1c71;">${fy24Metrics.compliance}%</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 15px; background: var(--light-color); border-radius: 8px; margin-bottom: 10px;">
                                <span>FY 25-26 Compliance:</span>
                                <strong style="color: var(--primary-color);">${fy25Metrics.compliance}%</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 15px; background: ${yoyChange >= 0 ? 'rgba(16, 185, 129, 0.1)' : 'rgba(239, 68, 68, 0.1)'}; border-radius: 8px;">
                                <span>Year-over-Year Change:</span>
                                <strong class="${yoyChange >= 0 ? 'improvement-badge' : 'decline-badge'}">${yoyChange >= 0 ? '+' : ''}${yoyChange.toFixed(1)}%</strong>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('dashboardContent').innerHTML = html;
            
            if (audioEnabled) {
                speak(`Year over year analysis loaded. ${yoyChange >= 0 ? 'Improvement' : 'Decline'} of ${Math.abs(yoyChange).toFixed(1)} percent observed.`);
            }
            
            const ctx = document.getElementById('yearlyChart').getContext('2d');
            charts.yearly = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['FY 24-25', 'FY 25-26'],
                    datasets: [{
                        data: [fy24Metrics.compliance, fy25Metrics.compliance],
                        backgroundColor: ['#9CA3AF', '#FF6B35'],
                        borderWidth: 3,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            color: '#fff',
                            font: { weight: 'bold', size: 18 },
                            formatter: (value) => value + '%'
                        }
                    }
                }
            });
        }

        // Render Account View WITH FY COMPARISON
        function renderAccountView() {
            const fy24months = extractMonthsFromData(filteredData.fy24_25, null);
            const fy25months = extractMonthsFromData(null, filteredData.fy25_26);
            
            let accountsData = [];

            // Get unique accounts
            const uniqueAccounts = new Set([
                ...filteredData.fy24_25.map(row => row.Project),
                ...filteredData.fy25_26.map(row => row.Project)
            ]);

            uniqueAccounts.forEach(accountName => {
                // FY 24-25 data
                const fy24Rows = filteredData.fy24_25.filter(row => row.Project === accountName);
                let fy24Met = 0, fy24NotMet = 0;
                fy24months.forEach(month => {
                    fy24Rows.forEach(row => {
                        fy24Met += getMonthData(row, month, 'fy24_25', 'Met');
                        fy24NotMet += getMonthData(row, month, 'fy24_25', 'Not_Met');
                    });
                });
                const fy24Total = fy24Met + fy24NotMet;
                const fy24Compliance = fy24Total > 0 ? parseFloat(((fy24Met / fy24Total) * 100).toFixed(1)) : 0;

                // FY 25-26 data
                const fy25Rows = filteredData.fy25_26.filter(row => row.Project === accountName);
                let fy25Met = 0, fy25NotMet = 0;
                fy25months.forEach(month => {
                    fy25Rows.forEach(row => {
                        fy25Met += getMonthData(row, month, 'fy25_26', 'Met');
                        fy25NotMet += getMonthData(row, month, 'fy25_26', 'Not_Met');
                    });
                });
                const fy25Total = fy25Met + fy25NotMet;
                const fy25Compliance = fy25Total > 0 ? parseFloat(((fy25Met / fy25Total) * 100).toFixed(1)) : 0;

                // Get region and practice from either FY
                const sampleRow = fy24Rows.length > 0 ? fy24Rows[0] : (fy25Rows.length > 0 ? fy25Rows[0] : null);
                
                if (sampleRow) {
                    accountsData.push({
                        account: accountName,
                        region: sampleRow.Region,
                        practice: sampleRow['Practice Head'],
                        fy24Compliance,
                        fy25Compliance,
                        improvement: fy25Compliance - fy24Compliance
                    });
                }
            });

            // Sort by FY 25-26 compliance
            accountsData.sort((a, b) => b.fy25Compliance - a.fy25Compliance);

            // Generate insights
            const improvingAccounts = accountsData.filter(a => a.improvement > 2).length;
            const decliningAccounts = accountsData.filter(a => a.improvement < -2).length;

            const insightsHTML = `
                <div class="insights-section">
                    <h3><i class="bi bi-lightbulb-fill"></i> Project Performance Comparison</h3>
                    <div class="insight-item">
                        <h4>ðŸ“ˆ Improving Accounts</h4>
                        <p>${improvingAccounts} account(s) show >2% improvement in FY 25-26 compared to FY 24-25.</p>
                    </div>
                    ${decliningAccounts > 0 ? `
                    <div class="insight-item">
                        <h4>âš ï¸ Accounts Needing Attention</h4>
                        <p>${decliningAccounts} account(s) show >2% decline. Priority intervention recommended.</p>
                    </div>` : ''}
                </div>`;

            let tableHTML = `
                ${insightsHTML}
                <div class="card">
                    <h3><i class="bi bi-building"></i> Account-Wise FY Comparison</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Account</th>
                                <th>Region</th>
                                <th>Practice Head</th>
                                <th>FY 24-25 (%)</th>
                                <th>FY 25-26 (%)</th>
                                <th>Change</th>
                            </tr>
                        </thead>
                        <tbody>`;
            
            accountsData.forEach(data => {
                const improvementColor = data.improvement >= 0 ? 'var(--success-color)' : 'var(--danger-color)';
                const improvementIcon = data.improvement >= 0 ? 'â†‘' : 'â†“';
                
                const fy24Display = data.fy24Compliance > 0 ? formatPercentageWithRAG(data.fy24Compliance) : 'N/A';
                const fy25Display = data.fy25Compliance > 0 ? formatPercentageWithRAG(data.fy25Compliance) : 'N/A';
                const changeDisplay = formatYoYChange(data.fy24Compliance, data.fy25Compliance);
                
                tableHTML += `<tr>
                    <td><strong>${data.account}</strong></td>
                    <td>${data.region}</td>
                    <td>${data.practice}</td>
                    <td>${fy24Display}</td>
                    <td>${fy25Display}</td>
                    <td>${changeDisplay}</td>
                </tr>`;
            });
            
            tableHTML += '</tbody></table></div>';
            
            // Add trend chart
            let chartHTML = `
                <div class="card">
                    <h3><i class="bi bi-graph-up-arrow"></i> Project Performance Trend</h3>
                    <div class="chart-container">
                        <canvas id="accountTrendChart"></canvas>
                    </div>
                </div>`;
            
            document.getElementById('dashboardContent').innerHTML = insightsHTML + chartHTML + tableHTML.replace(insightsHTML, '');

            if (audioEnabled) {
                speak(`Account comparison loaded. ${accountsData.length} accounts analyzed. ${improvingAccounts} accounts improving, ${decliningAccounts} accounts declining.`);
            }

            // Render trend chart
            const accountNames = accountsData.slice(0, 10).map(d => d.account);
            const fy24Values = accountsData.slice(0, 10).map(d => d.fy24Compliance);
            const fy25Values = accountsData.slice(0, 10).map(d => d.fy25Compliance);

            const ctx = document.getElementById('accountTrendChart').getContext('2d');
            charts.accountTrend = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: accountNames,
                    datasets: [
                        {
                            label: 'FY 24-25',
                            data: fy24Values,
                            borderColor: '#3a1c71',
                            backgroundColor: 'rgba(99, 102, 241, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            pointBackgroundColor: '#3a1c71'
                        },
                        {
                            label: 'FY 25-26',
                            data: fy25Values,
                            borderColor: '#FF6B35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            pointBackgroundColor: '#FF6B35'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            display: false
                        },
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });
        }

        // Render Region View WITH FY COMPARISON
        function renderRegionView() {
            const fy24months = extractMonthsFromData(filteredData.fy24_25, null);
            const fy25months = extractMonthsFromData(null, filteredData.fy25_26);
            
            const regionData = {};
            
            // FY 24-25 data
            filteredData.fy24_25.forEach(row => {
                const region = row.Region;
                if (!regionData[region]) {
                    regionData[region] = { fy24Met: 0, fy24NotMet: 0, fy25Met: 0, fy25NotMet: 0 };
                }
                
                fy24months.forEach(month => {
                    regionData[region].fy24Met += getMonthData(row, month, 'fy24_25', 'Met');
                    regionData[region].fy24NotMet += getMonthData(row, month, 'fy24_25', 'Not_Met');
                });
            });

            // FY 25-26 data
            filteredData.fy25_26.forEach(row => {
                const region = row.Region;
                if (!regionData[region]) {
                    regionData[region] = { fy24Met: 0, fy24NotMet: 0, fy25Met: 0, fy25NotMet: 0 };
                }
                
                fy25months.forEach(month => {
                    regionData[region].fy25Met += getMonthData(row, month, 'fy25_26', 'Met');
                    regionData[region].fy25NotMet += getMonthData(row, month, 'fy25_26', 'Not_Met');
                });
            });

            const regionArray = Object.entries(regionData).map(([region, data]) => {
                const fy24Total = data.fy24Met + data.fy24NotMet;
                const fy25Total = data.fy25Met + data.fy25NotMet;
                const fy24Compliance = fy24Total > 0 ? parseFloat(((data.fy24Met / fy24Total) * 100).toFixed(1)) : 0;
                const fy25Compliance = fy25Total > 0 ? parseFloat(((data.fy25Met / fy25Total) * 100).toFixed(1)) : 0;
                return { 
                    region, 
                    fy24Compliance, 
                    fy25Compliance,
                    improvement: fy25Compliance - fy24Compliance
                };
            }).sort((a, b) => b.fy25Compliance - a.fy25Compliance);

            const insightsHTML = `
                <div class="insights-section">
                    <h3><i class="bi bi-lightbulb-fill"></i> Regional Performance Comparison</h3>
                    <div class="insight-item">
                        <h4>ðŸ† Top Region FY 25-26</h4>
                        <p>${regionArray[0].region} leads with ${regionArray[0].fy25Compliance}% (vs ${regionArray[0].fy24Compliance}% in FY 24-25).</p>
                    </div>
                </div>`;
            
            let html = `
                ${insightsHTML}
                <div class="card">
                    <h3><i class="bi bi-geo-alt-fill"></i> Regional FY Comparison</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Region</th>
                                <th>FY 24-25 (%)</th>
                                <th>FY 25-26 (%)</th>
                                <th>Change</th>
                            </tr>
                        </thead>
                        <tbody>`;
            
            regionArray.forEach(({ region, fy24Compliance, fy25Compliance, improvement }) => {
                const improvementColor = improvement >= 0 ? 'var(--success-color)' : 'var(--danger-color)';
                
                html += `<tr>
                    <td><strong>${region}</strong></td>
                    <td style="color: #3a1c71; font-weight: bold;">${fy24Compliance}%</td>
                    <td style="color: var(--primary-color); font-weight: bold;">${fy25Compliance}%</td>
                    <td style="color: ${improvementColor}; font-weight: bold;">${improvement >= 0 ? '+' : ''}${improvement.toFixed(1)}%</td>
                </tr>`;
            });
            
            html += `</tbody></table></div>
                <div class="card">
                    <h3><i class="bi bi-pie-chart"></i> Regional Comparison Chart</h3>
                    <div class="chart-container">
                        <canvas id="regionChart"></canvas>
                    </div>
                </div>`;
            
            document.getElementById('dashboardContent').innerHTML = html;

            if (audioEnabled) {
                speak(`Regional comparison loaded. ${regionArray.length} regions analyzed. Top region is ${regionArray[0].region}.`);
            }

            const ctx = document.getElementById('regionChart').getContext('2d');
            charts.region = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: regionArray.map(r => r.region),
                    datasets: [
                        {
                            label: 'FY 24-25',
                            data: regionArray.map(r => r.fy24Compliance),
                            backgroundColor: '#D3D3D3',
                            borderWidth: 2,
                            borderColor: '#fff'
                        },
                        {
                            label: 'FY 25-26',
                            data: regionArray.map(r => r.fy25Compliance),
                            backgroundColor: '#FFB84D',
                            borderWidth: 2,
                            borderColor: '#fff'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            color: '#fff',
                            font: { weight: 'bold', size: 12 },
                            formatter: (value) => value.toFixed(1) + '%'
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,  // Show 0, 20, 40, 60, 80, 100
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    }
                }
            });
        }

        // Render Practice View WITH FY COMPARISON
        // Calculate performance badges for practice heads
        function calculatePracticeBadges(practiceArray, practiceData, fy25months) {
            const badges = {};
            
            practiceArray.forEach(practice => {
                badges[practice.practice] = [];
                const data = practiceData[practice.practice];
                
                // Get monthly performance for FY 25-26
                const monthlyPerformance = [];
                fy25months.forEach(month => {
                    const monthMet = filteredData.fy25_26
                        .filter(row => row['Practice Head'] === practice.practice)
                        .reduce((sum, row) => sum + getMonthData(row, month, 'fy25_26', 'Met'), 0);
                    const monthNotMet = filteredData.fy25_26
                        .filter(row => row['Practice Head'] === practice.practice)
                        .reduce((sum, row) => sum + getMonthData(row, month, 'fy25_26', 'Not_Met'), 0);
                    const monthTotal = monthMet + monthNotMet;
                    if (monthTotal > 0) {
                        monthlyPerformance.push((monthMet / monthTotal) * 100);
                    }
                });
                
                // Badge 1: ðŸ”¥ 100% SLA Achiever (Perfect month)
                if (monthlyPerformance.some(perf => perf === 100)) {
                    badges[practice.practice].push({
                        emoji: 'ðŸ”¥',
                        label: '100% SLA Achiever',
                        class: 'badge-fire',
                        description: 'Achieved perfect 100% SLA in at least one month'
                    });
                }
                
                // Badge 2: â­ Consistent High Performer (â‰¥90% for all months)
                if (monthlyPerformance.length >= 3 && monthlyPerformance.every(perf => perf >= 90)) {
                    badges[practice.practice].push({
                        emoji: 'â­',
                        label: 'Consistent High Performer',
                        class: 'badge-star',
                        description: 'Maintained â‰¥90% SLA across all months'
                    });
                }
                
                // Badge 3: ðŸš€ Most Improved (top improvement)
                const improvement = practice.fy25Compliance - practice.fy24Compliance;
                if (improvement >= 15 && practice.fy24Compliance > 0) {
                    badges[practice.practice].push({
                        emoji: 'ðŸš€',
                        label: 'Most Improved',
                        class: 'badge-rocket',
                        description: `Improved by ${improvement.toFixed(1)}% year-over-year`
                    });
                }
                
                // Badge 4: ðŸŽ¯ Zero Breach Month (â‰¥95% for any month)
                if (monthlyPerformance.some(perf => perf >= 95)) {
                    badges[practice.practice].push({
                        emoji: 'ðŸŽ¯',
                        label: 'Zero Breach Month',
                        class: 'badge-target',
                        description: 'Achieved â‰¥95% SLA in at least one month'
                    });
                }
                
                // Badge 5: ðŸ† Top Performer (Rank 1-3)
                const rank = practiceArray.findIndex(p => p.practice === practice.practice) + 1;
                if (rank <= 3 && practice.fy25Compliance >= 80) {
                    badges[practice.practice].push({
                        emoji: 'ðŸ†',
                        label: `Top ${rank} Performer`,
                        class: 'badge-trophy',
                        description: `Ranked #${rank} overall in FY 25-26`
                    });
                }
                
                // Badge 6: ðŸ“ˆ Rising Star (improvement â‰¥10%)
                if (improvement >= 10 && improvement < 15 && practice.fy24Compliance > 0) {
                    badges[practice.practice].push({
                        emoji: 'ðŸ“ˆ',
                        label: 'Rising Star',
                        class: 'badge-chart',
                        description: `Improved by ${improvement.toFixed(1)}% year-over-year`
                    });
                }
                
                // Badge 7: ðŸ›¡ï¸ Stability Champion (variance <5% across months)
                if (monthlyPerformance.length >= 3) {
                    const avg = monthlyPerformance.reduce((a, b) => a + b, 0) / monthlyPerformance.length;
                    const variance = monthlyPerformance.reduce((sum, perf) => sum + Math.pow(perf - avg, 2), 0) / monthlyPerformance.length;
                    const stdDev = Math.sqrt(variance);
                    if (stdDev < 5 && avg >= 75) {
                        badges[practice.practice].push({
                            emoji: 'ðŸ›¡ï¸',
                            label: 'Stability Champion',
                            class: 'badge-shield',
                            description: 'Maintained consistent performance across all months'
                        });
                    }
                }
                
                // Badge 8: âš¡ Quick Recovery (improved >10% in last 2 months)
                if (monthlyPerformance.length >= 3) {
                    const recentTrend = monthlyPerformance.slice(-2).reduce((a, b) => a + b, 0) / 2;
                    const earlierTrend = monthlyPerformance.slice(0, -2).reduce((a, b) => a + b, 0) / (monthlyPerformance.length - 2);
                    if (recentTrend - earlierTrend >= 10) {
                        badges[practice.practice].push({
                            emoji: 'âš¡',
                            label: 'Quick Recovery',
                            class: 'badge-bolt',
                            description: 'Strong performance improvement in recent months'
                        });
                    }
                }
                
                // Badge 9: ðŸ‘‘ Excellence Leader (â‰¥95% overall)
                if (practice.fy25Compliance >= 95) {
                    badges[practice.practice].push({
                        emoji: 'ðŸ‘‘',
                        label: 'Excellence Leader',
                        class: 'badge-crown',
                        description: `Achieved ${practice.fy25Compliance.toFixed(1)}% overall SLA`
                    });
                }
                
                // Badge 10: ðŸ’Ž Elite Performer (â‰¥85% and top 5)
                if (rank <= 5 && practice.fy25Compliance >= 85) {
                    badges[practice.practice].push({
                        emoji: 'ðŸ’Ž',
                        label: 'Elite Performer',
                        class: 'badge-diamond',
                        description: 'Top 5 with excellent performance'
                    });
                }
            });
            
            return badges;
        }

        function renderPracticeView() {
            // Extract actual months from data (dynamic, not hardcoded)
            const fy24months = extractMonthsFromData(filteredData.fy24_25, null);
            const fy25months = extractMonthsFromData(null, filteredData.fy25_26);
            
            const practiceData = {};
            
            // FY 24-25 data
            filteredData.fy24_25.forEach(row => {
                const practice = row['Practice Head'];
                if (!practiceData[practice]) {
                    practiceData[practice] = { fy24Met: 0, fy24NotMet: 0, fy25Met: 0, fy25NotMet: 0 };
                }
                
                fy24months.forEach(month => {
                    practiceData[practice].fy24Met += getMonthData(row, month, 'fy24_25', 'Met');
                    practiceData[practice].fy24NotMet += getMonthData(row, month, 'fy24_25', 'Not_Met');
                });
            });

            // FY 25-26 data
            filteredData.fy25_26.forEach(row => {
                const practice = row['Practice Head'];
                if (!practiceData[practice]) {
                    practiceData[practice] = { fy24Met: 0, fy24NotMet: 0, fy25Met: 0, fy25NotMet: 0 };
                }
                
                fy25months.forEach(month => {
                    practiceData[practice].fy25Met += getMonthData(row, month, 'fy25_26', 'Met');
                    practiceData[practice].fy25NotMet += getMonthData(row, month, 'fy25_26', 'Not_Met');
                });
            });

            const practiceArray = Object.entries(practiceData).map(([practice, data]) => {
                const fy24Total = data.fy24Met + data.fy24NotMet;
                const fy25Total = data.fy25Met + data.fy25NotMet;
                const fy24Compliance = fy24Total > 0 ? parseFloat(((data.fy24Met / fy24Total) * 100).toFixed(1)) : null;
                const fy25Compliance = fy25Total > 0 ? parseFloat(((data.fy25Met / fy25Total) * 100).toFixed(1)) : null;
                
                // Calculate status: New, NA, or numeric difference
                let status = '';
                let statusClass = '';
                if (fy24Compliance === null && fy25Compliance !== null) {
                    status = 'NEW';
                    statusClass = 'status-new';
                } else if (fy24Compliance !== null && fy25Compliance === null) {
                    status = 'N/A';
                    statusClass = 'status-na';
                } else if (fy24Compliance !== null && fy25Compliance !== null) {
                    const diff = fy25Compliance - fy24Compliance;
                    status = (diff >= 0 ? '+' : '') + diff.toFixed(1) + '%';
                    statusClass = diff >= 0 ? 'status-improvement' : 'status-decline';
                } else {
                    status = 'N/A';
                    statusClass = 'status-na';
                }
                
                return { 
                    practice, 
                    fy24Compliance: fy24Compliance !== null ? fy24Compliance : 0, 
                    fy25Compliance: fy25Compliance !== null ? fy25Compliance : 0,
                    fy24Display: fy24Compliance !== null ? fy24Compliance.toFixed(1) + '%' : 'N/A',
                    fy25Display: fy25Compliance !== null ? fy25Compliance.toFixed(1) + '%' : 'N/A',
                    status,
                    statusClass
                };
            }).sort((a, b) => b.fy25Compliance - a.fy25Compliance);

            // Calculate badges for all practice heads
            const practiceBadges = calculatePracticeBadges(practiceArray, practiceData, fy25months);
            
            // Count total badges awarded
            const totalBadges = Object.values(practiceBadges).reduce((sum, badges) => sum + badges.length, 0);
            
            const insightsHTML = `
                <div class="insights-section">
                    <h3><i class="bi bi-lightbulb-fill"></i> Practice Head Performance Overview</h3>
                    <div class="insight-item">
                        <h4>ðŸ‘¥ ${practiceArray.length} Practice Heads Analyzed</h4>
                        <p>Compare year-over-year performance across all practice heads with NEW and N/A indicators for changes in reporting.</p>
                    </div>
                    <div class="insight-item">
                        <h4>ðŸ… ${totalBadges} Performance Badges Awarded</h4>
                        <p>Practice Heads earn badges for excellence, improvement, consistency, and achievement milestones.</p>
                    </div>
                </div>`;
            
            // Generate practice cards
            let cardsHTML = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px; margin-top: 20px;">';
            
            practiceArray.forEach(data => {
                const fy24Color = data.fy24Compliance > 0 ? getRAGColor(data.fy24Compliance) : 'var(--text-secondary)';
                const fy25Color = data.fy25Compliance > 0 ? getRAGColor(data.fy25Compliance) : 'var(--text-secondary)';
                
                // Get badges for this practice head
                const badges = practiceBadges[data.practice] || [];
                let badgesHTML = '';
                if (badges.length > 0) {
                    badgesHTML = '<div class="performance-badges">';
                    badges.forEach(badge => {
                        badgesHTML += `
                            <div class="performance-badge ${badge.class}" title="${badge.description}">
                                <span>${badge.emoji}</span>
                                <span>${badge.label}</span>
                            </div>`;
                    });
                    badgesHTML += '</div>';
                }
                
                cardsHTML += `
                    <div class="practice-card">
                        <div class="practice-card-header">
                            <div class="practice-card-name">
                                <i class="bi bi-person-circle"></i> ${data.practice}
                            </div>
                            <div class="badge ${data.statusClass}">${data.status}</div>
                        </div>
                        <div class="practice-card-metrics">
                            <div class="practice-metric">
                                <div class="practice-metric-label">FY 24-25</div>
                                <div class="practice-metric-value" style="color: ${fy24Color};">
                                    ${data.fy24Display}
                                </div>
                            </div>
                            <div class="practice-metric">
                                <div class="practice-metric-label">FY 25-26</div>
                                <div class="practice-metric-value" style="color: ${fy25Color};">
                                    ${data.fy25Display}
                                </div>
                            </div>
                        </div>
                        ${badgesHTML}
                    </div>`;
            });
            
            cardsHTML += '</div>';
            
            document.getElementById('dashboardContent').innerHTML = insightsHTML + cardsHTML;

            if (audioEnabled) {
                speak(`Practice head analysis loaded with ${practiceArray.length} practice heads.`);
            }
        }
        
        // Render User Manual
        function renderUserManual() {
            const manualHTML = `
                <div class="insights-section" style="margin-bottom: 30px;">
                    <h3><i class="bi bi-book-fill"></i> TAGGD SLA Dashboard - Complete User Manual</h3>
                </div>
                
                <!-- Table of Contents -->
                <div class="card animated-card" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-left: 4px solid #3a1c71;">
                    <h3 style="color: #3a1c71; margin-bottom: 20px;"><i class="bi bi-list-ol"></i> Table of Contents</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                        <div>
                            <a href="#section-overview" style="display: block; padding: 10px; text-decoration: none; color: #3a1c71; background: white; border-radius: 8px; margin-bottom: 8px;"><strong>1.</strong> Dashboard Overview</a>
                            <a href="#section-calculation" style="display: block; padding: 10px; text-decoration: none; color: #3a1c71; background: white; border-radius: 8px; margin-bottom: 8px;"><strong>2.</strong> Calculation Methodology</a>
                            <a href="#section-navigation" style="display: block; padding: 10px; text-decoration: none; color: #3a1c71; background: white; border-radius: 8px; margin-bottom: 8px;"><strong>3.</strong> Navigation Guide</a>
                            <a href="#section-filters" style="display: block; padding: 10px; text-decoration: none; color: #3a1c71; background: white; border-radius: 8px; margin-bottom: 8px;"><strong>4.</strong> Using Filters</a>
                        </div>
                        <div>
                            <a href="#section-audio" style="display: block; padding: 10px; text-decoration: none; color: #3a1c71; background: white; border-radius: 8px; margin-bottom: 8px;"><strong>5.</strong> Audio Features</a>
                            <a href="#section-export" style="display: block; padding: 10px; text-decoration: none; color: #3a1c71; background: white; border-radius: 8px; margin-bottom: 8px;"><strong>6.</strong> Export Options</a>
                            <a href="#section-faq" style="display: block; padding: 10px; text-decoration: none; color: #3a1c71; background: white; border-radius: 8px; margin-bottom: 8px;"><strong>7.</strong> FAQ</a>
                            <a href="#section-bestpractices" style="display: block; padding: 10px; text-decoration: none; color: #3a1c71; background: white; border-radius: 8px; margin-bottom: 8px;"><strong>8.</strong> Best Practices</a>
                        </div>
                    </div>
                </div>
                
                <div class="card animated-card" id="section-overview">
                    <h3><i class="bi bi-info-circle-fill"></i> Dashboard Overview</h3>
                    <p>The TAGGD Executive SLA Performance Dashboard is a comprehensive analytics platform designed to monitor, analyze, and compare Service Level Agreement (SLA) performance across fiscal years, regions, accounts, and practice heads.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Key Features</h4>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Multi-Year Comparison:</strong> Compare FY 24-25 with FY 25-26 performance</li>
                        <li><strong>Interactive Filters:</strong> Filter by fiscal year, region, practice head, account, and month</li>
                        <li><strong>Audio Descriptions:</strong> Enable audio narration in English or Hindi</li>
                        <li><strong>Multiple Views:</strong> 8 different analytical perspectives</li>
                        <li><strong>Export Options:</strong> Export data to Excel or PDF formats</li>
                        <li><strong>RAG Status:</strong> Visual color coding (Red/Amber/Green) for quick assessment</li>
                    </ul>
                </div>
                
                <div class="card animated-card" style="animation-delay: 0.1s;" id="section-calculation">
                    <h3><i class="bi bi-calculator-fill"></i> Calculation Methodology</h3>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">SLA Compliance Percentage</h4>
                    <div style="background: var(--light-color); padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <p style="font-family: monospace; font-size: 1.1em; text-align: center;">
                            <strong>Compliance % = (Total SLAs Met / Total SLAs) Ã— 100</strong>
                        </p>
                        <p style="text-align: center; margin-top: 10px; color: var(--text-secondary);">
                            Where: Total SLAs = SLAs Met + SLAs Not Met
                        </p>
                    </div>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">RAG Status Logic</h4>
                    <table style="margin-top: 15px;">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Range</th>
                                <th>Color</th>
                                <th>Meaning</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>ðŸŸ¢ Green</strong></td>
                                <td>75% - 100%</td>
                                <td style="color: #10b981;">Green (#10b981)</td>
                                <td>Excellent performance</td>
                            </tr>
                            <tr>
                                <td><strong>ðŸŸ¡ Amber</strong></td>
                                <td>50% - 74.99%</td>
                                <td style="color: ' + (diff < 0 ? '#ef4444' : '#10b981') + ';">Amber (#f59e0b)</td>
                                <td>Needs attention</td>
                            </tr>
                            <tr>
                                <td><strong>ðŸ”´ Red</strong></td>
                                <td>0% - 49.99%</td>
                                <td style="color: #ef4444;">Red (#ef4444)</td>
                                <td>Critical - requires immediate action</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Year-over-Year Change Indicators</h4>
                    <table style="margin-top: 15px;">
                        <thead>
                            <tr>
                                <th>Indicator</th>
                                <th>Meaning</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge status-new">NEW</span></td>
                                <td>Practice head/account started reporting in FY 25-26</td>
                                <td>FY 24-25: N/A, FY 25-26: 54.3%</td>
                            </tr>
                            <tr>
                                <td><span class="badge status-na">N/A</span></td>
                                <td>Practice head/account stopped reporting in FY 25-26</td>
                                <td>FY 24-25: 78.5%, FY 25-26: N/A</td>
                            </tr>
                            <tr>
                                <td><span class="badge status-improvement">+5.2%</span></td>
                                <td>Improvement in compliance</td>
                                <td>FY 24-25: 70%, FY 25-26: 75.2%</td>
                            </tr>
                            <tr>
                                <td><span class="badge status-decline">-3.1%</span></td>
                                <td>Decline in compliance</td>
                                <td>FY 24-25: 80%, FY 25-26: 76.9%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="card animated-card" style="animation-delay: 0.2s;" id="section-navigation">
                    <h3><i class="bi bi-map-fill"></i> Navigation Guide</h3>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Dashboard Views</h4>
                    <table style="margin-top: 15px;">
                        <thead>
                            <tr>
                                <th>View</th>
                                <th>Icon</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Overview</strong></td>
                                <td><i class="bi bi-grid-3x3-gap"></i></td>
                                <td>High-level summary with key insights and FY comparison</td>
                            </tr>
                            <tr>
                                <td><strong>Monthly Performance</strong></td>
                                <td><i class="bi bi-calendar-month"></i></td>
                                <td>Month-by-month trend analysis for both fiscal years</td>
                            </tr>
                            <tr>
                                <td><strong>Quarterly Performance</strong></td>
                                <td><i class="bi bi-calendar3"></i></td>
                                <td>Quarterly aggregated performance comparison</td>
                            </tr>
                            <tr>
                                <td><strong>Year-over-Year</strong></td>
                                <td><i class="bi bi-calendar-year"></i></td>
                                <td>Annual comparison with percentage change analysis</td>
                            </tr>
                            <tr>
                                <td><strong>Project Analysis</strong></td>
                                <td><i class="bi bi-building"></i></td>
                                <td>Account-wise performance with trend indicators</td>
                            </tr>
                            <tr>
                                <td><strong>Regional Analysis</strong></td>
                                <td><i class="bi bi-geo-alt-fill"></i></td>
                                <td>Geographic performance comparison</td>
                            </tr>
                            <tr>
                                <td><strong>Practice Head Analysis</strong></td>
                                <td><i class="bi bi-people-fill"></i></td>
                                <td>Practice leader performance cards with NEW/N/A indicators</td>
                            </tr>
                            <tr>
                                <td><strong>Industry Benchmarking</strong></td>
                                <td><i class="bi bi-trophy-fill"></i></td>
                                <td>Comparison with industry competitors and trends</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="card animated-card" style="animation-delay: 0.3s;" id="section-filters">
                    <h3><i class="bi bi-funnel-fill"></i> Using Filters</h3>
                    <p>Filters allow you to focus on specific segments of your data:</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Available Filters</h4>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Fiscal Year:</strong> View all years, FY 24-25 only, or FY 25-26 only</li>
                        <li><strong>Region:</strong> Filter by geographic region (e.g., North, South, East, West)</li>
                        <li><strong>Practice Head:</strong> Focus on specific practice leaders</li>
                        <li><strong>Account:</strong> Analyze individual client accounts</li>
                        <li><strong>Month:</strong> View specific month data across both years</li>
                    </ul>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Filter Tips</h4>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li>Filters are cascading - unavailable options are automatically disabled</li>
                        <li>Use "Clear All Filters" to reset to default view</li>
                        <li>Filters apply to all dashboard views</li>
                        <li>Filtered data is reflected in exports</li>
                    </ul>
                </div>
                
                <div class="card animated-card" style="animation-delay: 0.4s;" id="section-audio">
                    <h3><i class="bi bi-volume-up-fill"></i> Audio & Voice Features</h3>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);"><i class="bi bi-mic-fill"></i> ðŸŽ¤ Voice-Enabled Navigation (NEW!)</h4>
                    <p>Control the dashboard hands-free using natural voice commands with intelligent recognition.</p>
                    
                    <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 20px; border-radius: 10px; margin: 15px 0; border-left: 4px solid #FF6B35;">
                        <h5 style="color: #92400e; margin-bottom: 10px;">ðŸš€ How to Use Voice Commands:</h5>
                        <ol style="line-height: 2.2; margin-left: 20px; color: #78350f;">
                            <li>Click the <strong>orange microphone button</strong> ðŸŽ¤ in the bottom-right corner</li>
                            <li>Grant microphone permission when prompted by your browser</li>
                            <li>Wait for the <strong>beep sound</strong> and "Listening..." indicator</li>
                            <li>Speak your command clearly and naturally</li>
                            <li>Dashboard executes your request automatically</li>
                        </ol>
                    </div>

                    <h5 style="margin-top: 20px; color: var(--primary-color);">ðŸ“ Supported Voice Commands:</h5>
                    <table style="margin-top: 15px;">
                        <thead>
                            <tr>
                                <th>Command Type</th>
                                <th>Example Phrases</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Month Filter</strong></td>
                                <td>"Show me October SLA"<br>"Show me April data"<br>"Filter December"</td>
                                <td>Applies month filter and shows overview</td>
                            </tr>
                            <tr>
                                <td><strong>Region Filter</strong></td>
                                <td>"Show me North region SLAs"<br>"Filter South region"<br>"Display West region data"</td>
                                <td>Applies region filter automatically</td>
                            </tr>
                            <tr>
                                <td><strong>Practice Head Filter</strong></td>
                                <td>"Filter Krishna practice head"<br>"Show Bapi Reddy's data"<br>"Megha practice head"</td>
                                <td>Applies practice head filter</td>
                            </tr>
                            <tr>
                                <td><strong>View Navigation</strong></td>
                                <td>"Switch to Practice Head view"<br>"Show monthly view"<br>"Open quarterly"</td>
                                <td>Navigates to specified view</td>
                            </tr>
                            <tr>
                                <td><strong>Export</strong></td>
                                <td>"Export this dashboard"<br>"Download PDF"<br>"Export data"</td>
                                <td>Triggers PDF/Excel export</td>
                            </tr>
                        </tbody>
                    </table>

                    <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #3b82f6;">
                        <h5 style="color: #1e40af; margin-bottom: 8px;">ðŸ’¡ Pro Tips:</h5>
                        <ul style="line-height: 2; margin-left: 20px; color: #1e3a8a;">
                            <li>Speak naturally - the system understands context</li>
                            <li>Use region names, practice head names, or month names</li>
                            <li>Check the help tooltip by hovering over the mic button</li>
                            <li>Works best in quiet environments</li>
                            <li>Supported in Chrome, Edge (Full), Safari (Limited)</li>
                        </ul>
                    </div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px dashed #d1d5db;">

                    <h4 style="margin-top: 20px; color: var(--primary-color);"><i class="bi bi-clock-history"></i> â° Last Updated Timestamp (NEW!)</h4>
                    <p>The dashboard now displays a real-time timestamp in the <strong>top-right corner</strong> showing when data was last updated.</p>
                    
                    <div style="background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%); padding: 20px; border-radius: 10px; margin: 15px 0; border-left: 4px solid #9333ea;">
                        <h5 style="color: #581c87; margin-bottom: 10px;">ðŸ“‹ Timestamp Features:</h5>
                        <ul style="line-height: 2; margin-left: 20px; color: #6b21a8;">
                            <li><strong>Format:</strong> "Last Updated: Monday, 25 November 2025, 2:30 PM"</li>
                            <li><strong>Auto-Update:</strong> Refreshes automatically when you upload new data</li>
                            <li><strong>Always Visible:</strong> Fixed position in top-right corner</li>
                            <li><strong>Theme-Aware:</strong> Adapts to light and dark modes</li>
                            <li><strong>Mobile-Friendly:</strong> Responsive design for all screen sizes</li>
                        </ul>
                    </div>

                    <div style="background: #d1fae5; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #10b981;">
                        <p style="margin: 0; color: #065f46;"><strong>âœ¨ Benefits:</strong> Stay informed about data freshness â€¢ Build trust in data currency â€¢ Make decisions based on up-to-date information â€¢ Track when colleagues uploaded new data</p>
                    </div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px dashed #d1d5db;">
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);"><i class="bi bi-volume-up-fill"></i> Audio Narration</h4>
                    <p>Enable traditional audio narration for accessibility and presentations.</p>
                    
                    <h5 style="margin-top: 15px; color: var(--primary-color);">Enabling Audio Narration:</h5>
                    <ol style="line-height: 2; margin-left: 20px;">
                        <li>Click the "Enable Audio" button in the sidebar</li>
                        <li>Select your preferred language (English or Hindi)</li>
                        <li>Navigate the dashboard - actions and insights will be narrated</li>
                    </ol>
                    
                    <h5 style="margin-top: 20px; color: var(--primary-color);">Supported Languages:</h5>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>English (en-US):</strong> Default language</li>
                        <li><strong>Hindi (hi-IN):</strong> à¤¹à¤¿à¤‚à¤¦à¥€ à¤®à¥‡à¤‚ à¤‘à¤¡à¤¿à¤¯à¥‹ à¤µà¤¿à¤µà¤°à¤£</li>
                    </ul>
                </div>
                
                <div class="card animated-card" style="animation-delay: 0.5s;" id="section-export">
                    <h3><i class="bi bi-download"></i> Export Options</h3>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Excel Export</h4>
                    <p>Exports the currently filtered data to an Excel workbook with multiple sheets for different analyses.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">PDF Export</h4>
                    <p>Creates a PDF snapshot of the current dashboard view including all visible charts and tables.</p>
                </div>
                
                <div class="card animated-card" style="animation-delay: 0.6s;" id="section-faq">
                    <h3><i class="bi bi-question-circle-fill"></i> Frequently Asked Questions</h3>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: Why does FY 25-26 show data only up to September?</h4>
                    <p><strong>A:</strong> FY 25-26 is the current fiscal year. The latest uploaded data includes records up to September 2025. The dashboard is future-proof and will automatically display additional months once new monthly SLA reports are uploaded and processed. The system dynamically detects available months from the data columns.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: What does "N/A" mean in year-over-year comparisons?</h4>
                    <p><strong>A:</strong> N/A appears when an account or practice head was reporting in one fiscal year but not in the other. This could indicate discontinued accounts or new engagements.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: What does "NEW" mean?</h4>
                    <p><strong>A:</strong> NEW indicates that the account or practice head started reporting SLAs in FY 25-26 and was not present in FY 24-25 data.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: How are quarterly metrics calculated?</h4>
                    <p><strong>A:</strong> Quarterly compliance is calculated by aggregating all SLAs (met and not met) within the three months of each quarter, then calculating the compliance percentage.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: Can I compare specific months across years?</h4>
                    <p><strong>A:</strong> Yes! Use the Month filter to select a specific month (e.g., "April"), and all views will show only that month's data for both fiscal years.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: What is the Regional Head filter?</h4>
                    <p><strong>A:</strong> The Regional Head filter allows you to view SLA performance data for specific regional leaders. This filter cascades down to show only the regions, practice heads, and accounts under the selected regional head. Currently available regional heads are Anjli Zutshi and Sulabh Arora.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: How do cascading filters work?</h4>
                    <p><strong>A:</strong> The filters are hierarchical: Regional Head â†’ Region â†’ Practice Head â†’ Account. When you select a Regional Head, the Region dropdown automatically updates to show only regions under that regional head. Similarly, selecting a Region filters the Practice Head options, and so on. This helps you drill down from executive level to individual project level seamlessly.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: Why did FY 24-25 data not appear when I filtered by Regional Head?</h4>
                    <p><strong>A:</strong> This issue has been fixed! Previously, there was a column name inconsistency in the data (FY 24-25 used "Regional Head" while FY 25-26 used "Regional Head " with a space). The dashboard now handles both variations automatically, so all data displays correctly regardless of the filter applied.</p>
                    
                    <h4 style="margin-top: 20px; color: var(--primary-color);">Q: Will the dashboard automatically update when new monthly data is available?</h4>
                    <p><strong>A:</strong> Yes! The dashboard is future-proof. Once new monthly SLA reports are processed and the data file is updated, simply re-upload the file to the dashboard. The system will automatically detect available months from the data columns and update all views, charts, and filters accordingly. No code changes are required.</p>
                </div>
                
                <div class="card animated-card" style="animation-delay: 0.7s;" id="section-bestpractices">
                    <h3><i class="bi bi-lightbulb-fill"></i> Best Practices</h3>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Start with Overview:</strong> Get a high-level understanding before diving into details</li>
                        <li><strong>Use Filters Strategically:</strong> Narrow down to specific areas of concern</li>
                        <li><strong>Monitor Trends:</strong> Check monthly and quarterly views regularly</li>
                        <li><strong>Focus on Red Items:</strong> Priority attention to accounts/regions below 50%</li>
                        <li><strong>Celebrate Greens:</strong> Recognize and learn from high-performing areas</li>
                        <li><strong>Export for Meetings:</strong> Use PDF export for presentations</li>
                    </ul>
                </div>
                
                <div style="background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%); color: white; padding: 25px; border-radius: 12px; text-align: center; margin-top: 30px;">
                    <h3 style="color: white; border: none; padding: 0; margin-bottom: 10px;">
                        <i class="bi bi-info-circle-fill"></i> Need Help?
                    </h3>
                    <p>For additional support or questions about the TAGGD SLA Dashboard, please contact your system administrator or the TAGGD analytics team.</p>
                </div>
            `;
            
            document.getElementById('dashboardContent').innerHTML = manualHTML;
            
            if (audioEnabled) {
                speak('User manual loaded. This comprehensive guide covers all dashboard features and calculations.');
            }
        }

        // Render Benchmarking View (Investment column removed)
        function renderBenchmarkingView() {
            const fy25Metrics = calculateOverallMetrics(filteredData.fy25_26, 'fy25_26');
            
            const competitorArray = Object.entries(industryBenchmarks.competitors).map(([name, data]) => ({
                name,
                sla: data.sla,
                feature: data.feature,
                sourceUrl: data.sourceUrl,
                sourceName: data.sourceName,
                diff: data.sla - fy25Metrics.compliance
            }));

            const taggdRank = competitorArray.filter(c => c.sla > fy25Metrics.compliance).length + 1;
            const gap = Math.max(...competitorArray.map(c => c.sla)) - fy25Metrics.compliance;

            const insightsHTML = `
                <div class="insights-section">
                    <h3><i class="bi bi-lightbulb-fill"></i> Competitive Intelligence Insights</h3>
                    <div class="insight-item">
                        <h4>ðŸŽ¯ Market Position</h4>
                        <p>TAGGD ranks #${taggdRank} among ${competitorArray.length + 1} players with ${fy25Metrics.compliance}% compliance. ${gap > 0 ? `${gap.toFixed(1)}% gap to industry leader.` : 'Leading the industry!'}</p>
                    </div>
                    <div class="insight-item">
                        <h4>ðŸ’¡ Key Differentiator Opportunity</h4>
                        <p>Top performers leverage AI-powered matching and predictive analytics. Investing in these technologies could close the performance gap.</p>
                    </div>
                    <div class="insight-item">
                        <h4>ðŸ“ˆ Strategic Recommendation</h4>
                        <p>Target 87%+ compliance to match Korn Ferry's leadership position. Focus on AI/ML implementation and predictive client retention systems.</p>
                    </div>
                </div>`;
            
            let html = `
                ${insightsHTML}
                <div class="card">
                    <h3><i class="bi bi-bar-chart-line"></i> Competitive SLA Performance Comparison</h3>
                    <div class="chart-container">
                        <canvas id="benchmarkChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h3><i class="bi bi-speedometer2"></i> TAGGD vs. Industry Leaders</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Vendor</th>
                                <th>SLA Compliance</th>
                                <th>vs TAGGD</th>
                                <th>Key Differentiator</th>
                                <th>Latest Tech Innovation</th>
                            </tr>
                        </thead>
                        <tbody>`;
            
            // Add TAGGD row first
            html += `
                <tr style="background: var(--light-color); font-weight: bold;">
                    <td><strong>TAGGD (Current)</strong></td>
                    <td style="font-weight: bold; color: var(--primary-color);">${fy25Metrics.compliance}%</td>
                    <td>-</td>
                    <td>Comprehensive RPO Services</td>
                </tr>`;

            competitorArray.forEach(comp => {
                const isImprovement = comp.diff < 0; // TAGGD is better
                const diffColor = isImprovement ? 'var(--improvement-color)' : 'var(--danger-color)';
                const diffIcon = isImprovement ? 'â†“' : 'â†‘';
                const diffText = `${diffIcon}${Math.abs(comp.diff).toFixed(1)}%`;
                
                // Get competitor details from industryBenchmarks
                const competitorData = industryBenchmarks.competitors[comp.name];
                
                html += `
                    <tr>
                        <td><strong>${comp.name}</strong></td>
                        <td style="font-weight: bold;">${comp.sla}%</td>
                        <td style="color: ${diffColor}; font-weight: bold;">${diffText}</td>
                        <td style="font-size: 0.9em;">
                            <div style="margin-bottom: 4px;">${comp.feature}</div>
                            ${competitorData && competitorData.sourceUrl ? `<a href="${competitorData.sourceUrl}" target="_blank" rel="noopener noreferrer" style="color: #3498db; font-size: 11px; text-decoration: none; display: inline-flex; align-items: center; gap: 3px;" title="View source: ${competitorData.sourceName}"><i class="bi bi-file-earmark-text"></i> ${competitorData.sourceName}</a>` : ''}
                        </td>
                        <td style="font-size: 0.85em; max-width: 300px;">
                            ${competitorData && competitorData.innovation ? `
                                <div style="color: #2c3e50; line-height: 1.5; margin-bottom: 6px;">${competitorData.innovation}</div>
                                ${competitorData.innovationUrl ? `<a href="${competitorData.innovationUrl}" target="_blank" rel="noopener noreferrer" style="color: #e67e22; font-size: 10px; text-decoration: none; font-weight: 600; display: inline-flex; align-items: center; gap: 3px;" title="${competitorData.innovationSource}"><i class="bi bi-lightbulb"></i> ${competitorData.innovationSource}</a>` : ''}
                            ` : '<span style="color: #95a5a6;">N/A</span>'}
                        </td>
                    </tr>`;
            });
            
            html += `
                        </tbody>
                    </table>
                    <p style="margin-top: 15px; font-size: 0.85em; color: var(--text-secondary); font-style: italic;">
                        <i class="bi bi-info-circle"></i> â†‘ indicates competitor ahead of TAGGD | â†“ indicates TAGGD ahead of competitor
                    </p>
                </div>

                <div class="card">
                    <h3><i class="bi bi-lightbulb-fill"></i> Emerging Industry Trends</h3>`;
            
            industryBenchmarks.trends.forEach((trend, index) => {
                const impactColor = trend.impact === 'Critical' ? '#c0392b' : 
                                   trend.impact === 'High' ? 'var(--danger-color)' : 
                                   trend.impact === 'Medium' ? 'var(--warning-color)' : '#3498db';
                html += `
                    <div style="background: var(--light-color); padding: 18px; border-radius: 10px; margin-bottom: 15px; border-left: 5px solid ${impactColor}; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: var(--primary-color); font-size: 16px;">${index + 1}. ${trend.title}</h4>
                            <span style="background: ${impactColor}; color: white; padding: 4px 12px; border-radius: 15px; font-weight: 600; font-size: 11px; white-space: nowrap; margin-left: 10px;">${trend.impact} Impact</span>
                        </div>
                        ${trend.category ? `<div style="margin-bottom: 8px;"><span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 3px 10px; border-radius: 10px; font-size: 10px; font-weight: 600; text-transform: uppercase;">ðŸ“‚ ${trend.category}</span></div>` : ''}
                        <p style="margin: 0 0 10px 0; line-height: 1.7; color: #555; font-size: 14px;">${trend.description}</p>
                        ${trend.keyStats && trend.keyStats.length > 0 ? `
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin: 10px 0;">
                            <div style="font-weight: 600; font-size: 11px; color: #7f8c8d; margin-bottom: 6px;">ðŸ“Š KEY STATISTICS</div>
                            ${trend.keyStats.map(stat => `<div style="font-size: 12px; color: #34495e; margin: 4px 0; padding-left: 8px;">â€¢ ${stat}</div>`).join('')}
                        </div>` : ''}
                        ${trend.timeline ? `
                        <div style="margin: 10px 0; padding: 8px 12px; background: #e8f5e9; border-left: 3px solid #4caf50; border-radius: 4px;">
                            <span style="font-size: 12px; color: #2e7d32; font-weight: 600;">â± Timeline: ${trend.timeline}</span>
                        </div>` : ''}
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 12px; padding-top: 10px; border-top: 1px solid #e0e0e0; font-size: 0.85em;">
                            <span style="color: var(--success-color); font-weight: 600;"><i class="bi bi-graph-up-arrow"></i> ${trend.metric}</span>
                            ${trend.sourceUrl ? `<a href="${trend.sourceUrl}" target="_blank" rel="noopener noreferrer" style="color: #3498db; text-decoration: none; font-weight: 500; display: flex; align-items: center; gap: 4px;" title="View source report"><i class="bi bi-link-45deg" style="font-size: 16px;"></i> ${trend.source}</a>` : `<span style="color: var(--text-secondary);"><i class="bi bi-journal-text"></i> ${trend.source}</span>`}
                        </div>
                    </div>`;
            });
            
            html += `</div>`;
            
            document.getElementById('dashboardContent').innerHTML = html;

            if (audioEnabled) {
                speak(`Industry benchmarking loaded. TAGGD ranks number ${taggdRank} with ${fy25Metrics.compliance} percent compliance. Gap to leader is ${gap.toFixed(1)} percent.`);
            }
            
            // Render benchmark chart
            const ctx = document.getElementById('benchmarkChart').getContext('2d');
            const labels = ['TAGGD (Current)', ...Object.keys(industryBenchmarks.competitors)];
            const data = [fy25Metrics.compliance, ...Object.values(industryBenchmarks.competitors).map(c => c.sla)];
            
            charts.benchmark = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'SLA Compliance %',
                        data: data,
                        backgroundColor: data.map((val, idx) => idx === 0 ? '#FF6B35' : '#10b981'),
                        borderColor: data.map((val, idx) => idx === 0 ? '#E65528' : '#059669'),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            color: '#000',
                            font: { weight: 'bold', size: 12 },
                            formatter: (value) => value + '%'
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,  // Show 0, 20, 40, 60, 80, 100
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    }
                }
            });
        }

        // About Dashboard View
        function renderAboutView() {
            const aboutHTML = `
                <div class="insights-section" style="margin-bottom: 30px;">
                    <h3><i class="bi bi-info-circle-fill"></i> About TAGGD SLA Performance Dashboard</h3>
                </div>
                
                <!-- Dashboard Purpose -->
                <div class="card animated-card" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-left: 5px solid #3a1c71;">
                    <h3 style="color: #3a1c71;"><i class="bi bi-bullseye"></i> Dashboard Purpose</h3>
                    <p style="font-size: 1.1em; line-height: 1.8; margin-top: 15px;">
                        The TAGGD SLA Performance Dashboard is a comprehensive analytics platform designed to provide executive-level insights 
                        into Service Level Agreement (SLA) performance across the organization. This dashboard enables data-driven decision-making 
                        by transforming raw SLA data into actionable intelligence through interactive visualizations, comparative analysis, and 
                        detailed performance tracking.
                    </p>
                </div>
                
                <!-- Key Objectives -->
                <div class="card animated-card" style="animation-delay: 0.1s;">
                    <h3 style="color: #3a1c71;"><i class="bi bi-check2-circle"></i> Key Objectives</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div style="padding: 20px; background: linear-gradient(135deg, #10b981 0%, #34d399 100%); color: white; border-radius: 12px;">
                            <h4 style="margin-bottom: 10px;"><i class="bi bi-graph-up-arrow"></i> Performance Monitoring</h4>
                            <p style="opacity: 0.95;">Track SLA compliance rates across fiscal years, regions, accounts, and practice heads in real-time.</p>
                        </div>
                        <div style="padding: 20px; background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%); color: white; border-radius: 12px;">
                            <h4 style="margin-bottom: 10px;"><i class="bi bi-bar-chart-line"></i> Trend Analysis</h4>
                            <p style="opacity: 0.95;">Identify patterns and trends through monthly, quarterly, and year-over-year comparisons.</p>
                        </div>
                        <div style="padding: 20px; background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%); color: white; border-radius: 12px;">
                            <h4 style="margin-bottom: 10px;"><i class="bi bi-flag"></i> Strategic Insights</h4>
                            <p style="opacity: 0.95;">Generate executive summaries with top/bottom performers, improvement areas, and competitive benchmarking.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Who Should Use This Dashboard -->
                <div class="card animated-card" style="animation-delay: 0.2s;">
                    <h3 style="color: #3a1c71;"><i class="bi bi-people"></i> Who Should Use This Dashboard</h3>
                    <table style="margin-top: 15px;">
                        <thead>
                            <tr>
                                <th>Role</th>
                                <th>Primary Use Cases</th>
                                <th>Recommended Views</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>ðŸŽ¯ Executive Leadership</strong></td>
                                <td>Strategic planning, high-level performance oversight, YoY comparison</td>
                                <td>Overview, Executive View, Year-over-Year</td>
                            </tr>
                            <tr>
                                <td><strong>ðŸ† Practice Heads</strong></td>
                                <td>Team performance management, resource allocation, improvement tracking</td>
                                <td>Practice Head Analysis, Monthly Performance, Account Analysis</td>
                            </tr>
                            <tr>
                                <td><strong>ðŸŒ Regional Managers</strong></td>
                                <td>Regional performance comparison, account management, trend analysis</td>
                                <td>Regional Analysis, Quarterly Performance, Account Analysis</td>
                            </tr>
                            <tr>
                                <td><strong>ðŸ“Š Data Analysts</strong></td>
                                <td>Deep-dive analysis, data export, custom filtering, detailed reporting</td>
                                <td>All views, Export features, Filter combinations</td>
                            </tr>
                            <tr>
                                <td><strong>ðŸ‘” Account Managers</strong></td>
                                <td>Client-specific performance, improvement opportunities, SLA adherence</td>
                                <td>Account Analysis, Not Reported Analysis, Monthly Trends</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Dashboard Capabilities -->
                <div class="card animated-card" style="animation-delay: 0.3s;">
                    <h3 style="color: #3a1c71;"><i class="bi bi-gear-fill"></i> Dashboard Capabilities</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #10b981;">
                            <h4 style="color: #10b981; margin-bottom: 8px;">âœ… Multi-Year Comparison</h4>
                            <p>Compare FY 24-25 and FY 25-26 side-by-side with automatic YoY calculations</p>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #3b82f6;">
                            <h4 style="color: #3b82f6; margin-bottom: 8px;">ðŸ” Advanced Filtering</h4>
                            <p>Filter by region, practice head, account, fiscal year, and month combinations</p>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #8b5cf6;">
                            <h4 style="color: #8b5cf6; margin-bottom: 8px;">ðŸ“ˆ Interactive Charts</h4>
                            <p>Dynamic visualizations with drill-down capabilities and real-time updates</p>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #f59e0b;">
                            <h4 style="color: #f59e0b; margin-bottom: 8px;">ðŸŽ¨ RAG Status Coding</h4>
                            <p>Visual color indicators (Red/Amber/Green) for instant performance assessment</p>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #ef4444;">
                            <h4 style="color: #ef4444; margin-bottom: 8px;">ðŸ“¤ Export Options</h4>
                            <p>Export to Excel, PDF, and PowerPoint for reporting and presentations</p>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #06b6d4;">
                            <h4 style="color: #06b6d4; margin-bottom: 8px;">ðŸ”Š Audio Narration</h4>
                            <p>Enable voice descriptions in English or Hindi for accessibility</p>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #FF6B35;">
                            <h4 style="color: #FF6B35; margin-bottom: 8px;">ðŸŽ¤ Voice Commands</h4>
                            <p>Hands-free navigation with intelligent voice recognition and natural language processing</p>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #9333ea;">
                            <h4 style="color: #9333ea; margin-bottom: 8px;">â° Live Timestamp</h4>
                            <p>Real-time display of last data update for transparency and data freshness tracking</p>
                        </div>
                    </div>
                </div>

                <!-- New Features: Voice Control & Timestamp -->
                <div class="card animated-card" style="animation-delay: 0.35s; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-left: 5px solid #f59e0b;">
                    <h3 style="color: #92400e;"><i class="bi bi-stars"></i> âœ¨ New Features</h3>
                    
                    <div style="margin-top: 20px;">
                        <h4 style="color: #FF6B35; margin-bottom: 10px;"><i class="bi bi-mic-fill"></i> ðŸŽ¤ Voice-Enabled Navigation</h4>
                        <p style="line-height: 1.8; margin-bottom: 15px;">
                            Control the dashboard hands-free using natural voice commands. The intelligent voice recognition system 
                            understands context and can apply filters, switch views, and execute actions based on your spoken instructions.
                        </p>
                        
                        <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                            <h5 style="color: #3a1c71; margin-bottom: 12px;">ðŸ“ Example Voice Commands:</h5>
                            <ul style="line-height: 2.2; list-style: none; padding-left: 0;">
                                <li style="padding: 8px; background: #f0f9ff; margin: 5px 0; border-radius: 5px; border-left: 3px solid #3b82f6;">
                                    <strong>"Show me October SLA"</strong> â†’ Filters to October and shows overview
                                </li>
                                <li style="padding: 8px; background: #f0fdf4; margin: 5px 0; border-radius: 5px; border-left: 3px solid #10b981;">
                                    <strong>"Show me North region SLAs"</strong> â†’ Filters to North region automatically
                                </li>
                                <li style="padding: 8px; background: #fef3c7; margin: 5px 0; border-radius: 5px; border-left: 3px solid #f59e0b;">
                                    <strong>"Switch to Practice Head view"</strong> â†’ Opens Practice Head analysis
                                </li>
                                <li style="padding: 8px; background: #fce7f3; margin: 5px 0; border-radius: 5px; border-left: 3px solid #ec4899;">
                                    <strong>"Export this dashboard"</strong> â†’ Triggers PDF export
                                </li>
                                <li style="padding: 8px; background: #ede9fe; margin: 5px 0; border-radius: 5px; border-left: 3px solid #8b5cf6;">
                                    <strong>"Filter Krishna practice head"</strong> â†’ Applies Practice Head filter
                                </li>
                            </ul>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="padding: 12px; background: white; border-radius: 8px; text-align: center;">
                                <i class="bi bi-hand-thumbs-up" style="font-size: 2em; color: #10b981;"></i>
                                <p style="margin-top: 8px; font-size: 0.9em;"><strong>Intelligent Recognition</strong><br>Understands natural language</p>
                            </div>
                            <div style="padding: 12px; background: white; border-radius: 8px; text-align: center;">
                                <i class="bi bi-lightning-charge" style="font-size: 2em; color: #f59e0b;"></i>
                                <p style="margin-top: 8px; font-size: 0.9em;"><strong>Fast & Responsive</strong><br>Instant command execution</p>
                            </div>
                            <div style="padding: 12px; background: white; border-radius: 8px; text-align: center;">
                                <i class="bi bi-volume-up" style="font-size: 2em; color: #3b82f6;"></i>
                                <p style="margin-top: 8px; font-size: 0.9em;"><strong>Audio Feedback</strong><br>Beeps & visual indicators</p>
                            </div>
                        </div>

                        <div style="margin-top: 20px; padding: 15px; background: rgba(255, 255, 255, 0.7); border-radius: 8px; border: 2px dashed #f59e0b;">
                            <p style="margin: 0; color: #92400e;"><strong>ðŸ“ How to Use:</strong> Click the orange microphone button ðŸŽ¤ in the bottom-right corner, grant microphone permission, and speak your command naturally!</p>
                        </div>
                    </div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px dashed #f59e0b;">

                    <div style="margin-top: 20px;">
                        <h4 style="color: #9333ea; margin-bottom: 10px;"><i class="bi bi-clock-history"></i> â° Last Updated Timestamp</h4>
                        <p style="line-height: 1.8; margin-bottom: 15px;">
                            Stay informed about data freshness with the real-time timestamp display in the top-right corner. 
                            The timestamp automatically updates whenever new data is uploaded, ensuring transparency and trust in the dashboard's information.
                        </p>
                        
                        <div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">
                            <h5 style="color: #3a1c71; margin-bottom: 12px;">ðŸ“‹ Timestamp Features:</h5>
                            <ul style="line-height: 2; margin-left: 20px;">
                                <li><strong>Format:</strong> "Last Updated: Monday, 25 November 2025, 2:30 PM"</li>
                                <li><strong>Auto-Update:</strong> Refreshes automatically on data upload</li>
                                <li><strong>Position:</strong> Fixed top-right corner (always visible)</li>
                                <li><strong>Responsive:</strong> Adapts to all screen sizes</li>
                                <li><strong>Theme-Aware:</strong> Works in both light and dark modes</li>
                            </ul>
                        </div>

                        <div style="margin-top: 15px; padding: 15px; background: rgba(255, 255, 255, 0.7); border-radius: 8px; border: 2px dashed #9333ea;">
                            <p style="margin: 0; color: #581c87;"><strong>âœ¨ Benefits:</strong> Know exactly when data was last refreshed â€¢ Build trust in data currency â€¢ Make informed decisions based on data timeliness</p>
                        </div>
                    </div>
                </div>
                
                <!-- Data Sources & Methodology -->
                <div class="card animated-card" style="animation-delay: 0.4s;">
                    <h3 style="color: #3a1c71;"><i class="bi bi-database-fill"></i> Data Sources & Methodology</h3>
                    <h4 style="margin-top: 20px; color: #3a1c71;">Data Input</h4>
                    <p>The dashboard accepts Excel files (.xlsx format) with the following sheet structure:</p>
                    <ul style="line-height: 2; margin-left: 20px; margin-top: 10px;">
                        <li><strong>FY 24-25:</strong> Monthly SLA data (Met/Not Met) for fiscal year 2024-2025</li>
                        <li><strong>FY 25-26:</strong> Monthly SLA data (Met/Not Met) for fiscal year 2025-2026</li>
                        <li><strong>FY24-25 Not Reported:</strong> Not reported SLA counts by month</li>
                        <li><strong>FY25-26 Not Reported:</strong> Not reported SLA counts by month</li>
                    </ul>
                    
                    <h4 style="margin-top: 25px; color: #3a1c71;">Calculation Logic</h4>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 15px;">
                        <p style="font-family: monospace; font-size: 1.05em;"><strong>SLA Compliance % = (SLAs Met / Total SLAs) Ã— 100</strong></p>
                        <p style="margin-top: 10px; color: #666;">Total SLAs = SLAs Met + SLAs Not Met</p>
                        <p style="margin-top: 10px; color: #666;">YoY Change % = ((FY 25-26 % - FY 24-25 %) / FY 24-25 %) Ã— 100</p>
                    </div>
                    
                    <h4 style="margin-top: 25px; color: #3a1c71;">RAG Status Thresholds</h4>
                    <table style="margin-top: 15px;">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Range</th>
                                <th>Indicator</th>
                                <th>Action Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: rgba(16, 185, 129, 0.1);">
                                <td><strong>ðŸŸ¢ Green</strong></td>
                                <td>75% - 100%</td>
                                <td>Excellent</td>
                                <td>Maintain standards, share best practices</td>
                            </tr>
                            <tr style="background: rgba(245, 158, 11, 0.1);">
                                <td><strong>ðŸŸ¡ Amber</strong></td>
                                <td>50% - 74.99%</td>
                                <td>Needs Attention</td>
                                <td>Identify gaps, implement improvements</td>
                            </tr>
                            <tr style="background: rgba(239, 68, 68, 0.1);">
                                <td><strong>ðŸ”´ Red</strong></td>
                                <td>0% - 49.99%</td>
                                <td>Critical</td>
                                <td>Immediate action required, escalate to leadership</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Version & Technical Info -->
                <div class="card animated-card" style="animation-delay: 0.5s; background: linear-gradient(135deg, #3a1c71 0%, #d76d77 50%, #ffaf7b 100%); color: white;">
                    <h3 style="color: white;"><i class="bi bi-code-square"></i> Technical Information</h3>
                    <div style="margin-top: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div>
                            <h4 style="color: rgba(255,255,255,0.9); font-size: 0.95em;">Version</h4>
                            <p style="font-size: 1.3em; font-weight: bold; margin-top: 5px;">v7.0 Enhanced</p>
                        </div>
                        <div>
                            <h4 style="color: rgba(255,255,255,0.9); font-size: 0.95em;">Last Updated</h4>
                            <p style="font-size: 1.3em; font-weight: bold; margin-top: 5px;">January 2025</p>
                        </div>
                        <div>
                            <h4 style="color: rgba(255,255,255,0.9); font-size: 0.95em;">Built With</h4>
                            <p style="font-size: 1.1em; margin-top: 5px;">Chart.js, Bootstrap Icons, XLSX.js, jsPDF, PptxGenJS</p>
                        </div>
                        <div>
                            <h4 style="color: rgba(255,255,255,0.9); font-size: 0.95em;">Browser Support</h4>
                            <p style="font-size: 1.1em; margin-top: 5px;">Chrome, Edge, Firefox, Safari (latest versions)</p>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Start -->
                <div class="card animated-card" style="animation-delay: 0.6s;">
                    <h3 style="color: #3a1c71;"><i class="bi bi-lightning-fill"></i> Quick Start Guide</h3>
                    <div style="margin-top: 20px;">
                        <ol style="line-height: 2.2; font-size: 1.05em;">
                            <li><strong>Upload Data:</strong> Click the "Upload Excel File" button and select your SLA data file</li>
                            <li><strong>Explore Views:</strong> Navigate through different analytical views using the sidebar menu</li>
                            <li><strong>Apply Filters:</strong> Use the filter panel to focus on specific regions, accounts, or time periods</li>
                            <li><strong>Analyze Trends:</strong> Review charts and tables to identify performance patterns</li>
                            <li><strong>Export Reports:</strong> Generate PDF, Excel, or PowerPoint reports for stakeholders</li>
                            <li><strong>Take Action:</strong> Use insights to drive performance improvements and strategic decisions</li>
                        </ol>
                    </div>
                </div>
                
                <!-- Support & Feedback -->
                <div class="card animated-card" style="animation-delay: 0.7s; text-align: center; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border: 2px solid #3a1c71;">
                    <h3 style="color: #3a1c71;"><i class="bi bi-question-circle-fill"></i> Need Help?</h3>
                    <p style="font-size: 1.1em; margin: 20px 0; line-height: 1.8;">
                        For technical support, feature requests, or feedback about the dashboard,<br>
                        please refer to the <strong>User Manual</strong> section or contact your system administrator.
                    </p>
                    <button onclick="showView('manual')" style="padding: 15px 35px; background: linear-gradient(135deg, #3a1c71 0%, #d76d77 100%); color: white; border: none; border-radius: 10px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                        <i class="bi bi-book-fill"></i> Open User Manual
                    </button>
                </div>
            `;
            
            document.getElementById('dashboardContent').innerHTML = aboutHTML;
            
            if (audioEnabled) {
                speak('About Dashboard view loaded. Learn about dashboard purpose, capabilities, and how to use it effectively.');
            }
        }

        // Export to Excel
        
        function exportToExcel() {
            try {
                speak('Exporting to Excel...');
                
                const wb = XLSX.utils.book_new();
                // Using global currentView variable
                
                // Sheet 1: Summary
                const summaryData = [
                    ['TAGGD SLA Performance Dashboard'],
                    ['Generated on', new Date().toLocaleString()],
                    [''],
                    ['Metric', 'FY 24-25', 'FY 25-26', 'Change'],
                ];
                
                const fy24Metrics = calculateOverallMetrics(filteredData.fy24_25, 'fy24_25');
                const fy25Metrics = calculateOverallMetrics(filteredData.fy25_26, 'fy25_26');
                const yoyChange = (fy25Metrics.compliance - fy24Metrics.compliance).toFixed(1);
                
                summaryData.push(
                    ['Compliance %', fy24Metrics.compliance + '%', fy25Metrics.compliance + '%', yoyChange + '%'],
                    ['Total SLAs', fy24Metrics.total, fy25Metrics.total, (fy25Metrics.total - fy24Metrics.total)],
                    ['SLAs Met', fy24Metrics.totalMet, fy25Metrics.totalMet, (fy25Metrics.totalMet - fy24Metrics.totalMet)],
                    ['SLAs Not Met', fy24Metrics.totalNotMet, fy25Metrics.totalNotMet, (fy25Metrics.totalNotMet - fy24Metrics.totalNotMet)]
                );
                
                const ws1 = XLSX.utils.aoa_to_sheet(summaryData);
                XLSX.utils.book_append_sheet(wb, ws1, 'Summary');
                
                // Sheet 2: Monthly Data
                const monthlyData = calculateMonthlyMetrics(filteredData.fy25_26, 'fy25_26');
                const monthlyArray = [['Month', 'Met', 'Not Met', 'Total', 'Compliance %']];
                monthlyData.forEach(m => {
                    monthlyArray.push([m.month, m.met, m.notMet, m.total, m.compliance + '%']);
                });
                const ws2 = XLSX.utils.aoa_to_sheet(monthlyArray);
                XLSX.utils.book_append_sheet(wb, ws2, 'Monthly');
                
                // Sheet 3: Account Data
                const accountData = calculateAccountMetrics(filteredData.fy25_26, 'fy25_26');
                accountData.sort((a, b) => b.compliance - a.compliance);
                const accountArray = [['Project', 'Region', 'Practice Head', 'Met', 'Not Met', 'Compliance %']];
                accountData.forEach(a => {
                    accountArray.push([a.account, a.region || 'N/A', a.practiceHead || 'N/A', a.met, a.notMet, a.compliance + '%']);
                });
                const ws3 = XLSX.utils.aoa_to_sheet(accountArray);
                XLSX.utils.book_append_sheet(wb, ws3, 'Accounts');
                
                // Export
                const filename = 'TAGGD_Dashboard_' + currentView + '_' + new Date().toISOString().split('T')[0] + '.xlsx';
                XLSX.writeFile(wb, filename);
                
                speak('Excel exported successfully!');
                alert('âœ… Excel exported successfully!');
                
            } catch (error) {
                console.error('Excel Export Error:', error);
                alert('âŒ Excel export failed: ' + error.message);
            }
        }


        // Export to PDF
        
        
        
        async function exportToPDF() {
            try {
                // Enhanced null safety checks
                if (!rawData || !filteredData) {
                    alert('âš ï¸ Please upload data first before exporting!');
                    return;
                }

                // Get current view from global currentView variable (defined at top of script)
                // This is set by showView() when user clicks menu items
                const activeView = currentView || 'overview';
                                
                // Use global currentView variable (set by showView function)
                // Fallback to 'overview' if not set
                // currentView is defined globally
                

                // Show loading
                const loadingDiv = document.createElement('div');
                loadingDiv.id = 'pdfLoading';
                loadingDiv.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px 50px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 10000; text-align: center;';
                loadingDiv.innerHTML = '<h3 style="color: #3a1c71; margin-bottom: 10px;">Generating PDF...</h3><p style="color: #666;">Please wait</p>';
                document.body.appendChild(loadingDiv);
                
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 15;
                const contentWidth = pageWidth - (2 * margin);
                
                let yPos = margin;
                
                // === HEADER ===
                pdf.setFillColor(58, 28, 113);
                pdf.rect(0, 0, pageWidth, 35, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(20);
                pdf.setFont('helvetica', 'bold');
                const viewNames = {
                    'overview': 'Overview',
                    'executive': 'Executive View',
                    'monthly': 'Monthly Trends',
                    'quarterly': 'Quarterly Analysis',
                    'yearly': 'Year-over-Year',
                    'account': 'Project Performance',
                    'region': 'Regional Analysis',
                    'practice': 'Practice Head Analysis',
                    'benchmarking': 'Competitive Benchmarking',
                    'notreported': 'Not Reported Analysis'
                };
                const viewTitle = viewNames[activeView] || 'Dashboard';
                pdf.text('TAGGD SLA Performance Dashboard - ' + viewTitle, pageWidth / 2, 15, { align: 'center' });
                pdf.setFontSize(10);
                pdf.setFont('helvetica', 'normal');
                const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                pdf.text('Generated on ' + today, pageWidth / 2, 25, { align: 'center' });
                
                yPos = 45;
                
                // === FILTERS INFO ===
                // Check ALL filter types including FY, month, region, practice, regional head, and accounts
                const hasFilters = activeFilters.fy !== 'all' || 
                                   (activeFilters.month && activeFilters.month !== 'all') ||
                                   activeFilters.region.length > 0 || 
                                   activeFilters.practice.length > 0 || 
                                   activeFilters.regionalHead.length > 0 ||
                                   activeFilters.account.length > 0;
                
                if (hasFilters) {
                    // Build comprehensive filter text
                    let filterLines = [];
                    
                    // FY Filter
                    if (activeFilters.fy !== 'all') {
                        filterLines.push('Fiscal Year: ' + activeFilters.fy);
                    }
                    
                    // Month Filter
                    if (activeFilters.month && activeFilters.month !== 'all') {
                        const monthFullName = getFullMonthName(activeFilters.month);
                        filterLines.push('Month: ' + monthFullName);
                    }
                    
                    // Region Filter
                    if (activeFilters.region.length > 0) {
                        const regionText = activeFilters.region.length <= 3 ? 
                            activeFilters.region.join(', ') : 
                            activeFilters.region.length + ' regions selected';
                        filterLines.push('Region: ' + regionText);
                    }
                    
                    // Practice Head Filter
                    if (activeFilters.practice.length > 0) {
                        const practiceText = activeFilters.practice.length <= 3 ? 
                            activeFilters.practice.join(', ') : 
                            activeFilters.practice.length + ' practice heads selected';
                        filterLines.push('Practice Head: ' + practiceText);
                    }
                    
                    // Regional Head Filter
                    if (activeFilters.regionalHead.length > 0) {
                        const regionalText = activeFilters.regionalHead.length <= 3 ? 
                            activeFilters.regionalHead.join(', ') : 
                            activeFilters.regionalHead.length + ' regional heads selected';
                        filterLines.push('Regional Head: ' + regionalText);
                    }
                    
                    // Project/Account Filter
                    if (activeFilters.account.length > 0) {
                        const accountText = activeFilters.account.length <= 3 ? 
                            activeFilters.account.join(', ') : 
                            activeFilters.account.length + ' projects selected';
                        filterLines.push('Projects: ' + accountText);
                    }
                    
                    // Calculate height needed for all filters
                    const filterBoxHeight = Math.max(20, 10 + (filterLines.length * 5));
                    
                    pdf.setFillColor(245, 247, 250);
                    pdf.roundedRect(margin, yPos, contentWidth, filterBoxHeight, 2, 2, 'F');
                    pdf.setDrawColor(58, 28, 113);
                    pdf.setLineWidth(0.3);
                    pdf.roundedRect(margin, yPos, contentWidth, filterBoxHeight, 2, 2, 'S');
                    pdf.setFontSize(10);
                    pdf.setFont('helvetica', 'bold');
                    pdf.setTextColor(58, 28, 113);
                    pdf.text('Active Filters:', margin + 3, yPos + 6);
                    pdf.setFont('helvetica', 'normal');
                    pdf.setFontSize(8);
                    pdf.setTextColor(80, 80, 80);
                    
                    // Print each filter on a separate line
                    let filterY = yPos + 12;
                    filterLines.forEach(line => {
                        pdf.text(line, margin + 3, filterY);
                        filterY += 5;
                    });
                    
                    yPos += filterBoxHeight + 5;
                } else {
                    pdf.setFontSize(9);
                    pdf.setTextColor(100, 100, 100);
                    pdf.text('Showing all data (no filters applied)', margin, yPos);
                    yPos += 10;
                }
                
                // === EXECUTIVE SUMMARY ===
                pdf.setFillColor(58, 28, 113);
                pdf.rect(margin, yPos, contentWidth, 8, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(12);
                pdf.setFont('helvetica', 'bold');
                pdf.text('Executive Summary', margin + 3, yPos + 6);
                yPos += 12;
                
                const fy24Metrics = calculateOverallMetrics(filteredData.fy24_25, 'fy24_25');
                const fy25Metrics = calculateOverallMetrics(filteredData.fy25_26, 'fy25_26');
                const yoyChange = (fy25Metrics.compliance - fy24Metrics.compliance).toFixed(1);
                
                // FY 24-25 Box
                const boxWidth = (contentWidth - 8) / 2;
                pdf.setFillColor(240, 248, 255);
                pdf.roundedRect(margin, yPos, boxWidth, 30, 3, 3, 'F');
                pdf.setDrawColor(58, 28, 113);
                pdf.setLineWidth(0.5);
                pdf.roundedRect(margin, yPos, boxWidth, 30, 3, 3, 'S');
                pdf.setTextColor(100, 100, 100);
                pdf.setFontSize(9);
                pdf.text('FY 24-25 COMPLIANCE', margin + 4, yPos + 7);
                pdf.setFontSize(16);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(58, 28, 113);
                pdf.text(fy24Metrics.compliance + '%', margin + 4, yPos + 17);
                pdf.setFontSize(8);
                pdf.setFont('helvetica', 'normal');
                pdf.setTextColor(120, 120, 120);
                pdf.text('Total: ' + fy24Metrics.total, margin + 4, yPos + 24);
                
                // FY 25-26 Box
                const box2X = margin + boxWidth + 8;
                pdf.setFillColor(255, 250, 240);
                pdf.roundedRect(box2X, yPos, boxWidth, 30, 3, 3, 'F');
                pdf.roundedRect(box2X, yPos, boxWidth, 30, 3, 3, 'S');
                pdf.setTextColor(100, 100, 100);
                pdf.setFontSize(9);
                pdf.text('FY 25-26 COMPLIANCE', box2X + 4, yPos + 7);
                pdf.setFontSize(16);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(215, 109, 119);
                pdf.text(fy25Metrics.compliance + '%', box2X + 4, yPos + 17);
                pdf.setFontSize(8);
                pdf.setFont('helvetica', 'normal');
                pdf.setTextColor(120, 120, 120);
                pdf.text('Total: ' + fy25Metrics.total, box2X + 4, yPos + 24);
                
                yPos += 35;
                
                // YoY Box
                const yoyColor = yoyChange >= 0 ? [16, 185, 129] : [239, 68, 68];
                pdf.setFillColor(yoyColor[0], yoyColor[1], yoyColor[2]);
                pdf.rect(margin, yPos, contentWidth, 18, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(10);
                pdf.setFont('helvetica', 'bold');
                pdf.text('YEAR-OVER-YEAR: ' + (yoyChange >= 0 ? '+' : '') + yoyChange + '%', margin + 4, yPos + 12);
                
                yPos += 23;
                
                // === CAPTURE CHARTS ===
                pdf.setFillColor(58, 28, 113);
                pdf.rect(margin, yPos, contentWidth, 8, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(12);
                pdf.setFont('helvetica', 'bold');
                pdf.text('Performance Charts', margin + 3, yPos + 6);
                yPos += 12;
                
                const contentArea = document.getElementById('dashboardContent');

                // Validate dashboardContent has content
                if (!contentArea || !contentArea.innerHTML || contentArea.innerHTML.trim() === '') {
                    document.body.removeChild(loadingDiv);
                    alert('âš ï¸ No content to export. Please select a view and ensure data is loaded.');
                    return;
                }
                                if (contentArea) {
                    const originalBg = contentArea.style.background;
                    contentArea.style.background = 'white';
                    

                console.log('PDF Export - Capturing view:', activeView);
                console.log('PDF Export - Content area:', contentArea ? contentArea.id : 'NOT FOUND');
                
                    // Enhanced PDF capture with better quality settings
                    const canvas = await html2canvas(contentArea, {
                        scale: 2,  // 2x resolution for balance between quality and file size
                        backgroundColor: '#ffffff',
                        logging: true,  // Enable logging to debug issues
                        useCORS: true,
                        allowTaint: true,
                        scrollY: 0,  // Start from top
                        scrollX: 0,
                        windowWidth: contentArea.scrollWidth,
                        windowHeight: contentArea.scrollHeight,
                        width: contentArea.scrollWidth,
                        height: contentArea.scrollHeight,
                        imageTimeout: 0,
                        removeContainer: false,
                        onclone: (clonedDoc) => {
                            // Ensure all images and styles are loaded in the cloned document
                            const clonedContent = clonedDoc.getElementById('dashboardContent');
                            if (clonedContent) {
                                clonedContent.style.transform = 'none';
                                clonedContent.style.overflow = 'visible';
                            }
                        }
                    });
                    
                    // Use PNG instead of JPEG for better quality (no compression artifacts)
                    const imgData = canvas.toDataURL('image/png', 1.0);
                    const imgWidth = contentWidth;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    let heightLeft = imgHeight;
                    let position = yPos;
                    
                    if (heightLeft <= pageHeight - position - margin) {
                        pdf.addImage(imgData, 'PNG', margin, position, imgWidth, imgHeight, '', 'FAST');
                    } else {
                        const firstPageHeight = pageHeight - position - margin;
                        pdf.addImage(imgData, 'PNG', margin, position, imgWidth, firstPageHeight, '', 'FAST');
                        heightLeft -= firstPageHeight;
                        
                        while (heightLeft > 0) {
                            pdf.addPage();
                            position = margin;
                            const nextHeight = Math.min(heightLeft, pageHeight - 2 * margin);
                            pdf.addImage(imgData, 'PNG', margin, position, imgWidth, nextHeight, '', 'FAST');
                            heightLeft -= nextHeight;
                        }
                    }
                    
                    contentArea.style.background = originalBg;
                }
                
                // === NEW PAGE: DATA TABLES ===
                pdf.addPage();
                yPos = margin;
                
                // Header
                pdf.setFillColor(58, 28, 113);
                pdf.rect(0, 0, pageWidth, 25, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(16);
                pdf.setFont('helvetica', 'bold');
                pdf.text('Data Tables', pageWidth / 2, 15, { align: 'center' });
                yPos = 35;
                
                // Monthly Table
                pdf.setFillColor(58, 28, 113);
                pdf.rect(margin, yPos, contentWidth, 8, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(11);
                pdf.text('Monthly Performance', margin + 3, yPos + 6);
                yPos += 10;
                
                const monthlyData = calculateMonthlyMetrics(filteredData.fy25_26, 'fy25_26');
                const colWidth = contentWidth / 5;
                
                // Table header
                pdf.setFillColor(58, 28, 113);
                pdf.rect(margin, yPos, contentWidth, 7, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(8);
                pdf.setFont('helvetica', 'bold');
                pdf.text('Month', margin + 2, yPos + 5);
                pdf.text('Met', margin + colWidth + 2, yPos + 5);
                pdf.text('Not Met', margin + 2 * colWidth + 2, yPos + 5);
                pdf.text('Total', margin + 3 * colWidth + 2, yPos + 5);
                pdf.text('Compliance', margin + 4 * colWidth + 2, yPos + 5);
                yPos += 7;
                
                // Table rows
                pdf.setFont('helvetica', 'normal');
                pdf.setTextColor(60, 60, 60);
                monthlyData.forEach((row, i) => {
                    if (i % 2 === 0) {
                        pdf.setFillColor(248, 249, 250);
                        pdf.rect(margin, yPos, contentWidth, 6, 'F');
                    }
                    pdf.text(row.month, margin + 2, yPos + 4);
                    pdf.text(String(row.met), margin + colWidth + 2, yPos + 4);
                    pdf.text(String(row.notMet), margin + 2 * colWidth + 2, yPos + 4);
                    pdf.text(String(row.total), margin + 3 * colWidth + 2, yPos + 4);
                    pdf.text(row.compliance + '%', margin + 4 * colWidth + 2, yPos + 4);
                    yPos += 6;
                });
                
                // === FOOTER ===
                const pageCount = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= pageCount; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(8);
                    pdf.setTextColor(150, 150, 150);
                    pdf.text('Page ' + i + ' of ' + pageCount, pageWidth / 2, pageHeight - 8, { align: 'center' });
                    pdf.text('TAGGD Dashboard - Confidential', margin, pageHeight - 8);
                }
                
                // Save
                // Using global currentView variable
                const filename = 'TAGGD_Dashboard_' + activeView + '_' + new Date().toISOString().split('T')[0] + '.pdf';
                pdf.save(filename);
                
                document.body.removeChild(loadingDiv);
                alert('âœ… PDF exported successfully!');
                
            } catch (error) {
                console.error('PDF Export Error:', error);
                const loading = document.getElementById('pdfLoading');
                if (loading) document.body.removeChild(loading);
                alert('âŒ PDF export failed: ' + error.message);
            }
        }



    

        // Export Modal Functions
        function openExportModal() {
            document.getElementById('exportModal').style.display = 'block';
            speak('Export modal opened. Please select your export options.');
        }

        function closeExportModal() {
            document.getElementById('exportModal').style.display = 'none';
        }

        // Export to Word (HTML format)
        function exportToWord() {
            if (!rawData) {
                alert('Please load data first!');
                return;
            }
            
            const view = document.getElementById('exportView')?.value || 'current';
            if (view !== 'current') {
                showView(view);
                setTimeout(() => exportToWordActual(), 500);
            } else {
                exportToWordActual();
            }
        }

        function exportToWordActual() {
            // Using global currentView variable

            const includeCharts = document.getElementById('includeCharts').checked;
            const includeTables = document.getElementById('includeTables').checked;
            const includeInsights = document.getElementById('includeInsights').checked;
            
            let content = document.getElementById('dashboardContent').cloneNode(true);
            
            if (!includeCharts) {
                content.querySelectorAll('.chart-container').forEach(el => el.remove());
            }
            if (!includeTables) {
                content.querySelectorAll('table').forEach(el => el.remove());
            }
            if (!includeInsights) {
                content.querySelectorAll('.insights-section').forEach(el => el.remove());
            }
            
            const html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="utf-8">
                    <title>TAGGD SLA Dashboard Export</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1, h2, h3 { color: #FF6B35; }
                        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #FF6B35; color: white; }
                        .card { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
                    </style>
                </head>
                <body>
                    <h1>TAGGD SLA Performance Dashboard</h1>
                    <p>Generated on: ${new Date().toLocaleString()}</p>
                    ${content.innerHTML}
                </body>
                </html>
            `;
            
            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `TAGGD_Dashboard_${currentView}_${Date.now()}.doc`;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('âœ“ Word export completed!');
            speak('Word export completed successfully');
            closeExportModal();
        }

        // Export to PPT (HTML format that PowerPoint can open)
        function exportToPPT() {
            if (!rawData) {
                alert('Please load data first!');
                return;
            }
            
            showToast('ðŸ“Š Generating PowerPoint... Please wait');
            speak('Generating PowerPoint presentation');
            
            const view = document.getElementById('exportView')?.value || 'current';
            if (view !== 'current') {
                showView(view);
                setTimeout(() => exportToPPTActual(), 500);
            } else {
                exportToPPTActual();
            }
        }

        async function exportToPPTActual() {
            try {
                console.log('=== PPT Export Started ===');
                console.log('Current view:', currentView);
                console.log('Filtered data:', filteredData);
                
                // Validate data is loaded
                if (!filteredData || !filteredData.fy24_25 || !filteredData.fy25_26) {
                    throw new Error('No data loaded. Please upload Excel file first.');
                }
                
                // Validate PptxGenJS is loaded
                if (typeof PptxGenJS === 'undefined') {
                    throw new Error('PptxGenJS library not loaded. Please refresh the page.');
                }
                
                showToast('ðŸ”„ Generating PowerPoint presentation...', 'info');
                
                // Create new presentation with proper PowerPoint 2017+ format
                const pptx = new PptxGenJS();
                
                // Set presentation metadata
                pptx.author = 'TAGGD SLA Dashboard';
                pptx.company = 'TAGGD';
                pptx.subject = 'SLA Performance Report';
                pptx.title = `TAGGD SLA Dashboard - ${currentView.toUpperCase()}`;
                
                // Define TAGGD brand colors
                const brandColors = {
                    purple: '3a1c71',
                    pink: 'd76d77',
                    orange: 'ffaf7b',
                    white: 'ffffff',
                    dark: '333333',
                    green: '10b981',
                    amber: 'f59e0b',
                    red: 'ef4444'
                };
                
                // ========== SLIDE 1: Title Slide ==========
                const titleSlide = pptx.addSlide();
                titleSlide.background = { fill: brandColors.white };
                
                // Add gradient rectangle for header
                titleSlide.addShape(pptx.ShapeType.rect, {
                    x: 0, y: 0, w: '100%', h: 2.5,
                    fill: { type: 'solid', color: brandColors.purple }
                });
                
                titleSlide.addText('TAGGD SLA Performance Dashboard', {
                    x: 0.5, y: 0.7, w: 9, h: 1,
                    fontSize: 44, bold: true, color: brandColors.white,
                    align: 'center'
                });
                
                titleSlide.addText(currentView.toUpperCase() + ' VIEW', {
                    x: 0.5, y: 1.8, w: 9, h: 0.5,
                    fontSize: 28, color: brandColors.orange,
                    align: 'center'
                });
                
                // Add filters information - Get current filter values
                const filterInfo = [];
                const selectedRegionalHeads = $('#regionalHeadFilter').val() || [];
                const selectedRegions = $('#regionFilter').val() || [];
                const selectedPracticeHeads = $('#practiceFilter').val() || [];
                const selectedAccounts = $('#accountFilter').val() || [];
                
                if (selectedRegionalHeads.length > 0) filterInfo.push(`Regional Heads: ${selectedRegionalHeads.join(', ')}`);
                if (selectedRegions.length > 0) filterInfo.push(`Regions: ${selectedRegions.join(', ')}`);
                if (selectedPracticeHeads.length > 0) filterInfo.push(`Practice Heads: ${selectedPracticeHeads.join(', ')}`);
                if (selectedAccounts.length > 0) filterInfo.push(`Projects: ${selectedAccounts.join(', ')}`);
                
                if (filterInfo.length > 0) {
                    titleSlide.addText('Applied Filters:', {
                        x: 1, y: 3.5, w: 8, h: 0.4,
                        fontSize: 16, bold: true, color: brandColors.dark
                    });
                    titleSlide.addText(filterInfo.join(' | '), {
                        x: 1, y: 4, w: 8, h: 0.6,
                        fontSize: 14, color: brandColors.dark
                    });
                }
                
                titleSlide.addText(`Generated on: ${new Date().toLocaleString()}`, {
                    x: 0.5, y: 6.8, w: 9, h: 0.4,
                    fontSize: 12, color: '666666', align: 'center', italic: true
                });
                
                // ========== SLIDE 2: Dashboard Screenshot ==========
                const element = document.getElementById('dashboardContent');
                const canvas = await html2canvas(element, {
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    backgroundColor: '#ffffff'
                });
                
                const imgData = canvas.toDataURL('image/png');
                
                const screenshotSlide = pptx.addSlide();
                screenshotSlide.background = { fill: brandColors.white };
                
                screenshotSlide.addText('Dashboard Overview', {
                    x: 0.5, y: 0.3, w: 9, h: 0.5,
                    fontSize: 28, bold: true, color: brandColors.purple
                });
                
                screenshotSlide.addImage({
                    data: imgData,
                    x: 0.3, y: 1, w: 9.4, h: 6.2,
                    sizing: { type: 'contain', w: 9.4, h: 6.2 }
                });
                
                // ========== SLIDE 3: Key Metrics (if available) ==========
                const metricsSlide = pptx.addSlide();
                metricsSlide.background = { fill: brandColors.white };
                
                metricsSlide.addText('Key Performance Metrics', {
                    x: 0.5, y: 0.3, w: 9, h: 0.5,
                    fontSize: 28, bold: true, color: brandColors.purple
                });
                
                // Calculate metrics based on current view
                const fy24Metrics = calculateOverallMetrics(filteredData.fy24_25, 'fy24_25');
                const fy25Metrics = calculateOverallMetrics(filteredData.fy25_26, 'fy25_26');
                
                // Ensure metrics have default values if undefined
                fy24Metrics.overall = fy24Metrics.compliance || fy24Metrics.overall || 0;
                fy25Metrics.overall = fy25Metrics.compliance || fy25Metrics.overall || 0;
                fy24Metrics.totalTickets = fy24Metrics.total || fy24Metrics.totalTickets || 0;
                fy25Metrics.totalTickets = fy25Metrics.total || fy25Metrics.totalTickets || 0;
                fy24Metrics.metTickets = fy24Metrics.totalMet || fy24Metrics.metTickets || 0;
                fy25Metrics.metTickets = fy25Metrics.totalMet || fy25Metrics.metTickets || 0;
                fy24Metrics.notMetTickets = fy24Metrics.totalNotMet || fy24Metrics.notMetTickets || 0;
                fy25Metrics.notMetTickets = fy25Metrics.totalNotMet || fy25Metrics.notMetTickets || 0;
                
                // Create metrics table
                const metricsTableData = [
                    [
                        { text: 'Metric', options: { bold: true, fill: brandColors.purple, color: brandColors.white } },
                        { text: 'FY 24-25', options: { bold: true, fill: brandColors.purple, color: brandColors.white } },
                        { text: 'FY 25-26', options: { bold: true, fill: brandColors.purple, color: brandColors.white } },
                        { text: 'Change', options: { bold: true, fill: brandColors.purple, color: brandColors.white } }
                    ],
                    [
                        'Overall Compliance',
                        `${fy24Metrics.overall}%`,
                        `${fy25Metrics.overall}%`,
                        `${(fy25Metrics.overall - fy24Metrics.overall).toFixed(1)}%`
                    ],
                    [
                        'Total Tickets',
                        `${fy24Metrics.totalTickets.toLocaleString()}`,
                        `${fy25Metrics.totalTickets.toLocaleString()}`,
                        fy24Metrics.totalTickets > 0 ? `${((fy25Metrics.totalTickets - fy24Metrics.totalTickets) / fy24Metrics.totalTickets * 100).toFixed(1)}%` : 'N/A'
                    ],
                    [
                        'Tickets Met SLA',
                        `${fy24Metrics.metTickets.toLocaleString()}`,
                        `${fy25Metrics.metTickets.toLocaleString()}`,
                        `${fy25Metrics.metTickets - fy24Metrics.metTickets > 0 ? '+' : ''}${(fy25Metrics.metTickets - fy24Metrics.metTickets).toLocaleString()}`
                    ],
                    [
                        'Tickets Not Met SLA',
                        `${fy24Metrics.notMetTickets.toLocaleString()}`,
                        `${fy25Metrics.notMetTickets.toLocaleString()}`,
                        `${fy25Metrics.notMetTickets - fy24Metrics.notMetTickets > 0 ? '+' : ''}${(fy25Metrics.notMetTickets - fy24Metrics.notMetTickets).toLocaleString()}`
                    ]
                ];
                
                metricsSlide.addTable(metricsTableData, {
                    x: 1, y: 1.2, w: 8, h: 4,
                    fontSize: 14,
                    border: { type: 'solid', pt: 1, color: 'cccccc' },
                    align: 'center',
                    valign: 'middle'
                });
                
                // ========== SLIDE 4: RAG Status Distribution ==========
                const ragSlide = pptx.addSlide();
                ragSlide.background = { fill: brandColors.white };
                
                ragSlide.addText('RAG Status Distribution', {
                    x: 0.5, y: 0.3, w: 9, h: 0.5,
                    fontSize: 28, bold: true, color: brandColors.purple
                });
                
                // Create RAG table
                const ragTableData = [
                    [
                        { text: 'Status', options: { bold: true, fill: brandColors.purple, color: brandColors.white } },
                        { text: 'FY 24-25', options: { bold: true, fill: brandColors.purple, color: brandColors.white } },
                        { text: 'FY 25-26', options: { bold: true, fill: brandColors.purple, color: brandColors.white } }
                    ],
                    [
                        { text: 'Green (â‰¥75%)', options: { fill: brandColors.green, color: brandColors.white, bold: true } },
                        `${fy24Metrics.greenCount} accounts`,
                        `${fy25Metrics.greenCount} accounts`
                    ],
                    [
                        { text: 'Amber (50-74%)', options: { fill: brandColors.amber, color: brandColors.white, bold: true } },
                        `${fy24Metrics.amberCount} accounts`,
                        `${fy25Metrics.amberCount} accounts`
                    ],
                    [
                        { text: 'Red (<50%)', options: { fill: brandColors.red, color: brandColors.white, bold: true } },
                        `${fy24Metrics.redCount} accounts`,
                        `${fy25Metrics.redCount} accounts`
                    ]
                ];
                
                ragSlide.addTable(ragTableData, {
                    x: 2, y: 1.5, w: 6, h: 3,
                    fontSize: 16,
                    border: { type: 'solid', pt: 1, color: 'cccccc' },
                    align: 'center',
                    valign: 'middle'
                });
                
                // ========== SLIDE 5: Summary & Recommendations ==========
                const summarySlide = pptx.addSlide();
                summarySlide.background = { fill: brandColors.white };
                
                summarySlide.addText('Summary & Key Insights', {
                    x: 0.5, y: 0.3, w: 9, h: 0.5,
                    fontSize: 28, bold: true, color: brandColors.purple
                });
                
                const complianceChange = fy25Metrics.overall - fy24Metrics.overall;
                const trend = complianceChange > 0 ? 'ðŸ“ˆ Improving' : complianceChange < 0 ? 'ðŸ“‰ Declining' : 'âž¡ï¸ Stable';
                
                const summaryPoints = [
                    `â€¢ Overall SLA Compliance: ${fy25Metrics.overall}% (${complianceChange > 0 ? '+' : ''}${complianceChange.toFixed(1)}% YoY)`,
                    `â€¢ Trend: ${trend}`,
                    `â€¢ Total Tickets Processed: ${fy25Metrics.totalTickets.toLocaleString()}`,
                    `â€¢ Green Status Accounts: ${fy25Metrics.greenCount} (${((fy25Metrics.greenCount / (fy25Metrics.greenCount + fy25Metrics.amberCount + fy25Metrics.redCount)) * 100).toFixed(1)}%)`,
                    `â€¢ Amber Status Accounts: ${fy25Metrics.amberCount}`,
                    `â€¢ Red Status Accounts: ${fy25Metrics.redCount} (requires attention)`,
                    ``,
                    `Key Recommendations:`,
                    `â€¢ Focus on ${fy25Metrics.redCount} accounts in Red status`,
                    `â€¢ Monitor ${fy25Metrics.amberCount} accounts in Amber to prevent decline`,
                    `â€¢ Analyze best practices from top-performing accounts`,
                    `â€¢ Review resource allocation for consistently underperforming teams`
                ];
                
                summarySlide.addText(summaryPoints.join('\n'), {
                    x: 1, y: 1.2, w: 8, h: 5.5,
                    fontSize: 14, color: brandColors.dark,
                    lineSpacing: 20
                });
                
                // Save the presentation
                const fileName = `TAGGD_Dashboard_${currentView}_${Date.now()}.pptx`;
                await pptx.writeFile({ fileName: fileName });
                
                showToast('âœ“ PowerPoint export completed!');
                speak('PowerPoint export completed successfully');
                closeExportModal();
                
            } catch (error) {
                console.error('=== PPT Export Error ===');
                console.error('Error type:', error.name);
                console.error('Error message:', error.message);
                console.error('Error stack:', error.stack);
                console.error('PptxGenJS available:', typeof PptxGenJS !== 'undefined');
                
                const errorMsg = `PowerPoint export failed!\n\nError: ${error.message}\n\nPlease check:\n1. Browser console for detailed errors\n2. Data is loaded\n3. No popup blocker is active`;
                alert(errorMsg);
                showToast('âŒ PowerPoint export failed', 'error');
            }
        }


        // ==================== DRILL-DOWN FUNCTIONALITY ====================
        
        // Open drill-down modal
        function openDrilldown(content) {
            const modal = document.getElementById('drilldownModal');
            const body = document.getElementById('drilldownBody');
            body.innerHTML = content;
            modal.style.display = 'block';
            
            // Animate entrance
            setTimeout(() => {
                modal.style.opacity = '1';
            }, 10);
        }

        // Close drill-down modal
        function closeDrilldown() {
            const modal = document.getElementById('drilldownModal');
            modal.style.display = 'none';
        }

        // Close on outside click
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('drilldownModal');
            if (event.target === modal) {
                closeDrilldown();
            }
        });

        // Drill-Down: FY 24-25 Compliance â†’ Monthly Breakdown
        function drilldownFY2425() {
            const monthlyData = calculateMonthlyMetrics(filteredData.fy24_25, 'fy24_25');
            
            let tableHTML = `
                <div class="drilldown-header">
                    <h2>ðŸ“Š FY 24-25 Monthly Compliance Breakdown</h2>
                    <p>Detailed month-by-month performance analysis</p>
                </div>
                <div class="breadcrumb">
                    <a href="#" onclick="closeDrilldown(); return false;">Overview</a> â†’ 
                    <span>FY 24-25 Details</span>
                </div>
                <table class="drilldown-table">
                    <thead>
                        <tr>
                            <th>Month</th>
                            <th>Met</th>
                            <th>Not Met</th>
                            <th>Total</th>
                            <th>Compliance %</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            monthlyData.forEach(month => {
                const status = month.compliance >= 75 ? 'high' : month.compliance >= 50 ? 'medium' : 'low';
                const icon = month.compliance >= 75 ? 'âœ…' : month.compliance >= 50 ? 'âš ï¸' : 'âŒ';
                
                tableHTML += `
                    <tr>
                        <td><strong>${month.month}</strong></td>
                        <td>${month.met}</td>
                        <td>${month.notMet}</td>
                        <td>${month.total}</td>
                        <td><span class="drilldown-metric ${status}">${month.compliance}%</span></td>
                        <td>${icon}</td>
                    </tr>
                `;
            });
            
            const bestMonth = monthlyData.reduce((best, current) => 
                parseFloat(current.compliance) > parseFloat(best.compliance) ? current : best
            );
            const worstMonth = monthlyData.reduce((worst, current) => 
                parseFloat(current.compliance) < parseFloat(worst.compliance) ? current : worst
            );
            const avgCompliance = (monthlyData.reduce((acc, m) => acc + parseFloat(m.compliance), 0) / monthlyData.length).toFixed(1);
            
            tableHTML += `
                    </tbody>
                </table>
                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h4>ðŸ“ˆ Key Insights:</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Best Month:</strong> ${bestMonth.month} with ${bestMonth.compliance}% compliance</li>
                        <li><strong>Needs Improvement:</strong> ${worstMonth.month} with ${worstMonth.compliance}% compliance</li>
                        <li><strong>Average Compliance:</strong> ${avgCompliance}%</li>
                    </ul>
                </div>
            `;
            
            openDrilldown(tableHTML);
        }

        // Drill-Down: FY 25-26 Compliance â†’ Account Breakdown
        function drilldownFY2526() {
            const accountData = calculateAccountMetrics(filteredData.fy25_26, 'fy25_26');
            
            let tableHTML = `
                <div class="drilldown-header">
                    <h2>ðŸ¢ FY 25-26 Account-Level Compliance</h2>
                    <p>Individual project performance breakdown</p>
                </div>
                <div class="breadcrumb">
                    <a href="#" onclick="closeDrilldown(); return false;">Overview</a> â†’ 
                    <span>FY 25-26 Project Details</span>
                </div>
                <table class="drilldown-table">
                    <thead>
                        <tr>
                            <th>Account</th>
                            <th>Region</th>
                            <th>Practice Head</th>
                            <th>Met</th>
                            <th>Not Met</th>
                            <th>Compliance %</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            accountData.sort((a, b) => b.compliance - a.compliance);
            
            accountData.forEach(account => {
                const status = account.compliance >= 75 ? 'high' : account.compliance >= 50 ? 'medium' : 'low';
                const icon = account.compliance >= 75 ? 'ðŸŒŸ' : account.compliance >= 50 ? 'âš ï¸' : 'ðŸ”´';
                
                tableHTML += `
                    <tr onclick="drilldownAccount('${account.account}')" style="cursor: pointer;" title="Click for detailed account analysis">
                        <td><strong>${account.account}</strong> ðŸ”</td>
                        <td>${account.region || 'N/A'}</td>
                        <td>${account.practiceHead || 'N/A'}</td>
                        <td>${account.met}</td>
                        <td>${account.notMet}</td>
                        <td><span class="drilldown-metric ${status}">${account.compliance}%</span></td>
                        <td>${icon}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h4>ðŸŽ¯ Performance Summary:</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Top Performer:</strong> ${accountData[0].account} (${accountData[0].compliance}%)</li>
                        <li><strong>Needs Attention:</strong> ${accountData[accountData.length-1].account} (${accountData[accountData.length-1].compliance}%)</li>
                        <li><strong>Accounts Above 75%:</strong> ${accountData.filter(a => a.compliance >= 75).length} of ${accountData.length}</li>
                        <li><strong>Accounts Below 50%:</strong> ${accountData.filter(a => a.compliance < 50).length} accounts require immediate action</li>
                    </ul>
                    <p style="margin-top: 15px; font-style: italic; color: #666;">ðŸ’¡ Tip: Click on any account row to see month-by-month details</p>
                </div>
            `;
            
            openDrilldown(tableHTML);
        }

        // Drill-Down: Individual Project Details
        function drilldownAccount(accountName) {
            const accountDataFY25 = filteredData.fy25_26.filter(row => row.Project === accountName)[0];
            
            if (!accountDataFY25) {
                alert('Account data not found');
                return;
            }
            
            const months = ['Apr', 'May', 'June', 'July', 'Aug', 'Sep'];
            
            let tableHTML = `
                <div class="drilldown-header">
                    <h2>ðŸ¢ ${accountName} - Detailed Analysis</h2>
                    <p>Complete performance overview and trends</p>
                </div>
                <div class="breadcrumb">
                    <a href="#" onclick="closeDrilldown(); return false;">Overview</a> â†’ 
                    <a href="#" onclick="drilldownFY2526(); return false;">FY 25-26 Accounts</a> â†’ 
                    <span>${accountName}</span>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    <div style="background: linear-gradient(135deg, #3a1c71, #d76d77); color: white; padding: 20px; border-radius: 10px;">
                        <div style="font-size: 0.9em; opacity: 0.9;">Region</div>
                        <div style="font-size: 1.5em; font-weight: bold; margin-top: 5px;">${accountDataFY25.Region || 'N/A'}</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #d76d77, #ffaf7b); color: white; padding: 20px; border-radius: 10px;">
                        <div style="font-size: 0.9em; opacity: 0.9;">Practice Head</div>
                        <div style="font-size: 1.5em; font-weight: bold; margin-top: 5px;">${accountDataFY25['Practice Head'] || 'N/A'}</div>
                    </div>
                </div>
                
                <h3 style="margin-top: 30px;">ðŸ“… Monthly Performance (FY 25-26)</h3>
                <table class="drilldown-table">
                    <thead>
                        <tr>
                            <th>Month</th>
                            <th>Met</th>
                            <th>Not Met</th>
                            <th>Total</th>
                            <th>Compliance %</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            months.forEach(month => {
                const met = getMonthData(accountDataFY25, month, 'fy25_26', 'Met');
                const notMet = getMonthData(accountDataFY25, month, 'fy25_26', 'Not_Met');
                const total = met + notMet;
                const compliance = total > 0 ? ((met / total) * 100).toFixed(1) : 0;
                const status = compliance >= 75 ? 'high' : compliance >= 50 ? 'medium' : 'low';
                const icon = compliance >= 75 ? 'âœ…' : compliance >= 50 ? 'âš ï¸' : 'âŒ';
                
                tableHTML += `
                    <tr>
                        <td><strong>${month}</strong></td>
                        <td>${met}</td>
                        <td>${notMet}</td>
                        <td>${total}</td>
                        <td><span class="drilldown-metric ${status}">${compliance}%</span></td>
                        <td>${icon}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            openDrilldown(tableHTML);
        }

        // Drill-Down: SLAs Met â†’ Regional Distribution
        function drilldownSLAsMet() {
            const regionData = calculateRegionMetrics(filteredData.fy25_26, 'fy25_26');
            
            let tableHTML = `
                <div class="drilldown-header">
                    <h2>ðŸŒ Regional SLA Distribution (FY 25-26)</h2>
                    <p>How SLAs are distributed across regions</p>
                </div>
                <div class="breadcrumb">
                    <a href="#" onclick="closeDrilldown(); return false;">Overview</a> â†’ 
                    <span>Regional SLA Distribution</span>
                </div>
                <table class="drilldown-table">
                    <thead>
                        <tr>
                            <th>Region</th>
                            <th>Total SLAs</th>
                            <th>Met</th>
                            <th>Not Met</th>
                            <th>Compliance %</th>
                            <th>Accounts</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            regionData.sort((a, b) => b.compliance - a.compliance);
            
            regionData.forEach(region => {
                const status = region.compliance >= 75 ? 'high' : region.compliance >= 50 ? 'medium' : 'low';
                const icon = region.compliance >= 75 ? 'ðŸŒŸ' : region.compliance >= 50 ? 'âš ï¸' : 'ðŸ”´';
                const accountCount = filteredData.fy25_26.filter(row => row.Region === region.region).length;
                
                tableHTML += `
                    <tr onclick="drilldownRegion('${region.region}')" style="cursor: pointer;" title="Click for regional details">
                        <td><strong>${region.region}</strong> ðŸ”</td>
                        <td>${region.total}</td>
                        <td>${region.met}</td>
                        <td>${region.notMet}</td>
                        <td><span class="drilldown-metric ${status}">${region.compliance}%</span></td>
                        <td>${accountCount}</td>
                        <td>${icon}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h4>ðŸŽ¯ Regional Insights:</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Best Region:</strong> ${regionData[0].region} with ${regionData[0].compliance}% compliance</li>
                        <li><strong>Needs Focus:</strong> ${regionData[regionData.length-1].region} at ${regionData[regionData.length-1].compliance}%</li>
                        <li><strong>Total Regions:</strong> ${regionData.length} active regions</li>
                        <li><strong>High Performers:</strong> ${regionData.filter(r => r.compliance >= 75).length} regions above 75%</li>
                    </ul>
                    <p style="margin-top: 15px; font-style: italic; color: #666;">ðŸ’¡ Tip: Click on any region to see accounts in that region</p>
                </div>
            `;
            
            openDrilldown(tableHTML);
        }

        // Drill-Down: YoY Change â†’ Quarterly Analysis
        function drilldownYoY() {
            const q1FY24 = calculateQuarterlyMetrics(filteredData.fy24_25, 'fy24_25', 'Q1');
            const q2FY24 = calculateQuarterlyMetrics(filteredData.fy24_25, 'fy24_25', 'Q2');
            const q1FY25 = calculateQuarterlyMetrics(filteredData.fy25_26, 'fy25_26', 'Q1');
            
            let tableHTML = `
                <div class="drilldown-header">
                    <h2>ðŸ“ˆ Quarter-over-Quarter YoY Analysis</h2>
                    <p>Detailed quarterly performance comparison</p>
                </div>
                <div class="breadcrumb">
                    <a href="#" onclick="closeDrilldown(); return false;">Overview</a> â†’ 
                    <span>YoY Quarterly Details</span>
                </div>
                <table class="drilldown-table">
                    <thead>
                        <tr>
                            <th>Quarter</th>
                            <th>Met</th>
                            <th>Not Met</th>
                            <th>Total</th>
                            <th>Compliance %</th>
                            <th>QoQ Change</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            const quarters = [
                { name: 'Q1 FY 24-25', data: q1FY24, prev: null },
                { name: 'Q2 FY 24-25', data: q2FY24, prev: q1FY24 },
                { name: 'Q1 FY 25-26', data: q1FY25, prev: q2FY24 }
            ];
            
            quarters.forEach(q => {
                const status = q.data.compliance >= 75 ? 'high' : q.data.compliance >= 50 ? 'medium' : 'low';
                const icon = q.data.compliance >= 75 ? 'âœ…' : q.data.compliance >= 50 ? 'âš ï¸' : 'âŒ';
                const qoqChange = q.prev ? (q.data.compliance - q.prev.compliance).toFixed(1) : 'N/A';
                const qoqIcon = qoqChange !== 'N/A' ? (qoqChange >= 0 ? 'ðŸ“ˆ' : 'ðŸ“‰') : '';
                
                tableHTML += `
                    <tr>
                        <td><strong>${q.name}</strong></td>
                        <td>${q.data.totalMet}</td>
                        <td>${q.data.totalNotMet}</td>
                        <td>${q.data.total}</td>
                        <td><span class="drilldown-metric ${status}">${q.data.compliance}%</span></td>
                        <td>${qoqChange !== 'N/A' ? qoqChange + '%' : 'N/A'} ${qoqIcon}</td>
                        <td>${icon}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h4>ðŸ“Š YoY Quarterly Insights:</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Overall YoY Change:</strong> ${(q1FY25.compliance - q1FY24.compliance).toFixed(1)}% (${q1FY25.compliance >= q1FY24.compliance ? 'Improvement' : 'Decline'})</li>
                        <li><strong>Best Quarter:</strong> ${quarters.reduce((best, q) => q.data.compliance > best.data.compliance ? q : best).name}</li>
                    </ul>
                </div>
            `;
            
            openDrilldown(tableHTML);
        }

        // Drill-Down: Region Details
        function drilldownRegion(regionName) {
            const regionAccounts = filteredData.fy25_26.filter(row => row.Region === regionName);
            
            let tableHTML = `
                <div class="drilldown-header">
                    <h2>ðŸŒ ${regionName} - Project Details</h2>
                    <p>All accounts in this region</p>
                </div>
                <div class="breadcrumb">
                    <a href="#" onclick="closeDrilldown(); return false;">Overview</a> â†’ 
                    <a href="#" onclick="drilldownSLAsMet(); return false;">Regional Distribution</a> â†’ 
                    <span>${regionName}</span>
                </div>
                <table class="drilldown-table">
                    <thead>
                        <tr>
                            <th>Account</th>
                            <th>Practice Head</th>
                            <th>Met</th>
                            <th>Not Met</th>
                            <th>Compliance %</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            const accountMetrics = calculateAccountMetrics(regionAccounts, 'fy25_26');
            accountMetrics.sort((a, b) => b.compliance - a.compliance);
            
            accountMetrics.forEach(account => {
                const status = account.compliance >= 75 ? 'high' : account.compliance >= 50 ? 'medium' : 'low';
                const icon = account.compliance >= 75 ? 'ðŸŒŸ' : account.compliance >= 50 ? 'âš ï¸' : 'ðŸ”´';
                
                tableHTML += `
                    <tr onclick="drilldownAccount('${account.account}')" style="cursor: pointer;">
                        <td><strong>${account.account}</strong> ðŸ”</td>
                        <td>${account.practiceHead}</td>
                        <td>${account.met}</td>
                        <td>${account.notMet}</td>
                        <td><span class="drilldown-metric ${status}">${account.compliance}%</span></td>
                        <td>${icon}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            openDrilldown(tableHTML);
        }

        // Helper: Calculate monthly metrics
        function calculateMonthlyMetrics(data, fyKey) {
            // Dynamically extract available months from the data
            const months = extractMonthsFromData(
                fyKey === 'fy24_25' ? data : null,
                fyKey === 'fy25_26' ? data : null
            );
            
            return months.map(month => {
                let met = 0, notMet = 0;
                data.forEach(row => {
                    met += getMonthData(row, month, fyKey, 'Met');
                    notMet += getMonthData(row, month, fyKey, 'Not_Met');
                });
                const total = met + notMet;
                return {
                    month,
                    met,
                    notMet,
                    total,
                    compliance: total > 0 ? ((met / total) * 100).toFixed(1) : 0
                };
            });
        }

        // Helper: Calculate account metrics
        function calculateAccountMetrics(data, fyKey) {
            return data.map(row => {
                // Dynamically extract available months
                const months = extractMonthsFromData(
                    fyKey === 'fy24_25' ? [row] : null,
                    fyKey === 'fy25_26' ? [row] : null
                );
                let met = 0, notMet = 0;
                
                months.forEach(month => {
                    met += getMonthData(row, month, fyKey, 'Met');
                    notMet += getMonthData(row, month, fyKey, 'Not_Met');
                });
                
                const total = met + notMet;
                return {
                    account: row.Project,
                    region: row.Region,
                    practiceHead: row['Practice Head'],
                    met,
                    notMet,
                    total,
                    compliance: total > 0 ? ((met / total) * 100).toFixed(1) : 0
                };
            });
        }

        // Helper: Calculate region metrics
        function calculateRegionMetrics(data, fyKey) {
            const regions = [...new Set(data.map(row => row.Region))];
            
            return regions.map(region => {
                const regionData = data.filter(row => row.Region === region);
                // Dynamically extract available months
                const months = extractMonthsFromData(
                    fyKey === 'fy24_25' ? regionData : null,
                    fyKey === 'fy25_26' ? regionData : null
                );
                let met = 0, notMet = 0;
                
                regionData.forEach(row => {
                    months.forEach(month => {
                        met += getMonthData(row, month, fyKey, 'Met');
                        notMet += getMonthData(row, month, fyKey, 'Not_Met');
                    });
                });
                
                const total = met + notMet;
                return {
                    region,
                    met,
                    notMet,
                    total,
                    compliance: total > 0 ? ((met / total) * 100).toFixed(1) : 0
                };
            });
        }

        // Helper: Calculate quarterly metrics
        function calculateQuarterlyMetrics(data, fyKey, quarter) {
            const quarterMonths = {
                'Q1': ['Apr', 'May', 'June'],
                'Q2': ['July', 'Aug', 'Sep'],
                'Q3': ['Oct', 'Nov', 'Dec'],
                'Q4': ['Jan', 'Feb', 'March']
            };
            
            const months = quarterMonths[quarter];
            let totalMet = 0, totalNotMet = 0;
            
            data.forEach(row => {
                months.forEach(month => {
                    totalMet += getMonthData(row, month, fyKey, 'Met');
                    totalNotMet += getMonthData(row, month, fyKey, 'Not_Met');
                });
            });
            
            const total = totalMet + totalNotMet;
            return {
                totalMet,
                totalNotMet,
                total,
                compliance: total > 0 ? ((totalMet / total) * 100).toFixed(1) : 0
            };
        }

        // ==================== END DRILL-DOWN FUNCTIONALITY ====================




        // ============================================================================
        // NOT REPORTED ANALYSIS VIEW
        // ============================================================================
        
        function renderNotReportedView() {
            console.log('ðŸ” renderNotReportedView called');
            console.log('ðŸ“Š fy2425NotReportedData:', fy2425NotReportedData ? fy2425NotReportedData.length + ' rows' : 'undefined/null');
            console.log('ðŸ“Š fy2526NotReportedData:', fy2526NotReportedData ? fy2526NotReportedData.length + ' rows' : 'undefined/null');
            
            const contentArea = document.getElementById('dashboardContent');
            
            // Check if data is loaded
            if (!fy2425NotReportedData || fy2425NotReportedData.length === 0) {
                console.error('âŒ Not Reported data is empty or undefined!');
                console.log('fy2425NotReportedData:', fy2425NotReportedData);
                console.log('fy2526NotReportedData:', fy2526NotReportedData);
                contentArea.innerHTML = `
                    <div style="text-align: center; padding: 50px;">
                        <h2 style="color: #666;">âš ï¸ No Not Reported Data Available</h2>
                        <p>Please upload an Excel file with "FY24-25 Not Reported" and "FY25-26 Not Reported" sheets.</p>
                        <p style="color: #999; font-size: 0.9em; margin-top: 20px;">Debug: Check browser console (F12) for details.</p>
                    </div>`;
                return;
            }
            
            console.log('âœ… Not Reported data loaded successfully, proceeding with render...');
            console.log('Sample FY24-25 row:', fy2425NotReportedData[0]);
            console.log('Sample FY25-26 row:', fy2526NotReportedData[0]);
            
            // Filter data based on active filters
            console.log('ðŸ” Active filters:', JSON.stringify(activeFilters));
            let filtered2425 = [...fy2425NotReportedData];
            let filtered2526 = [...fy2526NotReportedData];
            console.log('ðŸ“Š Before filtering: FY24-25 =', filtered2425.length, 'rows, FY25-26 =', filtered2526.length, 'rows');
            
            // Regional Head filter - check if array has items
            if (activeFilters.regionalHead && activeFilters.regionalHead.length > 0) {
                console.log('ðŸ‘¤ Applying regional head filter:', activeFilters.regionalHead);
                filtered2425 = filtered2425.filter(row => {
                    const rh = row['Regional Head '] || row['Regional Head'];
                    return activeFilters.regionalHead.includes(rh);
                });
                filtered2526 = filtered2526.filter(row => {
                    const rh = row['Regional Head '] || row['Regional Head'];
                    return activeFilters.regionalHead.includes(rh);
                });
            }
            
            // Region filter - check if array has items
            if (activeFilters.region && activeFilters.region.length > 0) {
                console.log('ðŸŒ Applying region filter:', activeFilters.region);
                filtered2425 = filtered2425.filter(row => activeFilters.region.includes(row.Region));
                filtered2526 = filtered2526.filter(row => activeFilters.region.includes(row.Region));
            }
            
            // Practice filter - check if array has items
            if (activeFilters.practice && activeFilters.practice.length > 0) {
                console.log('ðŸ‘¥ Applying practice filter:', activeFilters.practice);
                filtered2425 = filtered2425.filter(row => activeFilters.practice.includes(row['Practice Head']));
                filtered2526 = filtered2526.filter(row => activeFilters.practice.includes(row['Practice Head']));
            }
            
            // Account filter - check if array has items
            if (activeFilters.account && activeFilters.account.length > 0) {
                console.log('ðŸ¢ Applying account filter:', activeFilters.account);
                filtered2425 = filtered2425.filter(row => activeFilters.account.includes(row.Project));
                filtered2526 = filtered2526.filter(row => activeFilters.account.includes(row.Project));
            }
            
            console.log('ðŸ“Š After filtering: FY24-25 =', filtered2425.length, 'rows, FY25-26 =', filtered2526.length, 'rows');
            
            // Calculate summary metrics
            const summary2425 = calculateNotReportedSummary(filtered2425);
            const summary2526 = calculateNotReportedSummary(filtered2526);
            
            const yoyChange = summary2526.total - summary2425.total;
            const yoyPercent = summary2425.total > 0 
                ? ((yoyChange / summary2425.total) * 100).toFixed(1)
                : 'N/A';
            
            // Determine trend color
            const trendColor = yoyChange < 0 ? '#51cf66' : '#ff6b6b';
            const trendIcon = yoyChange < 0 ? 'ðŸ“‰' : 'ðŸ“ˆ';
            
            // Calculate dimensional breakdowns
            const projectBreakdown = calculateNotReportedByDimension(filtered2425, filtered2526, 'Project');
            const regionalHeadBreakdown = calculateNotReportedByRegionalHead(filtered2425, filtered2526);
            const regionBreakdown = calculateNotReportedByDimension(filtered2425, filtered2526, 'Region');
            const practiceBreakdown = calculateNotReportedByDimension(filtered2425, filtered2526, 'Practice Head');
            const monthlyTrend = calculateMonthlyTrend(filtered2425, filtered2526);
            
            // Build HTML
            contentArea.innerHTML = `
                <div class="view-header">
                    <h2><i class="bi bi-exclamation-triangle"></i> Not Reported Analysis</h2>
                    <p>Track and analyze SLAs that were not reported each month</p>
                </div>
                
                <!-- Summary Cards -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div class="metric-card" style="background: linear-gradient(135deg, #3a1c71 0%, #d76d77 100%);">
                        <h3 style="color: white; font-size: 1rem; margin-bottom: 10px;">FY 24-25 Total Not Reported</h3>
                        <p style="font-size: 2.5rem; font-weight: bold; color: white; margin: 0;">${summary2425.total}</p>
                        <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-top: 5px;">12 Months (Apr 2024 - Mar 2025)</p>
                    </div>
                    
                    <div class="metric-card" style="background: linear-gradient(135deg, #FF6B35 0%, #ffa94d 100%);">
                        <h3 style="color: white; font-size: 1rem; margin-bottom: 10px;">FY 25-26 Total Not Reported</h3>
                        <p style="font-size: 2.5rem; font-weight: bold; color: white; margin: 0;">${summary2526.total}</p>
                        <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-top: 5px;">7 Months So Far (Apr - Oct 2025)</p>
                    </div>
                    
                    <div class="metric-card" style="background: linear-gradient(135deg, ${yoyChange < 0 ? '#10b981' : '#ef4444'} 0%, ${yoyChange < 0 ? '#34d399' : '#f87171'} 100%);">
                        <h3 style="color: white; font-size: 1rem; margin-bottom: 10px;">Year-over-Year Change</h3>
                        <p style="font-size: 2.5rem; font-weight: bold; color: white; margin: 0;">${trendIcon} ${yoyChange > 0 ? '+' : ''}${yoyChange}</p>
                        <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-top: 5px;">${yoyChange < 0 ? 'Improvement' : 'Worsening'}</p>
                    </div>
                    
                    <div class="metric-card" style="background: linear-gradient(135deg, ${yoyChange < 0 ? '#10b981' : '#ef4444'} 0%, ${yoyChange < 0 ? '#34d399' : '#f87171'} 100%);">
                        <h3 style="color: white; font-size: 1rem; margin-bottom: 10px;">YoY % Change</h3>
                        <p style="font-size: 2.5rem; font-weight: bold; color: white; margin: 0;">${yoyPercent !== 'N/A' ? (yoyChange > 0 ? '+' : '') + yoyPercent + '%' : yoyPercent}</p>
                        <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-top: 5px;">Compared to Same Period</p>
                    </div>
                </div>
                
                <!-- Charts Section -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div class="chart-container">
                        <h3 style="margin-bottom: 15px;"><i class="bi bi-bar-chart"></i> Top 15 Projects - Not Reported Count</h3>
                        <canvas id="notReportedProjectChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3 style="margin-bottom: 15px;"><i class="bi bi-globe"></i> Region-wise Not Reported Count</h3>
                        <canvas id="notReportedRegionChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3 style="margin-bottom: 15px;"><i class="bi bi-people"></i> Practice Head-wise Not Reported Count</h3>
                        <canvas id="notReportedPracticeChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3 style="margin-bottom: 15px;"><i class="bi bi-graph-up"></i> Monthly Trend Comparison</h3>
                        <canvas id="notReportedTrendChart"></canvas>
                    </div>
                </div>
                
                <!-- Detailed Tables -->
                <div style="margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px;"><i class="bi bi-table"></i> Account/Project-wise Analysis</h3>
                    <div class="table-container">
                        ${generateNotReportedTable(projectBreakdown, 'Project')}
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div>
                        <h3 style="margin-bottom: 15px;"><i class="bi bi-geo-alt"></i> Regional Analysis</h3>
                        <div class="table-container">
                            ${generateNotReportedSummaryTable(regionBreakdown, 'Region')}
                        </div>
                        
                        <h3 style="margin-bottom: 15px; margin-top: 30px;"><i class="bi bi-person-badge-fill"></i> Regional Head-wise Analysis</h3>
                        <div class="table-container">
                            ${generateNotReportedSummaryTable(regionalHeadBreakdown, 'Regional Head')}
                        </div>
                    </div>
                    
                    <div>
                        <h3 style="margin-bottom: 15px;"><i class="bi bi-person-badge"></i> Practice Head-wise Analysis</h3>
                        <div class="table-container">
                            ${generateNotReportedSummaryTable(practiceBreakdown, 'Practice Head')}
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px;"><i class="bi bi-calendar3"></i> Monthly Summary</h3>
                    <div class="table-container">
                        ${generateMonthlyTrendTable(monthlyTrend)}
                    </div>
                </div>
            `;
            
            // Destroy old charts before creating new ones
            ['notReportedProjectChart', 'notReportedRegionChart', 'notReportedPracticeChart', 'notReportedTrendChart'].forEach(chartId => {
                if (charts[chartId]) {
                    console.log('Destroying old chart:', chartId);
                    charts[chartId].destroy();
                    delete charts[chartId];
                }
            });
            
            // Render charts with filtered data
            setTimeout(() => {
                console.log('Creating new charts with filtered data...');
                charts.notReportedProjectChart = renderNotReportedProjectChart(projectBreakdown);
                charts.notReportedRegionChart = renderNotReportedRegionChart(regionBreakdown);
                charts.notReportedPracticeChart = renderNotReportedPracticeChart(practiceBreakdown);
                charts.notReportedTrendChart = renderNotReportedTrendChart(monthlyTrend);
            }, 100);
        }
        
        function calculateNotReportedSummary(data) {
            let total = 0;
            let projectCount = data.length;
            
            data.forEach(row => {
                Object.keys(row).forEach(key => {
                    if (key.includes('NotReported')) {
                        total += parseInt(row[key]) || 0;
                    }
                });
            });
            
            return { total, projectCount };
        }
        
        function calculateNotReportedByDimension(data2425, data2526, dimension) {
            const breakdown = {};
            
            // Process FY 24-25
            data2425.forEach(row => {
                const key = row[dimension];
                if (!key) return;
                
                if (!breakdown[key]) {
                    breakdown[key] = { name: key, fy2425: 0, fy2526: 0, region: row.Region, practiceHead: row['Practice Head'] };
                }
                
                Object.keys(row).forEach(col => {
                    if (col.includes('NotReported')) {
                        breakdown[key].fy2425 += parseInt(row[col]) || 0;
                    }
                });
            });
            
            // Process FY 25-26
            data2526.forEach(row => {
                const key = row[dimension];
                if (!key) return;
                
                if (!breakdown[key]) {
                    breakdown[key] = { name: key, fy2425: 0, fy2526: 0, region: row.Region, practiceHead: row['Practice Head'] };
                }
                
                Object.keys(row).forEach(col => {
                    if (col.includes('NotReported')) {
                        breakdown[key].fy2526 += parseInt(row[col]) || 0;
                    }
                });
            });
            
            // Calculate changes
            Object.keys(breakdown).forEach(key => {
                const item = breakdown[key];
                item.change = item.fy2526 - item.fy2425;
                item.pctChange = item.fy2425 > 0 ? ((item.change / item.fy2425) * 100).toFixed(1) : 'N/A';
                item.trend = item.pctChange !== 'N/A' && parseFloat(item.pctChange) > 10 ? 'ðŸ”´ Worsening' 
                            : item.pctChange !== 'N/A' && parseFloat(item.pctChange) < -10 ? 'ðŸŸ¢ Improving' 
                            : 'ðŸŸ¡ Stable';
            });
            
            // Sort by combined total (FY24-25 + FY25-26) instead of just FY24-25
            return Object.values(breakdown).sort((a, b) => (b.fy2425 + b.fy2526) - (a.fy2425 + a.fy2526));
        }
        
        // Calculate Not Reported breakdown by Regional Head
        function calculateNotReportedByRegionalHead(data2425, data2526) {
            const breakdown = {};
            
            // Process FY 24-25
            data2425.forEach(row => {
                const key = row['Regional Head '] || row['Regional Head'];
                if (!key) return;
                
                if (!breakdown[key]) {
                    breakdown[key] = { name: key, fy2425: 0, fy2526: 0 };
                }
                
                Object.keys(row).forEach(col => {
                    if (col.includes('NotReported')) {
                        breakdown[key].fy2425 += parseInt(row[col]) || 0;
                    }
                });
            });
            
            // Process FY 25-26
            data2526.forEach(row => {
                const key = row['Regional Head '] || row['Regional Head'];
                if (!key) return;
                
                if (!breakdown[key]) {
                    breakdown[key] = { name: key, fy2425: 0, fy2526: 0 };
                }
                
                Object.keys(row).forEach(col => {
                    if (col.includes('NotReported')) {
                        breakdown[key].fy2526 += parseInt(row[col]) || 0;
                    }
                });
            });
            
            // Calculate changes
            Object.keys(breakdown).forEach(key => {
                const item = breakdown[key];
                item.change = item.fy2526 - item.fy2425;
                item.pctChange = item.fy2425 > 0 ? ((item.change / item.fy2425) * 100).toFixed(1) : 'N/A';
                item.trend = item.pctChange !== 'N/A' && parseFloat(item.pctChange) > 10 ? 'ðŸ”´ Worsening' 
                            : item.pctChange !== 'N/A' && parseFloat(item.pctChange) < -10 ? 'ðŸŸ¢ Improving' 
                            : 'ðŸŸ¡ Stable';
            });
            
            // Sort by combined total (FY24-25 + FY25-26) instead of just FY24-25
            return Object.values(breakdown).sort((a, b) => (b.fy2425 + b.fy2526) - (a.fy2425 + a.fy2526));
        }
        
        function calculateMonthlyTrend(data2425, data2526) {
            // COMPLETELY REWRITTEN: Handle actual Excel column names correctly
            const monthColumns = new Map();  // Map normalized â†’ Set of actual column names
            const trend = {};
            
            // Extract ACTUAL column names from FY 24-25 data
            if (data2425 && data2425.length > 0) {
                Object.keys(data2425[0]).forEach(key => {
                    // Match: "Jun MET/NOT_MET_NotReported", "Apr MET/NOT_MET_NotReported", etc.
                    const match = key.match(/^([A-Za-z]+)\s+MET\/NOT_MET_NotReported$/);
                    if (match) {
                        const actualName = match[1];  // "Jun", "Jul", "Mar", "Apr", etc.
                        const normalized = normalizeMonthName(actualName);  // Normalize for grouping
                        
                        if (!monthColumns.has(normalized)) {
                            monthColumns.set(normalized, new Set());
                        }
                        monthColumns.get(normalized).add(actualName);
                    }
                });
            }
            
            // Extract ACTUAL column names from FY 25-26 data
            if (data2526 && data2526.length > 0) {
                Object.keys(data2526[0]).forEach(key => {
                    const match = key.match(/^([A-Za-z]+)\s+MET\/NOT_MET_NotReported$/);
                    if (match) {
                        const actualName = match[1];
                        const normalized = normalizeMonthName(actualName);
                        
                        if (!monthColumns.has(normalized)) {
                            monthColumns.set(normalized, new Set());
                        }
                        monthColumns.get(normalized).add(actualName);
                    }
                });
            }
            
            // Sort months in fiscal year order
            const fiscalOrder = ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar'];
            const months = Array.from(monthColumns.keys()).sort((a, b) => {
                return fiscalOrder.indexOf(a) - fiscalOrder.indexOf(b);
            });
            
            // Initialize trend structure
            months.forEach(month => {
                trend[month] = { month, fy2425: 0, fy2526: 0 };
            });
            
            // Sum FY 24-25 data using actual column names
            if (data2425) {
                data2425.forEach(row => {
                    months.forEach(normalizedMonth => {
                        const actualNames = monthColumns.get(normalizedMonth);
                        for (const actualName of actualNames) {
                            const colName = actualName + ' MET/NOT_MET_NotReported';
                            if (row[colName] !== undefined) {
                                trend[normalizedMonth].fy2425 += parseInt(row[colName]) || 0;
                                break;
                            }
                        }
                    });
                });
            }
            
            // Sum FY 25-26 data using actual column names
            if (data2526) {
                data2526.forEach(row => {
                    months.forEach(normalizedMonth => {
                        const actualNames = monthColumns.get(normalizedMonth);
                        for (const actualName of actualNames) {
                            const colName = actualName + ' MET/NOT_MET_NotReported';
                            if (row[colName] !== undefined) {
                                trend[normalizedMonth].fy2526 += parseInt(row[colName]) || 0;
                                break;
                            }
                        }
                    });
                });
            }
            
            return months.map(m => trend[m]);
        }
        function generateNotReportedTable(data, dimension) {
            const top15 = data.slice(0, 15);
            
            let html = `
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #3a1c71 0%, #d76d77 100%); color: white;">
                            <th style="padding: 12px; text-align: left;">Project</th>
                            <th style="padding: 12px; text-align: left;">Region</th>
                            <th style="padding: 12px; text-align: left;">Practice Head</th>
                            <th style="padding: 12px; text-align: center;">FY 24-25 Total</th>
                            <th style="padding: 12px; text-align: center;">FY 25-26 Total</th>
                            <th style="padding: 12px; text-align: center;">Change</th>
                            <th style="padding: 12px; text-align: center;">% Change</th>
                            <th style="padding: 12px; text-align: center;">Trend</th>
                        </tr>
                    </thead>
                    <tbody>`;
            
            top15.forEach((item, idx) => {
                const bgColor = idx % 2 === 0 ? '#f8f9fa' : 'white';
                const changeColor = item.change < 0 ? '#51cf66' : item.change > 0 ? '#ff6b6b' : '#868e96';
                
                html += `
                    <tr style="background: ${bgColor};">
                        <td style="padding: 10px;">${item.name}</td>
                        <td style="padding: 10px;">${item.region || '-'}</td>
                        <td style="padding: 10px;">${item.practiceHead || '-'}</td>
                        <td style="padding: 10px; text-align: center; font-weight: bold;">${item.fy2425}</td>
                        <td style="padding: 10px; text-align: center; font-weight: bold;">${item.fy2526}</td>
                        <td style="padding: 10px; text-align: center; color: ${changeColor}; font-weight: bold;">
                            ${item.change > 0 ? '+' : ''}${item.change}
                        </td>
                        <td style="padding: 10px; text-align: center; color: ${changeColor}; font-weight: bold;">
                            ${item.pctChange !== 'N/A' ? (item.change > 0 ? '+' : '') + item.pctChange + '%' : 'N/A'}
                        </td>
                        <td style="padding: 10px; text-align: center;">${item.trend}</td>
                    </tr>`;
            });
            
            html += `</tbody></table>`;
            return html;
        }
        
        function generateNotReportedSummaryTable(data, dimension) {
            let html = `
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #3a1c71 0%, #d76d77 100%); color: white;">
                            <th style="padding: 10px; text-align: left;">${dimension}</th>
                            <th style="padding: 10px; text-align: center;">FY 24-25</th>
                            <th style="padding: 10px; text-align: center;">FY 25-26</th>
                            <th style="padding: 10px; text-align: center;">Change</th>
                            <th style="padding: 10px; text-align: center;">% Change</th>
                        </tr>
                    </thead>
                    <tbody>`;
            
            data.forEach((item, idx) => {
                const bgColor = idx % 2 === 0 ? '#f8f9fa' : 'white';
                const changeColor = item.change < 0 ? '#51cf66' : item.change > 0 ? '#ff6b6b' : '#868e96';
                
                html += `
                    <tr style="background: ${bgColor};">
                        <td style="padding: 8px;">${item.name}</td>
                        <td style="padding: 8px; text-align: center; font-weight: bold;">${item.fy2425}</td>
                        <td style="padding: 8px; text-align: center; font-weight: bold;">${item.fy2526}</td>
                        <td style="padding: 8px; text-align: center; color: ${changeColor}; font-weight: bold;">
                            ${item.change > 0 ? '+' : ''}${item.change}
                        </td>
                        <td style="padding: 8px; text-align: center; color: ${changeColor}; font-weight: bold;">
                            ${item.pctChange !== 'N/A' ? (item.change > 0 ? '+' : '') + item.pctChange + '%' : 'N/A'}
                        </td>
                    </tr>`;
            });
            
            html += `</tbody></table>`;
            return html;
        }
        
        function generateMonthlyTrendTable(trend) {
            let html = `
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #3a1c71 0%, #d76d77 100%); color: white;">
                            <th style="padding: 12px; text-align: left;">Month</th>
                            <th style="padding: 12px; text-align: center;">FY 24-25</th>
                            <th style="padding: 12px; text-align: center;">FY 25-26</th>
                            <th style="padding: 12px; text-align: center;">Change</th>
                            <th style="padding: 12px; text-align: center;">% Change</th>
                        </tr>
                    </thead>
                    <tbody>`;
            
            trend.forEach((item, idx) => {
                const bgColor = idx % 2 === 0 ? '#f8f9fa' : 'white';
                const change = item.fy2526 - item.fy2425;
                const pctChange = item.fy2425 > 0 ? ((change / item.fy2425) * 100).toFixed(1) : 'N/A';
                const changeColor = change < 0 ? '#51cf66' : change > 0 ? '#ff6b6b' : '#868e96';
                
                html += `
                    <tr style="background: ${bgColor};">
                        <td style="padding: 10px; font-weight: bold;">${item.month}</td>
                        <td style="padding: 10px; text-align: center;">${item.fy2425}</td>
                        <td style="padding: 10px; text-align: center;">${item.fy2526}</td>
                        <td style="padding: 10px; text-align: center; color: ${changeColor}; font-weight: bold;">
                            ${change > 0 ? '+' : ''}${change}
                        </td>
                        <td style="padding: 10px; text-align: center; color: ${changeColor}; font-weight: bold;">
                            ${pctChange !== 'N/A' ? (change > 0 ? '+' : '') + pctChange + '%' : 'N/A'}
                        </td>
                    </tr>`;
            });
            
            html += `</tbody></table>`;
            return html;
        }
        
        function renderNotReportedProjectChart(data) {
            const ctx = document.getElementById('notReportedProjectChart');
            if (!ctx) return null;
            
            const top15 = data.slice(0, 15);
            const totalCount = data.reduce((sum, d) => sum + d.fy2425 + d.fy2526, 0);
            
            // User-friendly color palette with better contrast
            const colors = [
                '#ef4444', '#f87171', '#fb923c', '#fbbf24', 
                '#facc15', '#a3e635', '#4ade80', '#34d399',
                '#22d3ee', '#38bdf8', '#60a5fa', '#818cf8',
                '#a78bfa', '#c084fc', '#e879f9'
            ];
            
            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: top15.map(d => d.name),
                    datasets: [{
                        label: 'Not Reported Count',
                        data: top15.map(d => d.fy2425 + d.fy2526),
                        backgroundColor: top15.map((d, i) => colors[i]),
                        borderWidth: 0,
                        borderRadius: 8
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'right',
                            color: '#000',
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            borderRadius: 4,
                            padding: { top: 4, bottom: 4, left: 6, right: 6 },
                            font: { size: 11, weight: 'bold', family: 'Inter' },
                            formatter: (value, context) => {
                                const percentage = ((value / totalCount) * 100).toFixed(1);
                                return `${value} (${percentage}%)`;
                            },
                            display: true
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold', family: 'Inter' },
                            bodyFont: { size: 13, family: 'Inter' },
                            cornerRadius: 8,
                            callbacks: {
                                label: (context) => {
                                    const value = context.parsed.x;
                                    const percentage = ((value / totalCount) * 100).toFixed(1);
                                    return `Count: ${value} (${percentage}% of total)`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: {
                                font: { size: 12, family: 'Inter, sans-serif' }
                            },
                            title: {
                                display: true,
                                text: 'Not Reported Count',
                                font: { size: 13, family: 'Inter', weight: '600' }
                            }
                        },
                        y: {
                            grid: { display: false },
                            ticks: {
                                font: { size: 11, family: 'Inter, sans-serif', weight: '500' }
                            }
                        }
                    }
                }
            });
        }
        
        function renderNotReportedRegionChart(data) {
            const ctx = document.getElementById('notReportedRegionChart');
            if (!ctx) return null;
            
            const totalCount = data.reduce((sum, d) => sum + d.fy2425 + d.fy2526, 0);
            const userFriendlyColors = ['#10b981', '#3b82f6', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899'];
            
            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(d => d.name),
                    datasets: [{
                        label: 'Not Reported Count',
                        data: data.map(d => d.fy2425 + d.fy2526),
                        backgroundColor: data.map((d, i) => userFriendlyColors[i % userFriendlyColors.length]),
                        borderWidth: 0,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'end',
                            offset: -5,
                            color: '#000',
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            borderRadius: 6,
                            padding: { top: 4, bottom: 4, left: 6, right: 6 },
                            font: { size: 12, weight: 'bold', family: 'Inter' },
                            formatter: (value, context) => {
                                const percentage = ((value / totalCount) * 100).toFixed(1);
                                return `${value} (${percentage}%)`;
                            },
                            clip: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold', family: 'Inter' },
                            bodyFont: { size: 13, family: 'Inter' },
                            cornerRadius: 8,
                            callbacks: {
                                label: (context) => {
                                    const value = context.parsed.y;
                                    const percentage = ((value / totalCount) * 100).toFixed(1);
                                    return `Count: ${value} (${percentage}% of total)`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: {
                                font: { size: 12, family: 'Inter, sans-serif', weight: '500' }
                            }
                        },
                        y: { 
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: {
                                font: { size: 12, family: 'Inter, sans-serif' }
                            },
                            title: {
                                display: true,
                                text: 'Not Reported Count',
                                font: { size: 13, family: 'Inter', weight: '600' }
                            }
                        }
                    }
                }
            });
        }
        
        function renderNotReportedPracticeChart(data) {
            const ctx = document.getElementById('notReportedPracticeChart');
            if (!ctx) return null;
            
            const totalCount = data.reduce((sum, d) => sum + d.fy2425 + d.fy2526, 0);
            const userFriendlyColors = ['#06b6d4', '#8b5cf6', '#ec4899', '#f59e0b', '#10b981', '#3b82f6', '#ef4444', '#14b8a6'];
            
            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(d => d.name),
                    datasets: [{
                        label: 'Not Reported Count',
                        data: data.map(d => d.fy2425 + d.fy2526),
                        backgroundColor: data.map((d, i) => userFriendlyColors[i % userFriendlyColors.length]),
                        borderWidth: 0,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'end',
                            offset: -5,
                            color: '#000',
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            borderRadius: 6,
                            padding: { top: 4, bottom: 4, left: 6, right: 6 },
                            font: { size: 12, weight: 'bold', family: 'Inter' },
                            formatter: (value, context) => {
                                const percentage = ((value / totalCount) * 100).toFixed(1);
                                return `${value} (${percentage}%)`;
                            },
                            clip: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold', family: 'Inter' },
                            bodyFont: { size: 13, family: 'Inter' },
                            cornerRadius: 8,
                            callbacks: {
                                label: (context) => {
                                    const value = context.parsed.y;
                                    const percentage = ((value / totalCount) * 100).toFixed(1);
                                    return `Count: ${value} (${percentage}% of total)`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: {
                                font: { size: 12, family: 'Inter, sans-serif', weight: '500' }
                            }
                        },
                        y: { 
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: {
                                font: { size: 12, family: 'Inter, sans-serif' }
                            },
                            title: {
                                display: true,
                                text: 'Not Reported Count',
                                font: { size: 13, family: 'Inter', weight: '600' }
                            }
                        }
                    }
                }
            });
        }
        
        function renderNotReportedTrendChart(trend) {
            const ctx = document.getElementById('notReportedTrendChart');
            if (!ctx) return null;
            
            // Filter months with actual data for FY 25-26
            const monthsWithData = trend.filter(d => d.fy2526 !== null && d.fy2526 !== undefined);
            const labelsToShow = monthsWithData.length > 0 
                ? trend.slice(0, monthsWithData.length).map(d => d.month)
                : trend.map(d => d.month);
            
            // Show only months that exist in both years or have data
            const fy24Data = labelsToShow.map((month, idx) => trend[idx].fy2425);
            const fy25Data = labelsToShow.map((month, idx) => 
                trend[idx].fy2526 !== null && trend[idx].fy2526 !== undefined ? trend[idx].fy2526 : null
            );
            
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labelsToShow,
                    datasets: [
                        {
                            label: 'FY 24-25',
                            data: fy24Data,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            borderWidth: 3,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            pointBackgroundColor: '#3b82f6',
                            fill: true
                        },
                        {
                            label: 'FY 25-26',
                            data: fy25Data,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            borderWidth: 3,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            pointBackgroundColor: '#10b981',
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: { size: 13, family: 'Inter', weight: '600' },
                                padding: 15,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        datalabels: {
                            display: true,
                            align: 'top',
                            anchor: 'end',
                            offset: 4,
                            color: '#000',
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            borderRadius: 4,
                            padding: { top: 2, bottom: 2, left: 4, right: 4 },
                            font: { size: 10, weight: 'bold', family: 'Inter' },
                            formatter: (value) => value !== null ? value : ''
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 12,
                            titleFont: { size: 14, weight: 'bold', family: 'Inter' },
                            bodyFont: { size: 13, family: 'Inter' },
                            cornerRadius: 8
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: {
                                font: { size: 12, family: 'Inter, sans-serif', weight: '500' }
                            }
                        },
                        y: { 
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: {
                                font: { size: 12, family: 'Inter, sans-serif' }
                            },
                            title: {
                                display: true,
                                text: 'Not Reported Count',
                                font: { size: 13, family: 'Inter', weight: '600' }
                            }
                        }
                    }
                }
            });
        }

    </script>

    <!-- Drill-Down Modal -->
    <div id="drilldownModal" class="drilldown-modal">
        <div class="drilldown-content">
            <span class="drilldown-close" onclick="closeDrilldown()">&times;</span>
            <div id="drilldownBody">
                <!-- Dynamic content loaded here -->
            </div>
        </div>
    </div>

</body>
</html>